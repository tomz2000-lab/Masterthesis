=== Company Car Game - 10 Iterations ===
Job ID: 2013438, Node: jn117
=== Environment Check ===
CUDA: True, GPU: NVIDIA L40
NVIDIA L40, 49140 MiB, 1 MiB
=== Verifying Torch Scope Fix ===
âœ… Torch scope fix is present
=== Running Company Car Game - 10 Iterations ===
Game: Employee vs Manager company car negotiation

=== Iteration 1/300 ===
Mon Nov 10 05:03:04 PM CET 2025: Starting company car negotiation iteration 1 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.38s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.78s (total since entry 19.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 2.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 100.61s (total since entry 103.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39167}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39167}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39167}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39167}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39167}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39167.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,167 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37271}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37271}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37271}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37271}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37271}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37271.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬37,271 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 1 completed successfully
Mon Nov 10 05:05:37 PM CET 2025: Completed iteration 1

=== Iteration 2/300 ===
Mon Nov 10 05:05:37 PM CET 2025: Starting company car negotiation iteration 2 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 55.59s (total since entry 56.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1615.00, model_b surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': -1615.0, 'model_b': 3585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 38770.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1615.0, 'model_b': 3585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 2 completed successfully
Mon Nov 10 05:06:50 PM CET 2025: Completed iteration 2

=== Iteration 3/300 ===
Mon Nov 10 05:06:50 PM CET 2025: Starting company car negotiation iteration 3 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.86s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1615.00, model_b surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': -1615.0, 'model_b': 3585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 38770.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1615.0, 'model_b': 3585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 3 completed successfully
Mon Nov 10 05:07:19 PM CET 2025: Completed iteration 3

=== Iteration 4/300 ===
Mon Nov 10 05:07:19 PM CET 2025: Starting company car negotiation iteration 4 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=779.22, model_a surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40558.45, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 4 completed successfully
Mon Nov 10 05:07:51 PM CET 2025: Completed iteration 4

=== Iteration 5/300 ===
Mon Nov 10 05:07:51 PM CET 2025: Starting company car negotiation iteration 5 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29700.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 5 completed successfully
Mon Nov 10 05:08:23 PM CET 2025: Completed iteration 5

=== Iteration 6/300 ===
Mon Nov 10 05:08:23 PM CET 2025: Starting company car negotiation iteration 6 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.67s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27900.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 46000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 46000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 46000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 46000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 46000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 46000.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬46,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 6 completed successfully
Mon Nov 10 05:08:52 PM CET 2025: Completed iteration 6

=== Iteration 7/300 ===
Mon Nov 10 05:08:52 PM CET 2025: Starting company car negotiation iteration 7 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 25000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 25000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 25000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 25000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 25000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 25000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬25,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,100 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 494.80 (saved â‚¬494.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1387.87 (profit â‚¬1387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39089.60, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=494.80, model_a surplus=1387.87
âœ… Calculated utility_surplus: {'model_a': 1387.8745256249967, 'model_b': 494.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39089.59715125, 'model_a': 38100.0}
Metrics: {'utility_surplus': {'model_a': 1387.8745256249967, 'model_b': 494.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 7 completed successfully
Mon Nov 10 05:09:25 PM CET 2025: Completed iteration 7

=== Iteration 8/300 ===
Mon Nov 10 05:09:25 PM CET 2025: Starting company car negotiation iteration 8 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.98s (total since entry 9.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 8 completed successfully
Mon Nov 10 05:09:54 PM CET 2025: Completed iteration 8

=== Iteration 9/300 ===
Mon Nov 10 05:09:54 PM CET 2025: Starting company car negotiation iteration 9 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.56s (total since entry 5.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 9 completed successfully
Mon Nov 10 05:10:28 PM CET 2025: Completed iteration 9

=== Iteration 10/300 ===
Mon Nov 10 05:10:28 PM CET 2025: Starting company car negotiation iteration 10 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': ''}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 10 completed successfully
Mon Nov 10 05:10:52 PM CET 2025: Completed iteration 10

=== Iteration 11/300 ===
Mon Nov 10 05:10:52 PM CET 2025: Starting company car negotiation iteration 11 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.51s (total since entry 4.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬26,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2779.22 (saved â‚¬2779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -838.78 (profit â‚¬-838.78 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42558.45, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2779.22, model_a surplus=-838.78
âœ… Calculated utility_surplus: {'model_a': -838.7750000000015, 'model_b': 2779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 42558.45, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': -838.7750000000015, 'model_b': 2779.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 11 completed successfully
Mon Nov 10 05:11:17 PM CET 2025: Completed iteration 11

=== Iteration 12/300 ===
Mon Nov 10 05:11:17 PM CET 2025: Starting company car negotiation iteration 12 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 12 completed successfully
Mon Nov 10 05:11:39 PM CET 2025: Completed iteration 12

=== Iteration 13/300 ===
Mon Nov 10 05:11:39 PM CET 2025: Starting company car negotiation iteration 13 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 13 completed successfully
Mon Nov 10 05:12:08 PM CET 2025: Completed iteration 13

=== Iteration 14/300 ===
Mon Nov 10 05:12:08 PM CET 2025: Starting company car negotiation iteration 14 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬38,499 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38499
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1280.22 (saved â‚¬1280.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 660.22 (profit â‚¬660.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41059.45, seller=38499.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1280.22, model_a surplus=660.22
âœ… Calculated utility_surplus: {'model_a': 660.2249999999985, 'model_b': 1280.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41059.45, 'model_a': 38499.0}
Metrics: {'utility_surplus': {'model_a': 660.2249999999985, 'model_b': 1280.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 14 completed successfully
Mon Nov 10 05:12:36 PM CET 2025: Completed iteration 14

=== Iteration 15/300 ===
Mon Nov 10 05:12:36 PM CET 2025: Starting company car negotiation iteration 15 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 15 completed successfully
Mon Nov 10 05:13:06 PM CET 2025: Completed iteration 15

=== Iteration 16/300 ===
Mon Nov 10 05:13:06 PM CET 2025: Starting company car negotiation iteration 16 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 885.00 (saved â‚¬885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1085.00 (profit â‚¬1085.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41270.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=885.00, model_a surplus=1085.00
âœ… Calculated utility_surplus: {'model_a': 1085.0, 'model_b': 885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41270.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1085.0, 'model_b': 885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 16 completed successfully
Mon Nov 10 05:13:36 PM CET 2025: Completed iteration 16

=== Iteration 17/300 ===
Mon Nov 10 05:13:36 PM CET 2025: Starting company car negotiation iteration 17 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3500.00 (saved â‚¬3500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1500.00 (profit â‚¬-1500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=44500.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=3500.00, model_b surplus=-1500.00
âœ… Calculated utility_surplus: {'model_a': 3500.0, 'model_b': -1500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 44500.0, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 3500.0, 'model_b': -1500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 17 completed successfully
Mon Nov 10 05:13:58 PM CET 2025: Completed iteration 17

=== Iteration 18/300 ===
Mon Nov 10 05:13:58 PM CET 2025: Starting company car negotiation iteration 18 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.90s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39675}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39675}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39675}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39675}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39675}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39675.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,675 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 18 completed successfully
Mon Nov 10 05:14:35 PM CET 2025: Completed iteration 18

=== Iteration 19/300 ===
Mon Nov 10 05:14:35 PM CET 2025: Starting company car negotiation iteration 19 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1000.00, model_b surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': -1000.0, 'model_b': 3000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 40000.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1000.0, 'model_b': 3000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 19 completed successfully
Mon Nov 10 05:14:58 PM CET 2025: Completed iteration 19

=== Iteration 20/300 ===
Mon Nov 10 05:14:58 PM CET 2025: Starting company car negotiation iteration 20 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.54s (total since entry 5.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬36,499 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬36,499 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=36499
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3280.22 (saved â‚¬3280.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1339.78 (profit â‚¬-1339.78 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43059.45, seller=36499.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3280.22, model_a surplus=-1339.78
âœ… Calculated utility_surplus: {'model_a': -1339.7750000000015, 'model_b': 3280.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 43059.45, 'model_a': 36499.0}
Metrics: {'utility_surplus': {'model_a': -1339.7750000000015, 'model_b': 3280.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 20 completed successfully
Mon Nov 10 05:15:27 PM CET 2025: Completed iteration 20

=== Iteration 21/300 ===
Mon Nov 10 05:15:27 PM CET 2025: Starting company car negotiation iteration 21 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.59s (total since entry 5.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40379}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40379}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40379}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40379}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40379}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40379.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,379 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 21 completed successfully
Mon Nov 10 05:15:53 PM CET 2025: Completed iteration 21

=== Iteration 22/300 ===
Mon Nov 10 05:15:53 PM CET 2025: Starting company car negotiation iteration 22 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 22 completed successfully
Mon Nov 10 05:16:27 PM CET 2025: Completed iteration 22

=== Iteration 23/300 ===
Mon Nov 10 05:16:27 PM CET 2025: Starting company car negotiation iteration 23 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 23 completed successfully
Mon Nov 10 05:16:59 PM CET 2025: Completed iteration 23

=== Iteration 24/300 ===
Mon Nov 10 05:16:59 PM CET 2025: Starting company car negotiation iteration 24 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.68s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 24 completed successfully
Mon Nov 10 05:17:25 PM CET 2025: Completed iteration 24

=== Iteration 25/300 ===
Mon Nov 10 05:17:25 PM CET 2025: Starting company car negotiation iteration 25 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41666}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41666}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41666}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41666}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41666}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41666.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬41,666 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 25 completed successfully
Mon Nov 10 05:18:05 PM CET 2025: Completed iteration 25

=== Iteration 26/300 ===
Mon Nov 10 05:18:05 PM CET 2025: Starting company car negotiation iteration 26 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1379.22, model_a surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41158.45, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 26 completed successfully
Mon Nov 10 05:18:36 PM CET 2025: Completed iteration 26

=== Iteration 27/300 ===
Mon Nov 10 05:18:36 PM CET 2025: Starting company car negotiation iteration 27 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 27 completed successfully
Mon Nov 10 05:19:04 PM CET 2025: Completed iteration 27

=== Iteration 28/300 ===
Mon Nov 10 05:19:04 PM CET 2025: Starting company car negotiation iteration 28 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 28 completed successfully
Mon Nov 10 05:19:44 PM CET 2025: Completed iteration 28

=== Iteration 29/300 ===
Mon Nov 10 05:19:44 PM CET 2025: Starting company car negotiation iteration 29 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.48s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41666}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41666}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41666}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41666}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41666}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41666.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36400.0}
ğŸ’¡ Player model_a made offer â‚¬41,666 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=794.80, model_a surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 1087.8745256249967, 'model_b': 794.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39389.59715125, 'model_a': 37800.0}
Metrics: {'utility_surplus': {'model_a': 1087.8745256249967, 'model_b': 794.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 29 completed successfully
Mon Nov 10 05:20:28 PM CET 2025: Completed iteration 29

=== Iteration 30/300 ===
Mon Nov 10 05:20:28 PM CET 2025: Starting company car negotiation iteration 30 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 30 completed successfully
Mon Nov 10 05:20:53 PM CET 2025: Completed iteration 30

=== Iteration 31/300 ===
Mon Nov 10 05:20:53 PM CET 2025: Starting company car negotiation iteration 31 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.64s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 31 completed successfully
Mon Nov 10 05:21:18 PM CET 2025: Completed iteration 31

=== Iteration 32/300 ===
Mon Nov 10 05:21:18 PM CET 2025: Starting company car negotiation iteration 32 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2500.00, model_a surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': -500.0, 'model_b': 2500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43500.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': -500.0, 'model_b': 2500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 32 completed successfully
Mon Nov 10 05:21:40 PM CET 2025: Completed iteration 32

=== Iteration 33/300 ===
Mon Nov 10 05:21:40 PM CET 2025: Starting company car negotiation iteration 33 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 33 completed successfully
Mon Nov 10 05:22:17 PM CET 2025: Completed iteration 33

=== Iteration 34/300 ===
Mon Nov 10 05:22:17 PM CET 2025: Starting company car negotiation iteration 34 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 34 completed successfully
Mon Nov 10 05:22:48 PM CET 2025: Completed iteration 34

=== Iteration 35/300 ===
Mon Nov 10 05:22:48 PM CET 2025: Starting company car negotiation iteration 35 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 36000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 36000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 36000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬36,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3779.22 (saved â‚¬3779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1838.78 (profit â‚¬-1838.78 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43558.45, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3779.22, model_a surplus=-1838.78
âœ… Calculated utility_surplus: {'model_a': -1838.7750000000015, 'model_b': 3779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 43558.45, 'model_a': 36000.0}
Metrics: {'utility_surplus': {'model_a': -1838.7750000000015, 'model_b': 3779.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 35 completed successfully
Mon Nov 10 05:23:13 PM CET 2025: Completed iteration 35

=== Iteration 36/300 ===
Mon Nov 10 05:23:13 PM CET 2025: Starting company car negotiation iteration 36 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.51s (total since entry 4.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.67s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2250.00 (saved â‚¬2250.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -250.00 (profit â‚¬-250.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43250.00, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2250.00, model_b surplus=-250.00
âœ… Calculated utility_surplus: {'model_a': 2250.0, 'model_b': -250.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43250.0, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 2250.0, 'model_b': -250.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 36 completed successfully
Mon Nov 10 05:23:36 PM CET 2025: Completed iteration 36

=== Iteration 37/300 ===
Mon Nov 10 05:23:36 PM CET 2025: Starting company car negotiation iteration 37 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,499 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38499
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 95.80 (saved â‚¬95.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1786.87 (profit â‚¬1786.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38690.60, seller=38499.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=95.80, model_a surplus=1786.87
âœ… Calculated utility_surplus: {'model_a': 1786.8745256249967, 'model_b': 95.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38690.59715125, 'model_a': 38499.0}
Metrics: {'utility_surplus': {'model_a': 1786.8745256249967, 'model_b': 95.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 37 completed successfully
Mon Nov 10 05:24:14 PM CET 2025: Completed iteration 37

=== Iteration 38/300 ===
Mon Nov 10 05:24:14 PM CET 2025: Starting company car negotiation iteration 38 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "accept"\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "accept"\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "accept"\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 38 completed successfully
Mon Nov 10 05:24:44 PM CET 2025: Completed iteration 38

=== Iteration 39/300 ===
Mon Nov 10 05:24:44 PM CET 2025: Starting company car negotiation iteration 39 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,700 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -105.20 (saved â‚¬-105.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1987.87 (profit â‚¬1987.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38489.60, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-105.20, model_b surplus=1987.87
âœ… Calculated utility_surplus: {'model_a': -105.2014243750018, 'model_b': 1987.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38489.59715125, 'model_b': 38700.0}
Metrics: {'utility_surplus': {'model_a': -105.2014243750018, 'model_b': 1987.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 39 completed successfully
Mon Nov 10 05:25:25 PM CET 2025: Completed iteration 39

=== Iteration 40/300 ===
Mon Nov 10 05:25:25 PM CET 2025: Starting company car negotiation iteration 40 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 40 completed successfully
Mon Nov 10 05:25:57 PM CET 2025: Completed iteration 40

=== Iteration 41/300 ===
Mon Nov 10 05:25:57 PM CET 2025: Starting company car negotiation iteration 41 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.70s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 41 completed successfully
Mon Nov 10 05:26:32 PM CET 2025: Completed iteration 41

=== Iteration 42/300 ===
Mon Nov 10 05:26:32 PM CET 2025: Starting company car negotiation iteration 42 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 4000.00 (saved â‚¬4000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -2000.00 (profit â‚¬-2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=45000.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=4000.00, model_b surplus=-2000.00
âœ… Calculated utility_surplus: {'model_a': 4000.0, 'model_b': -2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 45000.0, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 4000.0, 'model_b': -2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 42 completed successfully
Mon Nov 10 05:26:54 PM CET 2025: Completed iteration 42

=== Iteration 43/300 ===
Mon Nov 10 05:26:54 PM CET 2025: Starting company car negotiation iteration 43 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2885.00 (saved â‚¬2885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -915.00 (profit â‚¬-915.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43270.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2885.00, model_a surplus=-915.00
âœ… Calculated utility_surplus: {'model_a': -915.0, 'model_b': 2885.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 43270.0, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': -915.0, 'model_b': 2885.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 43 completed successfully
Mon Nov 10 05:27:20 PM CET 2025: Completed iteration 43

=== Iteration 44/300 ===
Mon Nov 10 05:27:20 PM CET 2025: Starting company car negotiation iteration 44 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 44 completed successfully
Mon Nov 10 05:27:51 PM CET 2025: Completed iteration 44

=== Iteration 45/300 ===
Mon Nov 10 05:27:51 PM CET 2025: Starting company car negotiation iteration 45 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬27,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 45 completed successfully
Mon Nov 10 05:28:17 PM CET 2025: Completed iteration 45

=== Iteration 46/300 ===
Mon Nov 10 05:28:17 PM CET 2025: Starting company car negotiation iteration 46 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1179.22, model_b surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40958.45, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 46 completed successfully
Mon Nov 10 05:28:44 PM CET 2025: Completed iteration 46

=== Iteration 47/300 ===
Mon Nov 10 05:28:44 PM CET 2025: Starting company car negotiation iteration 47 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1179.22, model_b surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40958.45, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 47 completed successfully
Mon Nov 10 05:29:15 PM CET 2025: Completed iteration 47

=== Iteration 48/300 ===
Mon Nov 10 05:29:15 PM CET 2025: Starting company car negotiation iteration 48 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.57s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.93s (total since entry 9.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 48 completed successfully
Mon Nov 10 05:29:45 PM CET 2025: Completed iteration 48

=== Iteration 49/300 ===
Mon Nov 10 05:29:45 PM CET 2025: Starting company car negotiation iteration 49 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 49 completed successfully
Mon Nov 10 05:30:24 PM CET 2025: Completed iteration 49

=== Iteration 50/300 ===
Mon Nov 10 05:30:24 PM CET 2025: Starting company car negotiation iteration 50 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬36,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=36500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3279.22 (saved â‚¬3279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1338.78 (profit â‚¬-1338.78 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43058.45, seller=36500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3279.22, model_a surplus=-1338.78
âœ… Calculated utility_surplus: {'model_a': -1338.7750000000015, 'model_b': 3279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 43058.45, 'model_a': 36500.0}
Metrics: {'utility_surplus': {'model_a': -1338.7750000000015, 'model_b': 3279.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 50 completed successfully
Mon Nov 10 05:30:53 PM CET 2025: Completed iteration 50

=== Iteration 51/300 ===
Mon Nov 10 05:30:53 PM CET 2025: Starting company car negotiation iteration 51 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 51 completed successfully
Mon Nov 10 05:31:21 PM CET 2025: Completed iteration 51

=== Iteration 52/300 ===
Mon Nov 10 05:31:21 PM CET 2025: Starting company car negotiation iteration 52 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.90s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2400.00 (saved â‚¬2400.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -400.00 (profit â‚¬-400.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43400.00, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2400.00, model_b surplus=-400.00
âœ… Calculated utility_surplus: {'model_a': 2400.0, 'model_b': -400.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43400.0, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 2400.0, 'model_b': -400.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 52 completed successfully
Mon Nov 10 05:31:47 PM CET 2025: Completed iteration 52

=== Iteration 53/300 ===
Mon Nov 10 05:31:47 PM CET 2025: Starting company car negotiation iteration 53 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3385.00 (saved â‚¬3385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1415.00 (profit â‚¬-1415.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43770.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=3385.00, model_b surplus=-1415.00
âœ… Calculated utility_surplus: {'model_a': 3385.0, 'model_b': -1415.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 43770.0, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 3385.0, 'model_b': -1415.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 53 completed successfully
Mon Nov 10 05:32:09 PM CET 2025: Completed iteration 53

=== Iteration 54/300 ===
Mon Nov 10 05:32:09 PM CET 2025: Starting company car negotiation iteration 54 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 54 completed successfully
Mon Nov 10 05:32:38 PM CET 2025: Completed iteration 54

=== Iteration 55/300 ===
Mon Nov 10 05:32:38 PM CET 2025: Starting company car negotiation iteration 55 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37916}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37916}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37916}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37916}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37916}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37916.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,916 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 55 completed successfully
Mon Nov 10 05:33:06 PM CET 2025: Completed iteration 55

=== Iteration 56/300 ===
Mon Nov 10 05:33:06 PM CET 2025: Starting company car negotiation iteration 56 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39670}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39670}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39670}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39670}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39670}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39670.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,670 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39490.0}
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬41,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=41500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -2317.46 (saved â‚¬-2317.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 4228.81 (profit â‚¬4228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=36865.07, seller=41500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-2317.46, model_b surplus=4228.81
âœ… Calculated utility_surplus: {'model_a': -2317.4633750000066, 'model_b': 4228.806625000005}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 36865.07324999999, 'model_b': 41500.0}
Metrics: {'utility_surplus': {'model_a': -2317.4633750000066, 'model_b': 4228.806625000005}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 56 completed successfully
Mon Nov 10 05:33:39 PM CET 2025: Completed iteration 56

=== Iteration 57/300 ===
Mon Nov 10 05:33:39 PM CET 2025: Starting company car negotiation iteration 57 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_b rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 57 completed successfully
Mon Nov 10 05:34:20 PM CET 2025: Completed iteration 57

=== Iteration 58/300 ===
Mon Nov 10 05:34:20 PM CET 2025: Starting company car negotiation iteration 58 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 58 completed successfully
Mon Nov 10 05:35:01 PM CET 2025: Completed iteration 58

=== Iteration 59/300 ===
Mon Nov 10 05:35:01 PM CET 2025: Starting company car negotiation iteration 59 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 59 completed successfully
Mon Nov 10 05:35:39 PM CET 2025: Completed iteration 59

=== Iteration 60/300 ===
Mon Nov 10 05:35:39 PM CET 2025: Starting company car negotiation iteration 60 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,400 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1379.22, model_a surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41158.45, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 60 completed successfully
Mon Nov 10 05:36:14 PM CET 2025: Completed iteration 60

=== Iteration 61/300 ===
Mon Nov 10 05:36:14 PM CET 2025: Starting company car negotiation iteration 61 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 61 completed successfully
Mon Nov 10 05:36:46 PM CET 2025: Completed iteration 61

=== Iteration 62/300 ===
Mon Nov 10 05:36:46 PM CET 2025: Starting company car negotiation iteration 62 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 62 completed successfully
Mon Nov 10 05:37:17 PM CET 2025: Completed iteration 62

=== Iteration 63/300 ===
Mon Nov 10 05:37:17 PM CET 2025: Starting company car negotiation iteration 63 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39414}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39414}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39414}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39414}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39414}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39414.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41622}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41622}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41622}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41622}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41622}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41622.0}
ğŸ’¡ Player model_a made offer â‚¬39,414 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,622 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬41,622 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=41622
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -2439.46 (saved â‚¬-2439.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 4350.81 (profit â‚¬4350.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=36743.07, seller=41622.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-2439.46, model_b surplus=4350.81
âœ… Calculated utility_surplus: {'model_a': -2439.4633750000066, 'model_b': 4350.806625000005}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 36743.07324999999, 'model_b': 41622.0}
Metrics: {'utility_surplus': {'model_a': -2439.4633750000066, 'model_b': 4350.806625000005}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 63 completed successfully
Mon Nov 10 05:37:54 PM CET 2025: Completed iteration 63

=== Iteration 64/300 ===
Mon Nov 10 05:37:54 PM CET 2025: Starting company car negotiation iteration 64 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 64 completed successfully
Mon Nov 10 05:38:20 PM CET 2025: Completed iteration 64

=== Iteration 65/300 ===
Mon Nov 10 05:38:20 PM CET 2025: Starting company car negotiation iteration 65 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-220.78, model_b surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39558.45, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 65 completed successfully
Mon Nov 10 05:38:49 PM CET 2025: Completed iteration 65

=== Iteration 66/300 ===
Mon Nov 10 05:38:49 PM CET 2025: Starting company car negotiation iteration 66 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 66 completed successfully
Mon Nov 10 05:39:20 PM CET 2025: Completed iteration 66

=== Iteration 67/300 ===
Mon Nov 10 05:39:20 PM CET 2025: Starting company car negotiation iteration 67 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 67 completed successfully
Mon Nov 10 05:39:56 PM CET 2025: Completed iteration 67

=== Iteration 68/300 ===
Mon Nov 10 05:39:56 PM CET 2025: Starting company car negotiation iteration 68 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬26,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41666}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41666}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41666}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41666}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41666}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41666.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬41,666 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬41,666 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=41666
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1886.78 (saved â‚¬-1886.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3827.22 (profit â‚¬3827.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37892.45, seller=41666.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1886.78, model_b surplus=3827.22
âœ… Calculated utility_surplus: {'model_a': -1886.7750000000015, 'model_b': 3827.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 37892.45, 'model_b': 41666.0}
Metrics: {'utility_surplus': {'model_a': -1886.7750000000015, 'model_b': 3827.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 68 completed successfully
Mon Nov 10 05:40:23 PM CET 2025: Completed iteration 68

=== Iteration 69/300 ===
Mon Nov 10 05:40:23 PM CET 2025: Starting company car negotiation iteration 69 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 69 completed successfully
Mon Nov 10 05:41:09 PM CET 2025: Completed iteration 69

=== Iteration 70/300 ===
Mon Nov 10 05:41:09 PM CET 2025: Starting company car negotiation iteration 70 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.68s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1182.54 (saved â‚¬1182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 728.81 (profit â‚¬728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40365.07, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1182.54, model_b surplus=728.81
âœ… Calculated utility_surplus: {'model_a': 1182.5366249999934, 'model_b': 728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40365.07324999999, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1182.5366249999934, 'model_b': 728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 70 completed successfully
Mon Nov 10 05:41:42 PM CET 2025: Completed iteration 70

=== Iteration 71/300 ===
Mon Nov 10 05:41:42 PM CET 2025: Starting company car negotiation iteration 71 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40379\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40379\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40379\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40379}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40379}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40379.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,379 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 71 completed successfully
Mon Nov 10 05:42:25 PM CET 2025: Completed iteration 71

=== Iteration 72/300 ===
Mon Nov 10 05:42:25 PM CET 2025: Starting company car negotiation iteration 72 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.06s (total since entry 9.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1500.00, model_b surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 1500.0, 'model_b': 500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42500.0, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1500.0, 'model_b': 500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 72 completed successfully
Mon Nov 10 05:42:47 PM CET 2025: Completed iteration 72

=== Iteration 73/300 ===
Mon Nov 10 05:42:47 PM CET 2025: Starting company car negotiation iteration 73 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 73 completed successfully
Mon Nov 10 05:43:13 PM CET 2025: Completed iteration 73

=== Iteration 74/300 ===
Mon Nov 10 05:43:13 PM CET 2025: Starting company car negotiation iteration 74 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 74 completed successfully
Mon Nov 10 05:43:52 PM CET 2025: Completed iteration 74

=== Iteration 75/300 ===
Mon Nov 10 05:43:52 PM CET 2025: Starting company car negotiation iteration 75 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬29,750 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 75 completed successfully
Mon Nov 10 05:44:18 PM CET 2025: Completed iteration 75

=== Iteration 76/300 ===
Mon Nov 10 05:44:18 PM CET 2025: Starting company car negotiation iteration 76 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=279.22, model_a surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 1661.2249999999985, 'model_b': 279.22499999999854}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40058.45, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1661.2249999999985, 'model_b': 279.22499999999854}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 76 completed successfully
Mon Nov 10 05:44:50 PM CET 2025: Completed iteration 76

=== Iteration 77/300 ===
Mon Nov 10 05:44:50 PM CET 2025: Starting company car negotiation iteration 77 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.58s (total since entry 5.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,650 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 77 completed successfully
Mon Nov 10 05:45:27 PM CET 2025: Completed iteration 77

=== Iteration 78/300 ===
Mon Nov 10 05:45:27 PM CET 2025: Starting company car negotiation iteration 78 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=779.22, model_a surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40558.45, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 78 completed successfully
Mon Nov 10 05:46:00 PM CET 2025: Completed iteration 78

=== Iteration 79/300 ===
Mon Nov 10 05:46:00 PM CET 2025: Starting company car negotiation iteration 79 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.57s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 79 completed successfully
Mon Nov 10 05:46:34 PM CET 2025: Completed iteration 79

=== Iteration 80/300 ===
Mon Nov 10 05:46:34 PM CET 2025: Starting company car negotiation iteration 80 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬36,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3182.54 (saved â‚¬3182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1271.19 (profit â‚¬-1271.19 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42365.07, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3182.54, model_a surplus=-1271.19
âœ… Calculated utility_surplus: {'model_a': -1271.1933749999953, 'model_b': 3182.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 42365.07324999999, 'model_a': 36000.0}
Metrics: {'utility_surplus': {'model_a': -1271.1933749999953, 'model_b': 3182.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 80 completed successfully
Mon Nov 10 05:47:07 PM CET 2025: Completed iteration 80

=== Iteration 81/300 ===
Mon Nov 10 05:47:07 PM CET 2025: Starting company car negotiation iteration 81 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 81 completed successfully
Mon Nov 10 05:47:43 PM CET 2025: Completed iteration 81

=== Iteration 82/300 ===
Mon Nov 10 05:47:43 PM CET 2025: Starting company car negotiation iteration 82 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38512}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38512}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38512}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38512}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38512}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38512.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 82 completed successfully
Mon Nov 10 05:48:24 PM CET 2025: Completed iteration 82

=== Iteration 83/300 ===
Mon Nov 10 05:48:24 PM CET 2025: Starting company car negotiation iteration 83 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.86s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3385.00 (saved â‚¬3385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1415.00 (profit â‚¬-1415.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43770.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=3385.00, model_b surplus=-1415.00
âœ… Calculated utility_surplus: {'model_a': 3385.0, 'model_b': -1415.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 43770.0, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 3385.0, 'model_b': -1415.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 83 completed successfully
Mon Nov 10 05:48:50 PM CET 2025: Completed iteration 83

=== Iteration 84/300 ===
Mon Nov 10 05:48:50 PM CET 2025: Starting company car negotiation iteration 84 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1179.22, model_b surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40958.45, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 84 completed successfully
Mon Nov 10 05:49:14 PM CET 2025: Completed iteration 84

=== Iteration 85/300 ===
Mon Nov 10 05:49:14 PM CET 2025: Starting company car negotiation iteration 85 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 85 completed successfully
Mon Nov 10 05:49:46 PM CET 2025: Completed iteration 85

=== Iteration 86/300 ===
Mon Nov 10 05:49:46 PM CET 2025: Starting company car negotiation iteration 86 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3385.00 (saved â‚¬3385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1415.00 (profit â‚¬-1415.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43770.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3385.00, model_a surplus=-1415.00
âœ… Calculated utility_surplus: {'model_a': -1415.0, 'model_b': 3385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 43770.0, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': -1415.0, 'model_b': 3385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 86 completed successfully
Mon Nov 10 05:50:16 PM CET 2025: Completed iteration 86

=== Iteration 87/300 ===
Mon Nov 10 05:50:16 PM CET 2025: Starting company car negotiation iteration 87 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38415\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38415\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38415\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,415 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38415
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 767.54 (saved â‚¬767.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1143.81 (profit â‚¬1143.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39950.07, seller=38415.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=767.54, model_b surplus=1143.81
âœ… Calculated utility_surplus: {'model_a': 767.5366249999934, 'model_b': 1143.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39950.07324999999, 'model_b': 38415.0}
Metrics: {'utility_surplus': {'model_a': 767.5366249999934, 'model_b': 1143.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 87 completed successfully
Mon Nov 10 05:50:48 PM CET 2025: Completed iteration 87

=== Iteration 88/300 ===
Mon Nov 10 05:50:48 PM CET 2025: Starting company car negotiation iteration 88 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 88 completed successfully
Mon Nov 10 05:51:36 PM CET 2025: Completed iteration 88

=== Iteration 89/300 ===
Mon Nov 10 05:51:36 PM CET 2025: Starting company car negotiation iteration 89 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬26,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 89 completed successfully
Mon Nov 10 05:52:25 PM CET 2025: Completed iteration 89

=== Iteration 90/300 ===
Mon Nov 10 05:52:25 PM CET 2025: Starting company car negotiation iteration 90 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.63s (total since entry 9.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 90 completed successfully
Mon Nov 10 05:53:00 PM CET 2025: Completed iteration 90

=== Iteration 91/300 ===
Mon Nov 10 05:53:00 PM CET 2025: Starting company car negotiation iteration 91 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39614}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39614}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39614}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39614}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39614}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39614.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,614 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 91 completed successfully
Mon Nov 10 05:53:30 PM CET 2025: Completed iteration 91

=== Iteration 92/300 ===
Mon Nov 10 05:53:30 PM CET 2025: Starting company car negotiation iteration 92 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,700 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -105.20 (saved â‚¬-105.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1987.87 (profit â‚¬1987.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38489.60, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-105.20, model_a surplus=1987.87
âœ… Calculated utility_surplus: {'model_a': 1987.8745256249967, 'model_b': -105.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38489.59715125, 'model_a': 38700.0}
Metrics: {'utility_surplus': {'model_a': 1987.8745256249967, 'model_b': -105.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 92 completed successfully
Mon Nov 10 05:54:12 PM CET 2025: Completed iteration 92

=== Iteration 93/300 ===
Mon Nov 10 05:54:12 PM CET 2025: Starting company car negotiation iteration 93 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.90s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 93 completed successfully
Mon Nov 10 05:54:43 PM CET 2025: Completed iteration 93

=== Iteration 94/300 ===
Mon Nov 10 05:54:43 PM CET 2025: Starting company car negotiation iteration 94 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.69s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26900.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬26,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2779.22 (saved â‚¬2779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -838.78 (profit â‚¬-838.78 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42558.45, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2779.22, model_b surplus=-838.78
âœ… Calculated utility_surplus: {'model_a': 2779.2249999999985, 'model_b': -838.7750000000015}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 42558.45, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 2779.2249999999985, 'model_b': -838.7750000000015}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 94 completed successfully
Mon Nov 10 05:55:10 PM CET 2025: Completed iteration 94

=== Iteration 95/300 ===
Mon Nov 10 05:55:10 PM CET 2025: Starting company car negotiation iteration 95 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 95 completed successfully
Mon Nov 10 05:55:50 PM CET 2025: Completed iteration 95

=== Iteration 96/300 ===
Mon Nov 10 05:55:50 PM CET 2025: Starting company car negotiation iteration 96 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1029.22 (saved â‚¬1029.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 911.22 (profit â‚¬911.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40808.45, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1029.22, model_b surplus=911.22
âœ… Calculated utility_surplus: {'model_a': 1029.2249999999985, 'model_b': 911.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40808.45, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 1029.2249999999985, 'model_b': 911.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 96 completed successfully
Mon Nov 10 05:56:18 PM CET 2025: Completed iteration 96

=== Iteration 97/300 ===
Mon Nov 10 05:56:18 PM CET 2025: Starting company car negotiation iteration 97 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 97 completed successfully
Mon Nov 10 05:56:48 PM CET 2025: Completed iteration 97

=== Iteration 98/300 ===
Mon Nov 10 05:56:48 PM CET 2025: Starting company car negotiation iteration 98 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 5.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 98 completed successfully
Mon Nov 10 05:57:23 PM CET 2025: Completed iteration 98

=== Iteration 99/300 ===
Mon Nov 10 05:57:23 PM CET 2025: Starting company car negotiation iteration 99 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 99 completed successfully
Mon Nov 10 05:57:50 PM CET 2025: Completed iteration 99

=== Iteration 100/300 ===
Mon Nov 10 05:57:50 PM CET 2025: Starting company car negotiation iteration 100 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 100 completed successfully
Mon Nov 10 05:58:34 PM CET 2025: Completed iteration 100

=== Iteration 101/300 ===
Mon Nov 10 05:58:34 PM CET 2025: Starting company car negotiation iteration 101 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40950}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40950}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40950}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40950}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,950 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37165}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37165}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37165}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37165}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37165}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37165.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,165 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 101 completed successfully
Mon Nov 10 05:59:06 PM CET 2025: Completed iteration 101

=== Iteration 102/300 ===
Mon Nov 10 05:59:06 PM CET 2025: Starting company car negotiation iteration 102 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2885.00 (saved â‚¬2885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -915.00 (profit â‚¬-915.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43270.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2885.00, model_b surplus=-915.00
âœ… Calculated utility_surplus: {'model_a': 2885.0, 'model_b': -915.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 43270.0, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 2885.0, 'model_b': -915.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 102 completed successfully
Mon Nov 10 05:59:32 PM CET 2025: Completed iteration 102

=== Iteration 103/300 ===
Mon Nov 10 05:59:32 PM CET 2025: Starting company car negotiation iteration 103 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.61s (total since entry 5.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬26,700 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38100\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38100\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38100\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,100 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1082.54 (saved â‚¬1082.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 828.81 (profit â‚¬828.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40265.07, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1082.54, model_a surplus=828.81
âœ… Calculated utility_surplus: {'model_a': 828.8066250000047, 'model_b': 1082.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40265.07324999999, 'model_a': 38100.0}
Metrics: {'utility_surplus': {'model_a': 828.8066250000047, 'model_b': 1082.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 103 completed successfully
Mon Nov 10 06:00:06 PM CET 2025: Completed iteration 103

=== Iteration 104/300 ===
Mon Nov 10 06:00:06 PM CET 2025: Starting company car negotiation iteration 104 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1785.00 (saved â‚¬1785.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 185.00 (profit â‚¬185.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42170.00, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1785.00, model_b surplus=185.00
âœ… Calculated utility_surplus: {'model_a': 1785.0, 'model_b': 185.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42170.0, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1785.0, 'model_b': 185.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 104 completed successfully
Mon Nov 10 06:00:32 PM CET 2025: Completed iteration 104

=== Iteration 105/300 ===
Mon Nov 10 06:00:32 PM CET 2025: Starting company car negotiation iteration 105 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.73s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 105 completed successfully
Mon Nov 10 06:00:51 PM CET 2025: Completed iteration 105

=== Iteration 106/300 ===
Mon Nov 10 06:00:51 PM CET 2025: Starting company car negotiation iteration 106 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,839 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 106 completed successfully
Mon Nov 10 06:01:34 PM CET 2025: Completed iteration 106

=== Iteration 107/300 ===
Mon Nov 10 06:01:34 PM CET 2025: Starting company car negotiation iteration 107 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.47s (total since entry 4.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41666}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41666}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41666}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41666}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41666}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41666.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬41,666 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1182.54 (saved â‚¬1182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 728.81 (profit â‚¬728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40365.07, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1182.54, model_a surplus=728.81
âœ… Calculated utility_surplus: {'model_a': 728.8066250000047, 'model_b': 1182.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40365.07324999999, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 728.8066250000047, 'model_b': 1182.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 107 completed successfully
Mon Nov 10 06:02:01 PM CET 2025: Completed iteration 107

=== Iteration 108/300 ===
Mon Nov 10 06:02:01 PM CET 2025: Starting company car negotiation iteration 108 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,750 (made in round 2)
ğŸ” [BATNA DEBUG] Round 4: price=37750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1432.54 (saved â‚¬1432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 478.81 (profit â‚¬478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40615.07, seller=37750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1432.54, model_a surplus=478.81
âœ… Calculated utility_surplus: {'model_a': 478.8066250000047, 'model_b': 1432.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40615.07324999999, 'model_a': 37750.0}
Metrics: {'utility_surplus': {'model_a': 478.8066250000047, 'model_b': 1432.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 108 completed successfully
Mon Nov 10 06:02:34 PM CET 2025: Completed iteration 108

=== Iteration 109/300 ===
Mon Nov 10 06:02:34 PM CET 2025: Starting company car negotiation iteration 109 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36417}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36417}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36417}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36417}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36417}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36417.0}
ğŸ’¡ Player model_a made offer â‚¬37,700 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,417 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 109 completed successfully
Mon Nov 10 06:03:13 PM CET 2025: Completed iteration 109

=== Iteration 110/300 ===
Mon Nov 10 06:03:13 PM CET 2025: Starting company car negotiation iteration 110 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.65s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2500.00, model_a surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': -500.0, 'model_b': 2500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43500.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': -500.0, 'model_b': 2500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 110 completed successfully
Mon Nov 10 06:03:38 PM CET 2025: Completed iteration 110

=== Iteration 111/300 ===
Mon Nov 10 06:03:38 PM CET 2025: Starting company car negotiation iteration 111 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 111 completed successfully
Mon Nov 10 06:04:11 PM CET 2025: Completed iteration 111

=== Iteration 112/300 ===
Mon Nov 10 06:04:11 PM CET 2025: Starting company car negotiation iteration 112 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 112 completed successfully
Mon Nov 10 06:04:38 PM CET 2025: Completed iteration 112

=== Iteration 113/300 ===
Mon Nov 10 06:04:38 PM CET 2025: Starting company car negotiation iteration 113 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.93s (total since entry 9.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2500.00, model_b surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': 2500.0, 'model_b': -500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43500.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 2500.0, 'model_b': -500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 113 completed successfully
Mon Nov 10 06:05:00 PM CET 2025: Completed iteration 113

=== Iteration 114/300 ===
Mon Nov 10 06:05:00 PM CET 2025: Starting company car negotiation iteration 114 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 114 completed successfully
Mon Nov 10 06:05:35 PM CET 2025: Completed iteration 114

=== Iteration 115/300 ===
Mon Nov 10 06:05:35 PM CET 2025: Starting company car negotiation iteration 115 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 115 completed successfully
Mon Nov 10 06:06:12 PM CET 2025: Completed iteration 115

=== Iteration 116/300 ===
Mon Nov 10 06:06:12 PM CET 2025: Starting company car negotiation iteration 116 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38140}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38140}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38140}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38140}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38140}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38140.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,140 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 116 completed successfully
Mon Nov 10 06:06:45 PM CET 2025: Completed iteration 116

=== Iteration 117/300 ===
Mon Nov 10 06:06:45 PM CET 2025: Starting company car negotiation iteration 117 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.91s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40197}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40197}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40197}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40197}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40197}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40197.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,197 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,839 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 117 completed successfully
Mon Nov 10 06:07:26 PM CET 2025: Completed iteration 117

=== Iteration 118/300 ===
Mon Nov 10 06:07:26 PM CET 2025: Starting company car negotiation iteration 118 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.58s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 118 completed successfully
Mon Nov 10 06:07:49 PM CET 2025: Completed iteration 118

=== Iteration 119/300 ===
Mon Nov 10 06:07:49 PM CET 2025: Starting company car negotiation iteration 119 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 119 completed successfully
Mon Nov 10 06:08:16 PM CET 2025: Completed iteration 119

=== Iteration 120/300 ===
Mon Nov 10 06:08:16 PM CET 2025: Starting company car negotiation iteration 120 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.86s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 120 completed successfully
Mon Nov 10 06:08:45 PM CET 2025: Completed iteration 120

=== Iteration 121/300 ===
Mon Nov 10 06:08:45 PM CET 2025: Starting company car negotiation iteration 121 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 121 completed successfully
Mon Nov 10 06:09:16 PM CET 2025: Completed iteration 121

=== Iteration 122/300 ===
Mon Nov 10 06:09:16 PM CET 2025: Starting company car negotiation iteration 122 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.49s (total since entry 4.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,999 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=37999
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2386.00 (saved â‚¬2386.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -416.00 (profit â‚¬-416.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42771.00, seller=37999.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2386.00, model_a surplus=-416.00
âœ… Calculated utility_surplus: {'model_a': -416.0, 'model_b': 2386.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42771.0, 'model_a': 37999.0}
Metrics: {'utility_surplus': {'model_a': -416.0, 'model_b': 2386.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 122 completed successfully
Mon Nov 10 06:09:39 PM CET 2025: Completed iteration 122

=== Iteration 123/300 ===
Mon Nov 10 06:09:39 PM CET 2025: Starting company car negotiation iteration 123 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 123 completed successfully
Mon Nov 10 06:10:00 PM CET 2025: Completed iteration 123

=== Iteration 124/300 ===
Mon Nov 10 06:10:00 PM CET 2025: Starting company car negotiation iteration 124 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 124 completed successfully
Mon Nov 10 06:10:37 PM CET 2025: Completed iteration 124

=== Iteration 125/300 ===
Mon Nov 10 06:10:37 PM CET 2025: Starting company car negotiation iteration 125 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 125 completed successfully
Mon Nov 10 06:11:09 PM CET 2025: Completed iteration 125

=== Iteration 126/300 ===
Mon Nov 10 06:11:09 PM CET 2025: Starting company car negotiation iteration 126 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2500.00, model_b surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': 2500.0, 'model_b': -500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43500.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 2500.0, 'model_b': -500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 126 completed successfully
Mon Nov 10 06:11:32 PM CET 2025: Completed iteration 126

=== Iteration 127/300 ===
Mon Nov 10 06:11:32 PM CET 2025: Starting company car negotiation iteration 127 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.60s (total since entry 5.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1785.00 (saved â‚¬1785.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 185.00 (profit â‚¬185.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42170.00, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1785.00, model_b surplus=185.00
âœ… Calculated utility_surplus: {'model_a': 1785.0, 'model_b': 185.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42170.0, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1785.0, 'model_b': 185.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 127 completed successfully
Mon Nov 10 06:11:54 PM CET 2025: Completed iteration 127

=== Iteration 128/300 ===
Mon Nov 10 06:11:54 PM CET 2025: Starting company car negotiation iteration 128 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 128 completed successfully
Mon Nov 10 06:12:20 PM CET 2025: Completed iteration 128

=== Iteration 129/300 ===
Mon Nov 10 06:12:20 PM CET 2025: Starting company car negotiation iteration 129 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
âœ… Player model_a accepted offer of â‚¬39,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=39400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -805.20 (saved â‚¬-805.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2687.87 (profit â‚¬2687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37789.60, seller=39400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-805.20, model_b surplus=2687.87
âœ… Calculated utility_surplus: {'model_a': -805.2014243750018, 'model_b': 2687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 37789.59715125, 'model_b': 39400.0}
Metrics: {'utility_surplus': {'model_a': -805.2014243750018, 'model_b': 2687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 129 completed successfully
Mon Nov 10 06:12:56 PM CET 2025: Completed iteration 129

=== Iteration 130/300 ===
Mon Nov 10 06:12:56 PM CET 2025: Starting company car negotiation iteration 130 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 130 completed successfully
Mon Nov 10 06:13:31 PM CET 2025: Completed iteration 130

=== Iteration 131/300 ===
Mon Nov 10 06:13:31 PM CET 2025: Starting company car negotiation iteration 131 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬27,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=279.22, model_b surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40058.45, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 131 completed successfully
Mon Nov 10 06:13:59 PM CET 2025: Completed iteration 131

=== Iteration 132/300 ===
Mon Nov 10 06:13:59 PM CET 2025: Starting company car negotiation iteration 132 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 132 completed successfully
Mon Nov 10 06:14:24 PM CET 2025: Completed iteration 132

=== Iteration 133/300 ===
Mon Nov 10 06:14:24 PM CET 2025: Starting company car negotiation iteration 133 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 133 completed successfully
Mon Nov 10 06:14:51 PM CET 2025: Completed iteration 133

=== Iteration 134/300 ===
Mon Nov 10 06:14:51 PM CET 2025: Starting company car negotiation iteration 134 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38460}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38460}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38460}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38460}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38460}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38460.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,460 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 134 completed successfully
Mon Nov 10 06:15:33 PM CET 2025: Completed iteration 134

=== Iteration 135/300 ===
Mon Nov 10 06:15:33 PM CET 2025: Starting company car negotiation iteration 135 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39700.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 135 completed successfully
Mon Nov 10 06:16:13 PM CET 2025: Completed iteration 135

=== Iteration 136/300 ===
Mon Nov 10 06:16:13 PM CET 2025: Starting company car negotiation iteration 136 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.51s (total since entry 4.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,200 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=39200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1185.00 (saved â‚¬1185.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 785.00 (profit â‚¬785.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41570.00, seller=39200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1185.00, model_b surplus=785.00
âœ… Calculated utility_surplus: {'model_a': 1185.0, 'model_b': 785.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41570.0, 'model_b': 39200.0}
Metrics: {'utility_surplus': {'model_a': 1185.0, 'model_b': 785.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 136 completed successfully
Mon Nov 10 06:16:36 PM CET 2025: Completed iteration 136

=== Iteration 137/300 ===
Mon Nov 10 06:16:36 PM CET 2025: Starting company car negotiation iteration 137 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38276}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38276}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38276}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38276}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38276}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38276.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,276 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 137 completed successfully
Mon Nov 10 06:17:08 PM CET 2025: Completed iteration 137

=== Iteration 138/300 ===
Mon Nov 10 06:17:08 PM CET 2025: Starting company car negotiation iteration 138 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.63s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,850 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 138 completed successfully
Mon Nov 10 06:17:43 PM CET 2025: Completed iteration 138

=== Iteration 139/300 ===
Mon Nov 10 06:17:43 PM CET 2025: Starting company car negotiation iteration 139 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=982.54, model_a surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40165.07324999999, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 139 completed successfully
Mon Nov 10 06:18:14 PM CET 2025: Completed iteration 139

=== Iteration 140/300 ===
Mon Nov 10 06:18:14 PM CET 2025: Starting company car negotiation iteration 140 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 140 completed successfully
Mon Nov 10 06:19:05 PM CET 2025: Completed iteration 140

=== Iteration 141/300 ===
Mon Nov 10 06:19:05 PM CET 2025: Starting company car negotiation iteration 141 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,750 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 141 completed successfully
Mon Nov 10 06:19:49 PM CET 2025: Completed iteration 141

=== Iteration 142/300 ===
Mon Nov 10 06:19:49 PM CET 2025: Starting company car negotiation iteration 142 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 142 completed successfully
Mon Nov 10 06:20:12 PM CET 2025: Completed iteration 142

=== Iteration 143/300 ===
Mon Nov 10 06:20:12 PM CET 2025: Starting company car negotiation iteration 143 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2500.00, model_b surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': 2500.0, 'model_b': -500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43500.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 2500.0, 'model_b': -500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 143 completed successfully
Mon Nov 10 06:20:36 PM CET 2025: Completed iteration 143

=== Iteration 144/300 ===
Mon Nov 10 06:20:36 PM CET 2025: Starting company car negotiation iteration 144 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.03s (total since entry 9.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 144 completed successfully
Mon Nov 10 06:21:05 PM CET 2025: Completed iteration 144

=== Iteration 145/300 ===
Mon Nov 10 06:21:05 PM CET 2025: Starting company car negotiation iteration 145 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 145 completed successfully
Mon Nov 10 06:21:43 PM CET 2025: Completed iteration 145

=== Iteration 146/300 ===
Mon Nov 10 06:21:43 PM CET 2025: Starting company car negotiation iteration 146 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬29,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 146 completed successfully
Mon Nov 10 06:22:23 PM CET 2025: Completed iteration 146

=== Iteration 147/300 ===
Mon Nov 10 06:22:23 PM CET 2025: Starting company car negotiation iteration 147 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1682.54, model_a surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 228.80662500000471, 'model_b': 1682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40865.07324999999, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 228.80662500000471, 'model_b': 1682.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 147 completed successfully
Mon Nov 10 06:23:00 PM CET 2025: Completed iteration 147

=== Iteration 148/300 ===
Mon Nov 10 06:23:00 PM CET 2025: Starting company car negotiation iteration 148 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 148 completed successfully
Mon Nov 10 06:23:33 PM CET 2025: Completed iteration 148

=== Iteration 149/300 ===
Mon Nov 10 06:23:33 PM CET 2025: Starting company car negotiation iteration 149 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37840}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37840}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37840}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37840}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37840}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37840.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,840 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 149 completed successfully
Mon Nov 10 06:24:08 PM CET 2025: Completed iteration 149

=== Iteration 150/300 ===
Mon Nov 10 06:24:08 PM CET 2025: Starting company car negotiation iteration 150 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37467}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37467}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37467}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37467}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37467}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37467.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,467 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=982.54, model_a surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 33.33333333333333, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40165.07324999999, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}, 'risk_minimization': {'model_a': 33.33333333333333, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 150 completed successfully
Mon Nov 10 06:24:43 PM CET 2025: Completed iteration 150

=== Iteration 151/300 ===
Mon Nov 10 06:24:43 PM CET 2025: Starting company car negotiation iteration 151 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 151 completed successfully
Mon Nov 10 06:25:11 PM CET 2025: Completed iteration 151

=== Iteration 152/300 ===
Mon Nov 10 06:25:11 PM CET 2025: Starting company car negotiation iteration 152 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.57s (total since entry 5.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -317.46 (saved â‚¬-317.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2228.81 (profit â‚¬2228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38865.07, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-317.46, model_b surplus=2228.81
âœ… Calculated utility_surplus: {'model_a': -317.46337500000664, 'model_b': 2228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 38865.07324999999, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': -317.46337500000664, 'model_b': 2228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 152 completed successfully
Mon Nov 10 06:25:41 PM CET 2025: Completed iteration 152

=== Iteration 153/300 ===
Mon Nov 10 06:25:41 PM CET 2025: Starting company car negotiation iteration 153 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 153 completed successfully
Mon Nov 10 06:26:07 PM CET 2025: Completed iteration 153

=== Iteration 154/300 ===
Mon Nov 10 06:26:07 PM CET 2025: Starting company car negotiation iteration 154 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 154 completed successfully
Mon Nov 10 06:26:32 PM CET 2025: Completed iteration 154

=== Iteration 155/300 ===
Mon Nov 10 06:26:32 PM CET 2025: Starting company car negotiation iteration 155 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.62s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 155 completed successfully
Mon Nov 10 06:27:03 PM CET 2025: Completed iteration 155

=== Iteration 156/300 ===
Mon Nov 10 06:27:03 PM CET 2025: Starting company car negotiation iteration 156 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 156 completed successfully
Mon Nov 10 06:27:30 PM CET 2025: Completed iteration 156

=== Iteration 157/300 ===
Mon Nov 10 06:27:30 PM CET 2025: Starting company car negotiation iteration 157 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.49s (total since entry 4.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27900.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36125}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36125}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36125}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36125}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36125}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36125.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,125 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 157 completed successfully
Mon Nov 10 06:28:06 PM CET 2025: Completed iteration 157

=== Iteration 158/300 ===
Mon Nov 10 06:28:06 PM CET 2025: Starting company car negotiation iteration 158 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 158 completed successfully
Mon Nov 10 06:28:36 PM CET 2025: Completed iteration 158

=== Iteration 159/300 ===
Mon Nov 10 06:28:36 PM CET 2025: Starting company car negotiation iteration 159 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29999.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬37,999 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 159 completed successfully
Mon Nov 10 06:29:15 PM CET 2025: Completed iteration 159

=== Iteration 160/300 ===
Mon Nov 10 06:29:15 PM CET 2025: Starting company car negotiation iteration 160 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1615.00, model_b surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': -1615.0, 'model_b': 3585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 38770.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1615.0, 'model_b': 3585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 160 completed successfully
Mon Nov 10 06:29:38 PM CET 2025: Completed iteration 160

=== Iteration 161/300 ===
Mon Nov 10 06:29:38 PM CET 2025: Starting company car negotiation iteration 161 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 161 completed successfully
Mon Nov 10 06:30:00 PM CET 2025: Completed iteration 161

=== Iteration 162/300 ===
Mon Nov 10 06:30:00 PM CET 2025: Starting company car negotiation iteration 162 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39617}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39617}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39617}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39617}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39617}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39617.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,617 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,617 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39617
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 768.00 (saved â‚¬768.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1202.00 (profit â‚¬1202.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41153.00, seller=39617.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=768.00, model_a surplus=1202.00
âœ… Calculated utility_surplus: {'model_a': 1202.0, 'model_b': 768.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41153.0, 'model_a': 39617.0}
Metrics: {'utility_surplus': {'model_a': 1202.0, 'model_b': 768.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 162 completed successfully
Mon Nov 10 06:30:21 PM CET 2025: Completed iteration 162

=== Iteration 163/300 ===
Mon Nov 10 06:30:21 PM CET 2025: Starting company car negotiation iteration 163 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=279.22, model_b surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40058.45, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 163 completed successfully
Mon Nov 10 06:30:50 PM CET 2025: Completed iteration 163

=== Iteration 164/300 ===
Mon Nov 10 06:30:50 PM CET 2025: Starting company car negotiation iteration 164 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 164 completed successfully
Mon Nov 10 06:31:19 PM CET 2025: Completed iteration 164

=== Iteration 165/300 ===
Mon Nov 10 06:31:19 PM CET 2025: Starting company car negotiation iteration 165 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 165 completed successfully
Mon Nov 10 06:32:00 PM CET 2025: Completed iteration 165

=== Iteration 166/300 ===
Mon Nov 10 06:32:00 PM CET 2025: Starting company car negotiation iteration 166 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37160}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37160}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37160}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37160}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37160}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37160.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,160 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39183}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39183}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39183}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39183}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39183}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39183.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,183 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,183 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39183
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -588.20 (saved â‚¬-588.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2470.87 (profit â‚¬2470.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38006.60, seller=39183.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-588.20, model_b surplus=2470.87
âœ… Calculated utility_surplus: {'model_a': -588.2014243750018, 'model_b': 2470.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38006.59715125, 'model_b': 39183.0}
Metrics: {'utility_surplus': {'model_a': -588.2014243750018, 'model_b': 2470.8745256249967}, 'risk_minimization': {'model_a': 75.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 166 completed successfully
Mon Nov 10 06:32:41 PM CET 2025: Completed iteration 166

=== Iteration 167/300 ===
Mon Nov 10 06:32:41 PM CET 2025: Starting company car negotiation iteration 167 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=982.54, model_a surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40165.07324999999, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 167 completed successfully
Mon Nov 10 06:33:19 PM CET 2025: Completed iteration 167

=== Iteration 168/300 ===
Mon Nov 10 06:33:19 PM CET 2025: Starting company car negotiation iteration 168 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 168 completed successfully
Mon Nov 10 06:33:42 PM CET 2025: Completed iteration 168

=== Iteration 169/300 ===
Mon Nov 10 06:33:42 PM CET 2025: Starting company car negotiation iteration 169 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 4000.00 (saved â‚¬4000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -2000.00 (profit â‚¬-2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=45000.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=4000.00, model_b surplus=-2000.00
âœ… Calculated utility_surplus: {'model_a': 4000.0, 'model_b': -2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 45000.0, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 4000.0, 'model_b': -2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 169 completed successfully
Mon Nov 10 06:34:04 PM CET 2025: Completed iteration 169

=== Iteration 170/300 ===
Mon Nov 10 06:34:04 PM CET 2025: Starting company car negotiation iteration 170 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.67s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 170 completed successfully
Mon Nov 10 06:34:45 PM CET 2025: Completed iteration 170

=== Iteration 171/300 ===
Mon Nov 10 06:34:45 PM CET 2025: Starting company car negotiation iteration 171 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.51s (total since entry 4.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 171 completed successfully
Mon Nov 10 06:35:23 PM CET 2025: Completed iteration 171

=== Iteration 172/300 ===
Mon Nov 10 06:35:23 PM CET 2025: Starting company car negotiation iteration 172 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -905.20 (saved â‚¬-905.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2787.87 (profit â‚¬2787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37689.60, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-905.20, model_b surplus=2787.87
âœ… Calculated utility_surplus: {'model_a': -905.2014243750018, 'model_b': 2787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 37689.59715125, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': -905.2014243750018, 'model_b': 2787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 172 completed successfully
Mon Nov 10 06:36:04 PM CET 2025: Completed iteration 172

=== Iteration 173/300 ===
Mon Nov 10 06:36:04 PM CET 2025: Starting company car negotiation iteration 173 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.70s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 173 completed successfully
Mon Nov 10 06:36:45 PM CET 2025: Completed iteration 173

=== Iteration 174/300 ===
Mon Nov 10 06:36:45 PM CET 2025: Starting company car negotiation iteration 174 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,200 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=39200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1185.00 (saved â‚¬1185.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 785.00 (profit â‚¬785.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41570.00, seller=39200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1185.00, model_b surplus=785.00
âœ… Calculated utility_surplus: {'model_a': 1185.0, 'model_b': 785.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41570.0, 'model_b': 39200.0}
Metrics: {'utility_surplus': {'model_a': 1185.0, 'model_b': 785.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 174 completed successfully
Mon Nov 10 06:37:10 PM CET 2025: Completed iteration 174

=== Iteration 175/300 ===
Mon Nov 10 06:37:10 PM CET 2025: Starting company car negotiation iteration 175 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.58s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1500.00, model_b surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 1500.0, 'model_b': 500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42500.0, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1500.0, 'model_b': 500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 175 completed successfully
Mon Nov 10 06:37:29 PM CET 2025: Completed iteration 175

=== Iteration 176/300 ===
Mon Nov 10 06:37:29 PM CET 2025: Starting company car negotiation iteration 176 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 5.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,200 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=39200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1185.00 (saved â‚¬1185.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 785.00 (profit â‚¬785.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41570.00, seller=39200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1185.00, model_a surplus=785.00
âœ… Calculated utility_surplus: {'model_a': 785.0, 'model_b': 1185.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41570.0, 'model_a': 39200.0}
Metrics: {'utility_surplus': {'model_a': 785.0, 'model_b': 1185.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 176 completed successfully
Mon Nov 10 06:37:56 PM CET 2025: Completed iteration 176

=== Iteration 177/300 ===
Mon Nov 10 06:37:56 PM CET 2025: Starting company car negotiation iteration 177 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -155.20 (saved â‚¬-155.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2037.87 (profit â‚¬2037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38439.60, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-155.20, model_a surplus=2037.87
âœ… Calculated utility_surplus: {'model_a': 2037.8745256249967, 'model_b': -155.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38439.59715125, 'model_a': 38750.0}
Metrics: {'utility_surplus': {'model_a': 2037.8745256249967, 'model_b': -155.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 177 completed successfully
Mon Nov 10 06:38:30 PM CET 2025: Completed iteration 177

=== Iteration 178/300 ===
Mon Nov 10 06:38:30 PM CET 2025: Starting company car negotiation iteration 178 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.57s (total since entry 5.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.68s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 179.22 (saved â‚¬179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1761.22 (profit â‚¬1761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39958.45, seller=39600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=179.22, model_b surplus=1761.22
âœ… Calculated utility_surplus: {'model_a': 179.22499999999854, 'model_b': 1761.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39958.45, 'model_b': 39600.0}
Metrics: {'utility_surplus': {'model_a': 179.22499999999854, 'model_b': 1761.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 178 completed successfully
Mon Nov 10 06:38:59 PM CET 2025: Completed iteration 178

=== Iteration 179/300 ===
Mon Nov 10 06:38:59 PM CET 2025: Starting company car negotiation iteration 179 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.86s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -905.20 (saved â‚¬-905.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2787.87 (profit â‚¬2787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37689.60, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-905.20, model_b surplus=2787.87
âœ… Calculated utility_surplus: {'model_a': -905.2014243750018, 'model_b': 2787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 37689.59715125, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': -905.2014243750018, 'model_b': 2787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 179 completed successfully
Mon Nov 10 06:39:37 PM CET 2025: Completed iteration 179

=== Iteration 180/300 ===
Mon Nov 10 06:39:37 PM CET 2025: Starting company car negotiation iteration 180 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37615}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37615}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37615}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37615}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37615}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37615.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,615 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 180 completed successfully
Mon Nov 10 06:40:10 PM CET 2025: Completed iteration 180

=== Iteration 181/300 ===
Mon Nov 10 06:40:10 PM CET 2025: Starting company car negotiation iteration 181 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.47s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 181 completed successfully
Mon Nov 10 06:40:32 PM CET 2025: Completed iteration 181

=== Iteration 182/300 ===
Mon Nov 10 06:40:32 PM CET 2025: Starting company car negotiation iteration 182 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 182 completed successfully
Mon Nov 10 06:41:11 PM CET 2025: Completed iteration 182

=== Iteration 183/300 ===
Mon Nov 10 06:41:11 PM CET 2025: Starting company car negotiation iteration 183 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬38,100 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1679.22 (saved â‚¬1679.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 261.22 (profit â‚¬261.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41458.45, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1679.22, model_b surplus=261.22
âœ… Calculated utility_surplus: {'model_a': 1679.2249999999985, 'model_b': 261.22499999999854}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41458.45, 'model_b': 38100.0}
Metrics: {'utility_surplus': {'model_a': 1679.2249999999985, 'model_b': 261.22499999999854}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 183 completed successfully
Mon Nov 10 06:41:33 PM CET 2025: Completed iteration 183

=== Iteration 184/300 ===
Mon Nov 10 06:41:33 PM CET 2025: Starting company car negotiation iteration 184 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.90s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 184 completed successfully
Mon Nov 10 06:41:57 PM CET 2025: Completed iteration 184

=== Iteration 185/300 ===
Mon Nov 10 06:41:57 PM CET 2025: Starting company car negotiation iteration 185 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 185 completed successfully
Mon Nov 10 06:42:21 PM CET 2025: Completed iteration 185

=== Iteration 186/300 ===
Mon Nov 10 06:42:21 PM CET 2025: Starting company car negotiation iteration 186 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_a made offer â‚¬37,839 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 186 completed successfully
Mon Nov 10 06:43:01 PM CET 2025: Completed iteration 186

=== Iteration 187/300 ===
Mon Nov 10 06:43:01 PM CET 2025: Starting company car negotiation iteration 187 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 187 completed successfully
Mon Nov 10 06:43:22 PM CET 2025: Completed iteration 187

=== Iteration 188/300 ===
Mon Nov 10 06:43:22 PM CET 2025: Starting company car negotiation iteration 188 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.47s (total since entry 4.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.92s (total since entry 9.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 188 completed successfully
Mon Nov 10 06:43:42 PM CET 2025: Completed iteration 188

=== Iteration 189/300 ===
Mon Nov 10 06:43:42 PM CET 2025: Starting company car negotiation iteration 189 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 189 completed successfully
Mon Nov 10 06:44:10 PM CET 2025: Completed iteration 189

=== Iteration 190/300 ===
Mon Nov 10 06:44:10 PM CET 2025: Starting company car negotiation iteration 190 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.56s (total since entry 5.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 190 completed successfully
Mon Nov 10 06:44:32 PM CET 2025: Completed iteration 190

=== Iteration 191/300 ===
Mon Nov 10 06:44:32 PM CET 2025: Starting company car negotiation iteration 191 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39675}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39675}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39675}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39675}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39675}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39675.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,675 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,675 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39675
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 710.00 (saved â‚¬710.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1260.00 (profit â‚¬1260.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41095.00, seller=39675.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=710.00, model_b surplus=1260.00
âœ… Calculated utility_surplus: {'model_a': 710.0, 'model_b': 1260.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41095.0, 'model_b': 39675.0}
Metrics: {'utility_surplus': {'model_a': 710.0, 'model_b': 1260.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 191 completed successfully
Mon Nov 10 06:44:54 PM CET 2025: Completed iteration 191

=== Iteration 192/300 ===
Mon Nov 10 06:44:54 PM CET 2025: Starting company car negotiation iteration 192 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.86s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2500.00, model_b surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': 2500.0, 'model_b': -500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43500.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 2500.0, 'model_b': -500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 192 completed successfully
Mon Nov 10 06:45:19 PM CET 2025: Completed iteration 192

=== Iteration 193/300 ===
Mon Nov 10 06:45:19 PM CET 2025: Starting company car negotiation iteration 193 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.56s (total since entry 5.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39176}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39176}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39176}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39176}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39176}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39176.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,176 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 193 completed successfully
Mon Nov 10 06:45:44 PM CET 2025: Completed iteration 193

=== Iteration 194/300 ===
Mon Nov 10 06:45:44 PM CET 2025: Starting company car negotiation iteration 194 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1500.00, model_b surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 1500.0, 'model_b': 500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42500.0, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1500.0, 'model_b': 500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 194 completed successfully
Mon Nov 10 06:46:06 PM CET 2025: Completed iteration 194

=== Iteration 195/300 ===
Mon Nov 10 06:46:06 PM CET 2025: Starting company car negotiation iteration 195 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.68s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,700 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2300.00 (saved â‚¬2300.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -300.00 (profit â‚¬-300.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43300.00, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2300.00, model_b surplus=-300.00
âœ… Calculated utility_surplus: {'model_a': 2300.0, 'model_b': -300.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43300.0, 'model_b': 38700.0}
Metrics: {'utility_surplus': {'model_a': 2300.0, 'model_b': -300.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 195 completed successfully
Mon Nov 10 06:46:26 PM CET 2025: Completed iteration 195

=== Iteration 196/300 ===
Mon Nov 10 06:46:26 PM CET 2025: Starting company car negotiation iteration 196 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ’¡ Player model_b made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 196 completed successfully
Mon Nov 10 06:46:52 PM CET 2025: Completed iteration 196

=== Iteration 197/300 ===
Mon Nov 10 06:46:52 PM CET 2025: Starting company car negotiation iteration 197 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.69s (total since entry 9.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 197 completed successfully
Mon Nov 10 06:47:23 PM CET 2025: Completed iteration 197

=== Iteration 198/300 ===
Mon Nov 10 06:47:23 PM CET 2025: Starting company car negotiation iteration 198 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.91s (total since entry 9.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 198 completed successfully
Mon Nov 10 06:47:44 PM CET 2025: Completed iteration 198

=== Iteration 199/300 ===
Mon Nov 10 06:47:44 PM CET 2025: Starting company car negotiation iteration 199 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬27,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 199 completed successfully
Mon Nov 10 06:48:16 PM CET 2025: Completed iteration 199

=== Iteration 200/300 ===
Mon Nov 10 06:48:16 PM CET 2025: Starting company car negotiation iteration 200 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.65s (total since entry 5.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.58s (total since entry 9.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 75.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 200 completed successfully
Mon Nov 10 06:48:54 PM CET 2025: Completed iteration 200

=== Iteration 201/300 ===
Mon Nov 10 06:48:54 PM CET 2025: Starting company car negotiation iteration 201 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38165}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38165}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38165}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38165}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38165}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38165.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,165 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 201 completed successfully
Mon Nov 10 06:49:28 PM CET 2025: Completed iteration 201

=== Iteration 202/300 ===
Mon Nov 10 06:49:28 PM CET 2025: Starting company car negotiation iteration 202 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.91s (total since entry 9.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 202 completed successfully
Mon Nov 10 06:50:06 PM CET 2025: Completed iteration 202

=== Iteration 203/300 ===
Mon Nov 10 06:50:06 PM CET 2025: Starting company car negotiation iteration 203 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.93s (total since entry 9.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 994.80 (saved â‚¬994.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 887.87 (profit â‚¬887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39589.60, seller=37600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=994.80, model_a surplus=887.87
âœ… Calculated utility_surplus: {'model_a': 887.8745256249967, 'model_b': 994.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39589.59715125, 'model_a': 37600.0}
Metrics: {'utility_surplus': {'model_a': 887.8745256249967, 'model_b': 994.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 203 completed successfully
Mon Nov 10 06:50:41 PM CET 2025: Completed iteration 203

=== Iteration 204/300 ===
Mon Nov 10 06:50:41 PM CET 2025: Starting company car negotiation iteration 204 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.91s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (0/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38501}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38501}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38501}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38501}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38501}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38501.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,501 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 204 completed successfully
Mon Nov 10 06:51:21 PM CET 2025: Completed iteration 204

=== Iteration 205/300 ===
Mon Nov 10 06:51:21 PM CET 2025: Starting company car negotiation iteration 205 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 205 completed successfully
Mon Nov 10 06:52:01 PM CET 2025: Completed iteration 205

=== Iteration 206/300 ===
Mon Nov 10 06:52:01 PM CET 2025: Starting company car negotiation iteration 206 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 206 completed successfully
Mon Nov 10 06:52:42 PM CET 2025: Completed iteration 206

=== Iteration 207/300 ===
Mon Nov 10 06:52:42 PM CET 2025: Starting company car negotiation iteration 207 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬41,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=41500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1720.78 (saved â‚¬-1720.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3661.22 (profit â‚¬3661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38058.45, seller=41500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1720.78, model_b surplus=3661.22
âœ… Calculated utility_surplus: {'model_a': -1720.7750000000015, 'model_b': 3661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 38058.45, 'model_b': 41500.0}
Metrics: {'utility_surplus': {'model_a': -1720.7750000000015, 'model_b': 3661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 207 completed successfully
Mon Nov 10 06:53:15 PM CET 2025: Completed iteration 207

=== Iteration 208/300 ===
Mon Nov 10 06:53:15 PM CET 2025: Starting company car negotiation iteration 208 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.61s (total since entry 5.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 208 completed successfully
Mon Nov 10 06:53:38 PM CET 2025: Completed iteration 208

=== Iteration 209/300 ===
Mon Nov 10 06:53:38 PM CET 2025: Starting company car negotiation iteration 209 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 209 completed successfully
Mon Nov 10 06:54:00 PM CET 2025: Completed iteration 209

=== Iteration 210/300 ===
Mon Nov 10 06:54:00 PM CET 2025: Starting company car negotiation iteration 210 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.64s (total since entry 5.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37620}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37620}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37620}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37620}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37620}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37620.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,620 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 210 completed successfully
Mon Nov 10 06:54:36 PM CET 2025: Completed iteration 210

=== Iteration 211/300 ===
Mon Nov 10 06:54:36 PM CET 2025: Starting company car negotiation iteration 211 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.89s (total since entry 9.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3385.00 (saved â‚¬3385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1415.00 (profit â‚¬-1415.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43770.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3385.00, model_a surplus=-1415.00
âœ… Calculated utility_surplus: {'model_a': -1415.0, 'model_b': 3385.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 43770.0, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': -1415.0, 'model_b': 3385.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 211 completed successfully
Mon Nov 10 06:55:01 PM CET 2025: Completed iteration 211

=== Iteration 212/300 ===
Mon Nov 10 06:55:01 PM CET 2025: Starting company car negotiation iteration 212 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.90s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 212 completed successfully
Mon Nov 10 06:55:32 PM CET 2025: Completed iteration 212

=== Iteration 213/300 ===
Mon Nov 10 06:55:32 PM CET 2025: Starting company car negotiation iteration 213 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1500.00, model_a surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42500.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 213 completed successfully
Mon Nov 10 06:55:54 PM CET 2025: Completed iteration 213

=== Iteration 214/300 ===
Mon Nov 10 06:55:54 PM CET 2025: Starting company car negotiation iteration 214 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 214 completed successfully
Mon Nov 10 06:56:23 PM CET 2025: Completed iteration 214

=== Iteration 215/300 ===
Mon Nov 10 06:56:23 PM CET 2025: Starting company car negotiation iteration 215 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38199}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38199}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38199}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38199}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38199}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38199.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,199 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 215 completed successfully
Mon Nov 10 06:57:08 PM CET 2025: Completed iteration 215

=== Iteration 216/300 ===
Mon Nov 10 06:57:08 PM CET 2025: Starting company car negotiation iteration 216 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1179.22, model_a surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40958.45, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 216 completed successfully
Mon Nov 10 06:57:36 PM CET 2025: Completed iteration 216

=== Iteration 217/300 ===
Mon Nov 10 06:57:36 PM CET 2025: Starting company car negotiation iteration 217 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39183}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39183}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39183}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39183}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39183}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39183.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,183 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 217 completed successfully
Mon Nov 10 06:58:09 PM CET 2025: Completed iteration 217

=== Iteration 218/300 ===
Mon Nov 10 06:58:09 PM CET 2025: Starting company car negotiation iteration 218 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 5.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1394.80 (saved â‚¬1394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 487.87 (profit â‚¬487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39989.60, seller=37200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1394.80, model_a surplus=487.87
âœ… Calculated utility_surplus: {'model_a': 487.87452562499675, 'model_b': 1394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39989.59715125, 'model_a': 37200.0}
Metrics: {'utility_surplus': {'model_a': 487.87452562499675, 'model_b': 1394.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 218 completed successfully
Mon Nov 10 06:58:45 PM CET 2025: Completed iteration 218

=== Iteration 219/300 ===
Mon Nov 10 06:58:45 PM CET 2025: Starting company car negotiation iteration 219 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1000.00, model_b surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': -1000.0, 'model_b': 3000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 40000.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1000.0, 'model_b': 3000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 219 completed successfully
Mon Nov 10 06:59:11 PM CET 2025: Completed iteration 219

=== Iteration 220/300 ===
Mon Nov 10 06:59:11 PM CET 2025: Starting company car negotiation iteration 220 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26700.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬26,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38415\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38415\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38415\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 220 completed successfully
Mon Nov 10 06:59:36 PM CET 2025: Completed iteration 220

=== Iteration 221/300 ===
Mon Nov 10 06:59:36 PM CET 2025: Starting company car negotiation iteration 221 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37695}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37695}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37695}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37695}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37695}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37695.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 221 completed successfully
Mon Nov 10 07:00:16 PM CET 2025: Completed iteration 221

=== Iteration 222/300 ===
Mon Nov 10 07:00:16 PM CET 2025: Starting company car negotiation iteration 222 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 5.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬26,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,700 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,700 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 685.00 (saved â‚¬685.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1285.00 (profit â‚¬1285.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41070.00, seller=39700.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=685.00, model_b surplus=1285.00
âœ… Calculated utility_surplus: {'model_a': 685.0, 'model_b': 1285.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41070.0, 'model_b': 39700.0}
Metrics: {'utility_surplus': {'model_a': 685.0, 'model_b': 1285.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 222 completed successfully
Mon Nov 10 07:00:41 PM CET 2025: Completed iteration 222

=== Iteration 223/300 ===
Mon Nov 10 07:00:41 PM CET 2025: Starting company car negotiation iteration 223 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,650 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1129.22 (saved â‚¬1129.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 811.22 (profit â‚¬811.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40908.45, seller=38650.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1129.22, model_b surplus=811.22
âœ… Calculated utility_surplus: {'model_a': 1129.2249999999985, 'model_b': 811.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40908.45, 'model_b': 38650.0}
Metrics: {'utility_surplus': {'model_a': 1129.2249999999985, 'model_b': 811.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 223 completed successfully
Mon Nov 10 07:01:09 PM CET 2025: Completed iteration 223

=== Iteration 224/300 ===
Mon Nov 10 07:01:09 PM CET 2025: Starting company car negotiation iteration 224 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39670}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39670}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39670}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39670}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39670}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39670.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,670 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 224 completed successfully
Mon Nov 10 07:01:49 PM CET 2025: Completed iteration 224

=== Iteration 225/300 ===
Mon Nov 10 07:01:49 PM CET 2025: Starting company car negotiation iteration 225 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬36,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_b rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 225 completed successfully
Mon Nov 10 07:02:30 PM CET 2025: Completed iteration 225

=== Iteration 226/300 ===
Mon Nov 10 07:02:30 PM CET 2025: Starting company car negotiation iteration 226 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.00s (total since entry 9.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-220.78, model_b surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39558.45, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 226 completed successfully
Mon Nov 10 07:02:56 PM CET 2025: Completed iteration 226

=== Iteration 227/300 ===
Mon Nov 10 07:02:56 PM CET 2025: Starting company car negotiation iteration 227 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.47s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 227 completed successfully
Mon Nov 10 07:03:38 PM CET 2025: Completed iteration 227

=== Iteration 228/300 ===
Mon Nov 10 07:03:38 PM CET 2025: Starting company car negotiation iteration 228 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 228 completed successfully
Mon Nov 10 07:04:14 PM CET 2025: Completed iteration 228

=== Iteration 229/300 ===
Mon Nov 10 07:04:14 PM CET 2025: Starting company car negotiation iteration 229 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.55s (total since entry 5.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 229 completed successfully
Mon Nov 10 07:04:39 PM CET 2025: Completed iteration 229

=== Iteration 230/300 ===
Mon Nov 10 07:04:39 PM CET 2025: Starting company car negotiation iteration 230 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1179.22, model_b surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40958.45, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1179.2249999999985, 'model_b': 761.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 230 completed successfully
Mon Nov 10 07:05:05 PM CET 2025: Completed iteration 230

=== Iteration 231/300 ===
Mon Nov 10 07:05:05 PM CET 2025: Starting company car negotiation iteration 231 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.98s (total since entry 9.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 231 completed successfully
Mon Nov 10 07:05:28 PM CET 2025: Completed iteration 231

=== Iteration 232/300 ===
Mon Nov 10 07:05:28 PM CET 2025: Starting company car negotiation iteration 232 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.46s (total since entry 4.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39165}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39165}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39165}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39165}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39165}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39165.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,165 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 232 completed successfully
Mon Nov 10 07:06:11 PM CET 2025: Completed iteration 232

=== Iteration 233/300 ===
Mon Nov 10 07:06:11 PM CET 2025: Starting company car negotiation iteration 233 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38160}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38160}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38160}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38160}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38160}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38160.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,160 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_b rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 233 completed successfully
Mon Nov 10 07:06:53 PM CET 2025: Completed iteration 233

=== Iteration 234/300 ===
Mon Nov 10 07:06:53 PM CET 2025: Starting company car negotiation iteration 234 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 5.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-220.78, model_b surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39558.45, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 234 completed successfully
Mon Nov 10 07:07:19 PM CET 2025: Completed iteration 234

=== Iteration 235/300 ===
Mon Nov 10 07:07:19 PM CET 2025: Starting company car negotiation iteration 235 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬27,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1779.22 (saved â‚¬1779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 161.22 (profit â‚¬161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41558.45, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1779.22, model_a surplus=161.22
âœ… Calculated utility_surplus: {'model_a': 161.22499999999854, 'model_b': 1779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41558.45, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 161.22499999999854, 'model_b': 1779.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 235 completed successfully
Mon Nov 10 07:07:47 PM CET 2025: Completed iteration 235

=== Iteration 236/300 ===
Mon Nov 10 07:07:47 PM CET 2025: Starting company car negotiation iteration 236 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 236 completed successfully
Mon Nov 10 07:08:19 PM CET 2025: Completed iteration 236

=== Iteration 237/300 ===
Mon Nov 10 07:08:19 PM CET 2025: Starting company car negotiation iteration 237 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,700 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1079.22 (saved â‚¬1079.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 861.22 (profit â‚¬861.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40858.45, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1079.22, model_a surplus=861.22
âœ… Calculated utility_surplus: {'model_a': 861.2249999999985, 'model_b': 1079.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40858.45, 'model_a': 38700.0}
Metrics: {'utility_surplus': {'model_a': 861.2249999999985, 'model_b': 1079.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 237 completed successfully
Mon Nov 10 07:08:46 PM CET 2025: Completed iteration 237

=== Iteration 238/300 ===
Mon Nov 10 07:08:46 PM CET 2025: Starting company car negotiation iteration 238 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 238 completed successfully
Mon Nov 10 07:09:15 PM CET 2025: Completed iteration 238

=== Iteration 239/300 ===
Mon Nov 10 07:09:15 PM CET 2025: Starting company car negotiation iteration 239 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37615}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37615}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37615}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37615}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37615}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37615.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬37,615 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37614}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37614}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37614}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37614}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37614}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37614.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,614 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 239 completed successfully
Mon Nov 10 07:09:45 PM CET 2025: Completed iteration 239

=== Iteration 240/300 ===
Mon Nov 10 07:09:45 PM CET 2025: Starting company car negotiation iteration 240 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ’¡ Player model_b made offer â‚¬39,700 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬26,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 240 completed successfully
Mon Nov 10 07:10:09 PM CET 2025: Completed iteration 240

=== Iteration 241/300 ===
Mon Nov 10 07:10:09 PM CET 2025: Starting company car negotiation iteration 241 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.68s (total since entry 5.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 241 completed successfully
Mon Nov 10 07:10:48 PM CET 2025: Completed iteration 241

=== Iteration 242/300 ===
Mon Nov 10 07:10:48 PM CET 2025: Starting company car negotiation iteration 242 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,100 (made in round 2)
ğŸ” [BATNA DEBUG] Round 5: price=39100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -505.20 (saved â‚¬-505.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2387.87 (profit â‚¬2387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38089.60, seller=39100.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-505.20, model_a surplus=2387.87
âœ… Calculated utility_surplus: {'model_a': 2387.8745256249967, 'model_b': -505.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38089.59715125, 'model_a': 39100.0}
Metrics: {'utility_surplus': {'model_a': 2387.8745256249967, 'model_b': -505.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 242 completed successfully
Mon Nov 10 07:11:24 PM CET 2025: Completed iteration 242

=== Iteration 243/300 ===
Mon Nov 10 07:11:24 PM CET 2025: Starting company car negotiation iteration 243 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 243 completed successfully
Mon Nov 10 07:11:59 PM CET 2025: Completed iteration 243

=== Iteration 244/300 ===
Mon Nov 10 07:11:59 PM CET 2025: Starting company car negotiation iteration 244 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬41,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=41000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 0.00 (saved â‚¬0.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2000.00 (profit â‚¬2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41000.00, seller=41000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=0.00, model_a surplus=2000.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 41000.0, 'model_a': 41000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 244 completed successfully
Mon Nov 10 07:12:22 PM CET 2025: Completed iteration 244

=== Iteration 245/300 ===
Mon Nov 10 07:12:22 PM CET 2025: Starting company car negotiation iteration 245 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬36,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3779.22 (saved â‚¬3779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1838.78 (profit â‚¬-1838.78 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43558.45, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3779.22, model_a surplus=-1838.78
âœ… Calculated utility_surplus: {'model_a': -1838.7750000000015, 'model_b': 3779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 43558.45, 'model_a': 36000.0}
Metrics: {'utility_surplus': {'model_a': -1838.7750000000015, 'model_b': 3779.2249999999985}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 245 completed successfully
Mon Nov 10 07:12:50 PM CET 2025: Completed iteration 245

=== Iteration 246/300 ===
Mon Nov 10 07:12:50 PM CET 2025: Starting company car negotiation iteration 246 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38416}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38416}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38416}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38416}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38416}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38416.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38769}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38769}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38769}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38769}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38769}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38769.0}
ğŸ’¡ Player model_a made offer â‚¬38,416 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,769 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 246 completed successfully
Mon Nov 10 07:13:23 PM CET 2025: Completed iteration 246

=== Iteration 247/300 ===
Mon Nov 10 07:13:23 PM CET 2025: Starting company car negotiation iteration 247 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 247 completed successfully
Mon Nov 10 07:13:53 PM CET 2025: Completed iteration 247

=== Iteration 248/300 ===
Mon Nov 10 07:13:53 PM CET 2025: Starting company car negotiation iteration 248 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=982.54, model_a surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40165.07324999999, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 928.8066250000047, 'model_b': 982.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 248 completed successfully
Mon Nov 10 07:14:26 PM CET 2025: Completed iteration 248

=== Iteration 249/300 ===
Mon Nov 10 07:14:26 PM CET 2025: Starting company car negotiation iteration 249 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬36,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -817.46 (saved â‚¬-817.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2728.81 (profit â‚¬2728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38365.07, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-817.46, model_b surplus=2728.81
âœ… Calculated utility_surplus: {'model_a': -817.4633750000066, 'model_b': 2728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 38365.07324999999, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -817.4633750000066, 'model_b': 2728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 249 completed successfully
Mon Nov 10 07:14:59 PM CET 2025: Completed iteration 249

=== Iteration 250/300 ===
Mon Nov 10 07:14:59 PM CET 2025: Starting company car negotiation iteration 250 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.58s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 250 completed successfully
Mon Nov 10 07:15:36 PM CET 2025: Completed iteration 250

=== Iteration 251/300 ===
Mon Nov 10 07:15:36 PM CET 2025: Starting company car negotiation iteration 251 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,385 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 251 completed successfully
Mon Nov 10 07:16:10 PM CET 2025: Completed iteration 251

=== Iteration 252/300 ===
Mon Nov 10 07:16:10 PM CET 2025: Starting company car negotiation iteration 252 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.60s (total since entry 5.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬26,700 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -155.20 (saved â‚¬-155.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2037.87 (profit â‚¬2037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38439.60, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-155.20, model_a surplus=2037.87
âœ… Calculated utility_surplus: {'model_a': 2037.8745256249967, 'model_b': -155.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38439.59715125, 'model_a': 38750.0}
Metrics: {'utility_surplus': {'model_a': 2037.8745256249967, 'model_b': -155.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 252 completed successfully
Mon Nov 10 07:16:49 PM CET 2025: Completed iteration 252

=== Iteration 253/300 ===
Mon Nov 10 07:16:49 PM CET 2025: Starting company car negotiation iteration 253 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.75s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1000.00, model_b surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': -1000.0, 'model_b': 3000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 40000.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1000.0, 'model_b': 3000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 253 completed successfully
Mon Nov 10 07:17:14 PM CET 2025: Completed iteration 253

=== Iteration 254/300 ===
Mon Nov 10 07:17:14 PM CET 2025: Starting company car negotiation iteration 254 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.72s (total since entry 9.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (1/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,700 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -105.20 (saved â‚¬-105.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1987.87 (profit â‚¬1987.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38489.60, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-105.20, model_a surplus=1987.87
âœ… Calculated utility_surplus: {'model_a': 1987.8745256249967, 'model_b': -105.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38489.59715125, 'model_a': 38700.0}
Metrics: {'utility_surplus': {'model_a': 1987.8745256249967, 'model_b': -105.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 254 completed successfully
Mon Nov 10 07:17:52 PM CET 2025: Completed iteration 254

=== Iteration 255/300 ===
Mon Nov 10 07:17:52 PM CET 2025: Starting company car negotiation iteration 255 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39167}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39167}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39167}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39167}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39167}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39167.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,167 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 255 completed successfully
Mon Nov 10 07:18:27 PM CET 2025: Completed iteration 255

=== Iteration 256/300 ===
Mon Nov 10 07:18:27 PM CET 2025: Starting company car negotiation iteration 256 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.88s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 256 completed successfully
Mon Nov 10 07:19:09 PM CET 2025: Completed iteration 256

=== Iteration 257/300 ===
Mon Nov 10 07:19:09 PM CET 2025: Starting company car negotiation iteration 257 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 257 completed successfully
Mon Nov 10 07:19:48 PM CET 2025: Completed iteration 257

=== Iteration 258/300 ===
Mon Nov 10 07:19:48 PM CET 2025: Starting company car negotiation iteration 258 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.87s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 258 completed successfully
Mon Nov 10 07:20:25 PM CET 2025: Completed iteration 258

=== Iteration 259/300 ===
Mon Nov 10 07:20:25 PM CET 2025: Starting company car negotiation iteration 259 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36400.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬37,250 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1344.80 (saved â‚¬1344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 537.87 (profit â‚¬537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39939.60, seller=37250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1344.80, model_a surplus=537.87
âœ… Calculated utility_surplus: {'model_a': 537.8745256249967, 'model_b': 1344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39939.59715125, 'model_a': 37250.0}
Metrics: {'utility_surplus': {'model_a': 537.8745256249967, 'model_b': 1344.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 259 completed successfully
Mon Nov 10 07:21:01 PM CET 2025: Completed iteration 259

=== Iteration 260/300 ===
Mon Nov 10 07:21:01 PM CET 2025: Starting company car negotiation iteration 260 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.65s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 260 completed successfully
Mon Nov 10 07:21:30 PM CET 2025: Completed iteration 260

=== Iteration 261/300 ===
Mon Nov 10 07:21:30 PM CET 2025: Starting company car negotiation iteration 261 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39125}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39125}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39125}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39125}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39125}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39125.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,125 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38645}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38645}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38645}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38645}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38645}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38645.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,645 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 261 completed successfully
Mon Nov 10 07:22:11 PM CET 2025: Completed iteration 261

=== Iteration 262/300 ===
Mon Nov 10 07:22:11 PM CET 2025: Starting company car negotiation iteration 262 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,700 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -105.20 (saved â‚¬-105.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1987.87 (profit â‚¬1987.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38489.60, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-105.20, model_b surplus=1987.87
âœ… Calculated utility_surplus: {'model_a': -105.2014243750018, 'model_b': 1987.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38489.59715125, 'model_b': 38700.0}
Metrics: {'utility_surplus': {'model_a': -105.2014243750018, 'model_b': 1987.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 262 completed successfully
Mon Nov 10 07:22:50 PM CET 2025: Completed iteration 262

=== Iteration 263/300 ===
Mon Nov 10 07:22:50 PM CET 2025: Starting company car negotiation iteration 263 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 263 completed successfully
Mon Nov 10 07:23:21 PM CET 2025: Completed iteration 263

=== Iteration 264/300 ===
Mon Nov 10 07:23:21 PM CET 2025: Starting company car negotiation iteration 264 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2885.00 (saved â‚¬2885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -915.00 (profit â‚¬-915.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43270.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2885.00, model_b surplus=-915.00
âœ… Calculated utility_surplus: {'model_a': 2885.0, 'model_b': -915.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 43270.0, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 2885.0, 'model_b': -915.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 264 completed successfully
Mon Nov 10 07:23:48 PM CET 2025: Completed iteration 264

=== Iteration 265/300 ===
Mon Nov 10 07:23:48 PM CET 2025: Starting company car negotiation iteration 265 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 265 completed successfully
Mon Nov 10 07:24:32 PM CET 2025: Completed iteration 265

=== Iteration 266/300 ===
Mon Nov 10 07:24:32 PM CET 2025: Starting company car negotiation iteration 266 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.56s (total since entry 5.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1635.00 (saved â‚¬1635.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 335.00 (profit â‚¬335.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42020.00, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1635.00, model_b surplus=335.00
âœ… Calculated utility_surplus: {'model_a': 1635.0, 'model_b': 335.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42020.0, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 1635.0, 'model_b': 335.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 266 completed successfully
Mon Nov 10 07:24:58 PM CET 2025: Completed iteration 266

=== Iteration 267/300 ===
Mon Nov 10 07:24:58 PM CET 2025: Starting company car negotiation iteration 267 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 267 completed successfully
Mon Nov 10 07:25:22 PM CET 2025: Completed iteration 267

=== Iteration 268/300 ===
Mon Nov 10 07:25:22 PM CET 2025: Starting company car negotiation iteration 268 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 268 completed successfully
Mon Nov 10 07:25:51 PM CET 2025: Completed iteration 268

=== Iteration 269/300 ===
Mon Nov 10 07:25:51 PM CET 2025: Starting company car negotiation iteration 269 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.92s (total since entry 9.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 37750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 37750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,750 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=37750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1432.54 (saved â‚¬1432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 478.81 (profit â‚¬478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40615.07, seller=37750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1432.54, model_a surplus=478.81
âœ… Calculated utility_surplus: {'model_a': 478.8066250000047, 'model_b': 1432.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40615.07324999999, 'model_a': 37750.0}
Metrics: {'utility_surplus': {'model_a': 478.8066250000047, 'model_b': 1432.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 269 completed successfully
Mon Nov 10 07:26:27 PM CET 2025: Completed iteration 269

=== Iteration 270/300 ===
Mon Nov 10 07:26:27 PM CET 2025: Starting company car negotiation iteration 270 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.99s (total since entry 9.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 270 completed successfully
Mon Nov 10 07:27:05 PM CET 2025: Completed iteration 270

=== Iteration 271/300 ===
Mon Nov 10 07:27:05 PM CET 2025: Starting company car negotiation iteration 271 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 271 completed successfully
Mon Nov 10 07:27:40 PM CET 2025: Completed iteration 271

=== Iteration 272/300 ===
Mon Nov 10 07:27:40 PM CET 2025: Starting company car negotiation iteration 272 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2500.00, model_b surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': 2500.0, 'model_b': -500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43500.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 2500.0, 'model_b': -500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 272 completed successfully
Mon Nov 10 07:28:03 PM CET 2025: Completed iteration 272

=== Iteration 273/300 ===
Mon Nov 10 07:28:03 PM CET 2025: Starting company car negotiation iteration 273 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬37,700 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 273 completed successfully
Mon Nov 10 07:28:45 PM CET 2025: Completed iteration 273

=== Iteration 274/300 ===
Mon Nov 10 07:28:45 PM CET 2025: Starting company car negotiation iteration 274 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 274 completed successfully
Mon Nov 10 07:29:10 PM CET 2025: Completed iteration 274

=== Iteration 275/300 ===
Mon Nov 10 07:29:10 PM CET 2025: Starting company car negotiation iteration 275 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬38,800 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 979.22 (saved â‚¬979.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 961.22 (profit â‚¬961.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40758.45, seller=38800.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=979.22, model_b surplus=961.22
âœ… Calculated utility_surplus: {'model_a': 979.2249999999985, 'model_b': 961.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40758.45, 'model_b': 38800.0}
Metrics: {'utility_surplus': {'model_a': 979.2249999999985, 'model_b': 961.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 275 completed successfully
Mon Nov 10 07:29:45 PM CET 2025: Completed iteration 275

=== Iteration 276/300 ===
Mon Nov 10 07:29:45 PM CET 2025: Starting company car negotiation iteration 276 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -317.46 (saved â‚¬-317.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2228.81 (profit â‚¬2228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38865.07, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-317.46, model_b surplus=2228.81
âœ… Calculated utility_surplus: {'model_a': -317.46337500000664, 'model_b': 2228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 38865.07324999999, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': -317.46337500000664, 'model_b': 2228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 276 completed successfully
Mon Nov 10 07:30:19 PM CET 2025: Completed iteration 276

=== Iteration 277/300 ===
Mon Nov 10 07:30:19 PM CET 2025: Starting company car negotiation iteration 277 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.35s (total since entry 4.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 277 completed successfully
Mon Nov 10 07:30:53 PM CET 2025: Completed iteration 277

=== Iteration 278/300 ===
Mon Nov 10 07:30:53 PM CET 2025: Starting company car negotiation iteration 278 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.81s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38525}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38525}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38525}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38525}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38525}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38525.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 278 completed successfully
Mon Nov 10 07:31:33 PM CET 2025: Completed iteration 278

=== Iteration 279/300 ===
Mon Nov 10 07:31:33 PM CET 2025: Starting company car negotiation iteration 279 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.86s (total since entry 9.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39785}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39785}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39785}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39785}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39785}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39785.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬39,785 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 279 completed successfully
Mon Nov 10 07:32:02 PM CET 2025: Completed iteration 279

=== Iteration 280/300 ===
Mon Nov 10 07:32:02 PM CET 2025: Starting company car negotiation iteration 280 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.67s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬36,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 4: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3182.54 (saved â‚¬3182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1271.19 (profit â‚¬-1271.19 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42365.07, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3182.54, model_a surplus=-1271.19
âœ… Calculated utility_surplus: {'model_a': -1271.1933749999953, 'model_b': 3182.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 42365.07324999999, 'model_a': 36000.0}
Metrics: {'utility_surplus': {'model_a': -1271.1933749999953, 'model_b': 3182.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 280 completed successfully
Mon Nov 10 07:32:34 PM CET 2025: Completed iteration 280

=== Iteration 281/300 ===
Mon Nov 10 07:32:34 PM CET 2025: Starting company car negotiation iteration 281 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 281 completed successfully
Mon Nov 10 07:32:55 PM CET 2025: Completed iteration 281

=== Iteration 282/300 ===
Mon Nov 10 07:32:55 PM CET 2025: Starting company car negotiation iteration 282 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.67s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (0/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 282 completed successfully
Mon Nov 10 07:33:39 PM CET 2025: Completed iteration 282

=== Iteration 283/300 ===
Mon Nov 10 07:33:39 PM CET 2025: Starting company car negotiation iteration 283 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2885.00 (saved â‚¬2885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -915.00 (profit â‚¬-915.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43270.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2885.00, model_a surplus=-915.00
âœ… Calculated utility_surplus: {'model_a': -915.0, 'model_b': 2885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 43270.0, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': -915.0, 'model_b': 2885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 283 completed successfully
Mon Nov 10 07:34:03 PM CET 2025: Completed iteration 283

=== Iteration 284/300 ===
Mon Nov 10 07:34:03 PM CET 2025: Starting company car negotiation iteration 284 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.48s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬36,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 4: price=36500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2682.54 (saved â‚¬2682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -771.19 (profit â‚¬-771.19 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41865.07, seller=36500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2682.54, model_a surplus=-771.19
âœ… Calculated utility_surplus: {'model_a': -771.1933749999953, 'model_b': 2682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 41865.07324999999, 'model_a': 36500.0}
Metrics: {'utility_surplus': {'model_a': -771.1933749999953, 'model_b': 2682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 284 completed successfully
Mon Nov 10 07:34:34 PM CET 2025: Completed iteration 284

=== Iteration 285/300 ===
Mon Nov 10 07:34:34 PM CET 2025: Starting company car negotiation iteration 285 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.80s (total since entry 9.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37620}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37620}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37620}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37620}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37620}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37620.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,620 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_b rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 285 completed successfully
Mon Nov 10 07:35:09 PM CET 2025: Completed iteration 285

=== Iteration 286/300 ===
Mon Nov 10 07:35:09 PM CET 2025: Starting company car negotiation iteration 286 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.83s (total since entry 9.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1182.54 (saved â‚¬1182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 728.81 (profit â‚¬728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40365.07, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1182.54, model_a surplus=728.81
âœ… Calculated utility_surplus: {'model_a': 728.8066250000047, 'model_b': 1182.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40365.07324999999, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 728.8066250000047, 'model_b': 1182.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 286 completed successfully
Mon Nov 10 07:35:45 PM CET 2025: Completed iteration 286

=== Iteration 287/300 ===
Mon Nov 10 07:35:45 PM CET 2025: Starting company car negotiation iteration 287 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_b] Raw LLM response: ''
âŒ [DEBUG] [model_b] Could not parse action from response: 
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_a tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬40,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1405.20 (saved â‚¬-1405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3287.87 (profit â‚¬3287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37189.60, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1405.20, model_b surplus=3287.87
âœ… Calculated utility_surplus: {'model_a': -1405.2014243750018, 'model_b': 3287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 37189.59715125, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -1405.2014243750018, 'model_b': 3287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 287 completed successfully
Mon Nov 10 07:36:22 PM CET 2025: Completed iteration 287

=== Iteration 288/300 ===
Mon Nov 10 07:36:22 PM CET 2025: Starting company car negotiation iteration 288 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 288 completed successfully
Mon Nov 10 07:36:51 PM CET 2025: Completed iteration 288

=== Iteration 289/300 ===
Mon Nov 10 07:36:51 PM CET 2025: Starting company car negotiation iteration 289 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.79s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬26,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 289 completed successfully
Mon Nov 10 07:37:21 PM CET 2025: Completed iteration 289

=== Iteration 290/300 ===
Mon Nov 10 07:37:21 PM CET 2025: Starting company car negotiation iteration 290 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.41s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,415 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38415
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1364.22 (saved â‚¬1364.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 576.22 (profit â‚¬576.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41143.45, seller=38415.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1364.22, model_b surplus=576.22
âœ… Calculated utility_surplus: {'model_a': 1364.2249999999985, 'model_b': 576.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41143.45, 'model_b': 38415.0}
Metrics: {'utility_surplus': {'model_a': 1364.2249999999985, 'model_b': 576.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 290 completed successfully
Mon Nov 10 07:37:48 PM CET 2025: Completed iteration 290

=== Iteration 291/300 ===
Mon Nov 10 07:37:48 PM CET 2025: Starting company car negotiation iteration 291 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.78s (total since entry 9.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 291 completed successfully
Mon Nov 10 07:38:17 PM CET 2025: Completed iteration 291

=== Iteration 292/300 ===
Mon Nov 10 07:38:17 PM CET 2025: Starting company car negotiation iteration 292 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 27600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 27600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 27600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 27600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬27,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 292 completed successfully
Mon Nov 10 07:38:49 PM CET 2025: Completed iteration 292

=== Iteration 293/300 ===
Mon Nov 10 07:38:49 PM CET 2025: Starting company car negotiation iteration 293 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
âœ… Player model_a accepted offer of â‚¬39,200 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1800.00 (saved â‚¬1800.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 200.00 (profit â‚¬200.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42800.00, seller=39200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1800.00, model_b surplus=200.00
âœ… Calculated utility_surplus: {'model_a': 1800.0, 'model_b': 200.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42800.0, 'model_b': 39200.0}
Metrics: {'utility_surplus': {'model_a': 1800.0, 'model_b': 200.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 293 completed successfully
Mon Nov 10 07:39:12 PM CET 2025: Completed iteration 293

=== Iteration 294/300 ===
Mon Nov 10 07:39:12 PM CET 2025: Starting company car negotiation iteration 294 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-1615.00, model_b surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': -1615.0, 'model_b': 3585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 38770.0, 'model_b': 42000.0}
Metrics: {'utility_surplus': {'model_a': -1615.0, 'model_b': 3585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 294 completed successfully
Mon Nov 10 07:39:37 PM CET 2025: Completed iteration 294

=== Iteration 295/300 ===
Mon Nov 10 07:39:37 PM CET 2025: Starting company car negotiation iteration 295 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.40s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 25000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 25000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 25000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 25000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 25000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 25000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬25,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_b rejected but still has proposals remaining (2/4). Continuing negotiation.
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 295 completed successfully
Mon Nov 10 07:40:16 PM CET 2025: Completed iteration 295

=== Iteration 296/300 ===
Mon Nov 10 07:40:16 PM CET 2025: Starting company car negotiation iteration 296 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.45s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.76s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2885.00 (saved â‚¬2885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -915.00 (profit â‚¬-915.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43270.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2885.00, model_b surplus=-915.00
âœ… Calculated utility_surplus: {'model_a': 2885.0, 'model_b': -915.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 43270.0, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 2885.0, 'model_b': -915.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 296 completed successfully
Mon Nov 10 07:40:47 PM CET 2025: Completed iteration 296

=== Iteration 297/300 ===
Mon Nov 10 07:40:47 PM CET 2025: Starting company car negotiation iteration 297 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.57s (total since entry 5.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39700.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 297 completed successfully
Mon Nov 10 07:41:22 PM CET 2025: Completed iteration 297

=== Iteration 298/300 ===
Mon Nov 10 07:41:22 PM CET 2025: Starting company car negotiation iteration 298 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.93s (total since entry 9.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 298 completed successfully
Mon Nov 10 07:41:50 PM CET 2025: Completed iteration 298

=== Iteration 299/300 ===
Mon Nov 10 07:41:50 PM CET 2025: Starting company car negotiation iteration 299 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.38s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 26700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 26700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 26700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 26700.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬26,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_a tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-7B beat Qwen/Qwen2.5-3B (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 299 completed successfully
Mon Nov 10 07:42:27 PM CET 2025: Completed iteration 299

=== Iteration 300/300 ===
Mon Nov 10 07:42:27 PM CET 2025: Starting company car negotiation iteration 300 on node jn117
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_a (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-7B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-7B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': True, 'load_in_8bit': False}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.37s (total since entry 4.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 7055
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-7B)
Loading Qwen/Qwen2.5-7B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-7B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-7B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.84s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 21303
âœ… Qwen/Qwen2.5-7B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat Qwen/Qwen2.5-7B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Qwen2.5-3B, model_b=Qwen2.5-7B
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: Qwen/Qwen2.5-3B)
ğŸ—‘ï¸  Qwen/Qwen2.5-7B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-7B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 300 completed successfully
Mon Nov 10 07:42:59 PM CET 2025: Completed iteration 300

=== Company Car Game Batch Complete ===
Successful iterations: 300/300
âœ… ALL ITERATIONS SUCCESSFUL: Platform working perfectly on node jn117
=== Company Car Run Complete ===
