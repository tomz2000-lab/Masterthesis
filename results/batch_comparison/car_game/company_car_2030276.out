=== Company Car Game - 10 Iterations ===
Job ID: 2030276, Node: jn119
=== Environment Check ===
CUDA: True, GPU: NVIDIA L40
NVIDIA L40, 49140 MiB, 1 MiB
=== Verifying Torch Scope Fix ===
âœ… Torch scope fix is present
=== Running Company Car Game - 10 Iterations ===
Game: Employee vs Manager company car negotiation

=== Iteration 1/300 ===
Sun Nov 16 02:49:52 PM CET 2025: Starting company car negotiation iteration 1 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 20.15s (total since entry 21.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.45s (total since entry 9.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 1 completed successfully
Sun Nov 16 02:50:47 PM CET 2025: Completed iteration 1

=== Iteration 2/300 ===
Sun Nov 16 02:50:47 PM CET 2025: Starting company car negotiation iteration 2 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.90s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.07s (total since entry 6.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 2 completed successfully
Sun Nov 16 02:51:32 PM CET 2025: Completed iteration 2

=== Iteration 3/300 ===
Sun Nov 16 02:51:32 PM CET 2025: Starting company car negotiation iteration 3 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.81s (total since entry 14.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 3 completed successfully
Sun Nov 16 02:52:20 PM CET 2025: Completed iteration 3

=== Iteration 4/300 ===
Sun Nov 16 02:52:20 PM CET 2025: Starting company car negotiation iteration 4 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.95s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2182.54 (saved â‚¬2182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -271.19 (profit â‚¬-271.19 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41365.07, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2182.54, model_a surplus=-271.19
âœ… Calculated utility_surplus: {'model_a': -271.1933749999953, 'model_b': 2182.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 41365.07324999999, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': -271.1933749999953, 'model_b': 2182.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 4 completed successfully
Sun Nov 16 02:53:01 PM CET 2025: Completed iteration 4

=== Iteration 5/300 ===
Sun Nov 16 02:53:01 PM CET 2025: Starting company car negotiation iteration 5 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.00s (total since entry 15.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.81s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=794.80, model_b surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39389.59715125, 'model_b': 37800.0}
Metrics: {'utility_surplus': {'model_a': 794.7985756249982, 'model_b': 1087.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 5 completed successfully
Sun Nov 16 02:53:40 PM CET 2025: Completed iteration 5

=== Iteration 6/300 ===
Sun Nov 16 02:53:40 PM CET 2025: Starting company car negotiation iteration 6 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 6 completed successfully
Sun Nov 16 02:54:32 PM CET 2025: Completed iteration 6

=== Iteration 7/300 ===
Sun Nov 16 02:54:32 PM CET 2025: Starting company car negotiation iteration 7 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 37750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 37750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 7 completed successfully
Sun Nov 16 02:55:15 PM CET 2025: Completed iteration 7

=== Iteration 8/300 ===
Sun Nov 16 02:55:15 PM CET 2025: Starting company car negotiation iteration 8 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ’¡ Player model_b made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37271}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37271}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37271}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37271}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37271}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37271.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,271 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36850.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36700.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 25.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 25.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 8 completed successfully
Sun Nov 16 02:56:04 PM CET 2025: Completed iteration 8

=== Iteration 9/300 ===
Sun Nov 16 02:56:04 PM CET 2025: Starting company car negotiation iteration 9 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 9 completed successfully
Sun Nov 16 02:56:50 PM CET 2025: Completed iteration 9

=== Iteration 10/300 ===
Sun Nov 16 02:56:50 PM CET 2025: Starting company car negotiation iteration 10 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.83s (total since entry 6.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 10 completed successfully
Sun Nov 16 02:57:35 PM CET 2025: Completed iteration 10

=== Iteration 11/300 ===
Sun Nov 16 02:57:35 PM CET 2025: Starting company car negotiation iteration 11 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.96s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,450 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1329.22 (saved â‚¬1329.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 611.22 (profit â‚¬611.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41108.45, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1329.22, model_a surplus=611.22
âœ… Calculated utility_surplus: {'model_a': 611.2249999999985, 'model_b': 1329.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41108.45, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 611.2249999999985, 'model_b': 1329.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 11 completed successfully
Sun Nov 16 02:58:08 PM CET 2025: Completed iteration 11

=== Iteration 12/300 ===
Sun Nov 16 02:58:08 PM CET 2025: Starting company car negotiation iteration 12 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.06s (total since entry 15.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 12 completed successfully
Sun Nov 16 02:58:52 PM CET 2025: Completed iteration 12

=== Iteration 13/300 ===
Sun Nov 16 02:58:52 PM CET 2025: Starting company car negotiation iteration 13 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.86s (total since entry 14.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.45s (total since entry 6.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 25.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 25.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 13 completed successfully
Sun Nov 16 02:59:39 PM CET 2025: Completed iteration 13

=== Iteration 14/300 ===
Sun Nov 16 02:59:39 PM CET 2025: Starting company car negotiation iteration 14 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.23s (total since entry 14.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.55s (total since entry 6.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37995}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37995}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37995}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37995}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37995}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37995.0}
ğŸ’¡ Player model_a made offer â‚¬37,995 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 14 completed successfully
Sun Nov 16 03:00:23 PM CET 2025: Completed iteration 14

=== Iteration 15/300 ===
Sun Nov 16 03:00:23 PM CET 2025: Starting company car negotiation iteration 15 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.36s (total since entry 14.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.53s (total since entry 6.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,300 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=294.80, model_a surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38889.59715125, 'model_a': 38300.0}
Metrics: {'utility_surplus': {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 15 completed successfully
Sun Nov 16 03:01:12 PM CET 2025: Completed iteration 15

=== Iteration 16/300 ===
Sun Nov 16 03:01:12 PM CET 2025: Starting company car negotiation iteration 16 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.26s (total since entry 14.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.51s (total since entry 6.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,100 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 494.80 (saved â‚¬494.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1387.87 (profit â‚¬1387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39089.60, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=494.80, model_a surplus=1387.87
âœ… Calculated utility_surplus: {'model_a': 1387.8745256249967, 'model_b': 494.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39089.59715125, 'model_a': 38100.0}
Metrics: {'utility_surplus': {'model_a': 1387.8745256249967, 'model_b': 494.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 16 completed successfully
Sun Nov 16 03:01:54 PM CET 2025: Completed iteration 16

=== Iteration 17/300 ===
Sun Nov 16 03:01:54 PM CET 2025: Starting company car negotiation iteration 17 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.13s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 16.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.83s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.49s (total since entry 7.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 17 completed successfully
Sun Nov 16 03:02:45 PM CET 2025: Completed iteration 17

=== Iteration 18/300 ===
Sun Nov 16 03:02:45 PM CET 2025: Starting company car negotiation iteration 18 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.99s (total since entry 14.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 18 completed successfully
Sun Nov 16 03:03:36 PM CET 2025: Completed iteration 18

=== Iteration 19/300 ===
Sun Nov 16 03:03:36 PM CET 2025: Starting company car negotiation iteration 19 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 19 completed successfully
Sun Nov 16 03:04:15 PM CET 2025: Completed iteration 19

=== Iteration 20/300 ===
Sun Nov 16 03:04:15 PM CET 2025: Starting company car negotiation iteration 20 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.82s (total since entry 14.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬37,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1594.80 (saved â‚¬1594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 287.87 (profit â‚¬287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40189.60, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1594.80, model_b surplus=287.87
âœ… Calculated utility_surplus: {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 40189.59715125, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 20 completed successfully
Sun Nov 16 03:04:59 PM CET 2025: Completed iteration 20

=== Iteration 21/300 ===
Sun Nov 16 03:04:59 PM CET 2025: Starting company car negotiation iteration 21 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,150 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38150}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38150}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38150}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 21 completed successfully
Sun Nov 16 03:05:45 PM CET 2025: Completed iteration 21

=== Iteration 22/300 ===
Sun Nov 16 03:05:45 PM CET 2025: Starting company car negotiation iteration 22 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.79s (total since entry 14.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3500.00 (saved â‚¬3500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1500.00 (profit â‚¬-1500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=44500.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3500.00, model_a surplus=-1500.00
âœ… Calculated utility_surplus: {'model_a': -1500.0, 'model_b': 3500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 44500.0, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': -1500.0, 'model_b': 3500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 22 completed successfully
Sun Nov 16 03:06:14 PM CET 2025: Completed iteration 22

=== Iteration 23/300 ===
Sun Nov 16 03:06:14 PM CET 2025: Starting company car negotiation iteration 23 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.85s (total since entry 14.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 23 completed successfully
Sun Nov 16 03:07:00 PM CET 2025: Completed iteration 23

=== Iteration 24/300 ===
Sun Nov 16 03:07:00 PM CET 2025: Starting company car negotiation iteration 24 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.84s (total since entry 14.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.72s (total since entry 6.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 24 completed successfully
Sun Nov 16 03:07:44 PM CET 2025: Completed iteration 24

=== Iteration 25/300 ===
Sun Nov 16 03:07:44 PM CET 2025: Starting company car negotiation iteration 25 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 25 completed successfully
Sun Nov 16 03:08:26 PM CET 2025: Completed iteration 25

=== Iteration 26/300 ===
Sun Nov 16 03:08:26 PM CET 2025: Starting company car negotiation iteration 26 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 7.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 26 completed successfully
Sun Nov 16 03:09:01 PM CET 2025: Completed iteration 26

=== Iteration 27/300 ===
Sun Nov 16 03:09:01 PM CET 2025: Starting company car negotiation iteration 27 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 27 completed successfully
Sun Nov 16 03:09:50 PM CET 2025: Completed iteration 27

=== Iteration 28/300 ===
Sun Nov 16 03:09:50 PM CET 2025: Starting company car negotiation iteration 28 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.96s (total since entry 14.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 28 completed successfully
Sun Nov 16 03:10:39 PM CET 2025: Completed iteration 28

=== Iteration 29/300 ===
Sun Nov 16 03:10:39 PM CET 2025: Starting company car negotiation iteration 29 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38480}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38480}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38480}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 29 completed successfully
Sun Nov 16 03:11:26 PM CET 2025: Completed iteration 29

=== Iteration 30/300 ===
Sun Nov 16 03:11:26 PM CET 2025: Starting company car negotiation iteration 30 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.83s (total since entry 6.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,450 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 732.54 (saved â‚¬732.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1178.81 (profit â‚¬1178.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39915.07, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=732.54, model_b surplus=1178.81
âœ… Calculated utility_surplus: {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 33.33333333333333}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39915.07324999999, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 33.33333333333333}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 30 completed successfully
Sun Nov 16 03:12:05 PM CET 2025: Completed iteration 30

=== Iteration 31/300 ===
Sun Nov 16 03:12:05 PM CET 2025: Starting company car negotiation iteration 31 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.86s (total since entry 14.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.72s (total since entry 6.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 31 completed successfully
Sun Nov 16 03:12:45 PM CET 2025: Completed iteration 31

=== Iteration 32/300 ===
Sun Nov 16 03:12:45 PM CET 2025: Starting company car negotiation iteration 32 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.75s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 32 completed successfully
Sun Nov 16 03:13:29 PM CET 2025: Completed iteration 32

=== Iteration 33/300 ===
Sun Nov 16 03:13:29 PM CET 2025: Starting company car negotiation iteration 33 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.00s (total since entry 14.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 33 completed successfully
Sun Nov 16 03:14:14 PM CET 2025: Completed iteration 33

=== Iteration 34/300 ===
Sun Nov 16 03:14:14 PM CET 2025: Starting company car negotiation iteration 34 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.28s (total since entry 14.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.51s (total since entry 6.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 34 completed successfully
Sun Nov 16 03:14:56 PM CET 2025: Completed iteration 34

=== Iteration 35/300 ===
Sun Nov 16 03:14:56 PM CET 2025: Starting company car negotiation iteration 35 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.27s (total since entry 14.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.49s (total since entry 6.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,400 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=782.54, model_a surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 1128.8066250000047, 'model_b': 782.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39965.07324999999, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1128.8066250000047, 'model_b': 782.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 35 completed successfully
Sun Nov 16 03:15:36 PM CET 2025: Completed iteration 35

=== Iteration 36/300 ===
Sun Nov 16 03:15:36 PM CET 2025: Starting company car negotiation iteration 36 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.25s (total since entry 14.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.53s (total since entry 6.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,490 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38490
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 104.80 (saved â‚¬104.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1777.87 (profit â‚¬1777.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38699.60, seller=38490.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=104.80, model_b surplus=1777.87
âœ… Calculated utility_surplus: {'model_a': 104.7985756249982, 'model_b': 1777.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38699.59715125, 'model_b': 38490.0}
Metrics: {'utility_surplus': {'model_a': 104.7985756249982, 'model_b': 1777.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 36 completed successfully
Sun Nov 16 03:16:18 PM CET 2025: Completed iteration 36

=== Iteration 37/300 ===
Sun Nov 16 03:16:18 PM CET 2025: Starting company car negotiation iteration 37 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.22s (total since entry 14.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.49s (total since entry 6.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37995}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37995}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37995}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37995}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37995}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37995.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 37 completed successfully
Sun Nov 16 03:17:09 PM CET 2025: Completed iteration 37

=== Iteration 38/300 ===
Sun Nov 16 03:17:09 PM CET 2025: Starting company car negotiation iteration 38 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.21s (total since entry 14.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.48s (total since entry 6.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 38 completed successfully
Sun Nov 16 03:17:52 PM CET 2025: Completed iteration 38

=== Iteration 39/300 ===
Sun Nov 16 03:17:52 PM CET 2025: Starting company car negotiation iteration 39 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.82s (total since entry 6.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1405.20 (saved â‚¬-1405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3287.87 (profit â‚¬3287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37189.60, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1405.20, model_a surplus=3287.87
âœ… Calculated utility_surplus: {'model_a': 3287.8745256249967, 'model_b': -1405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 37189.59715125, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 3287.8745256249967, 'model_b': -1405.2014243750018}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 39 completed successfully
Sun Nov 16 03:18:40 PM CET 2025: Completed iteration 39

=== Iteration 40/300 ===
Sun Nov 16 03:18:40 PM CET 2025: Starting company car negotiation iteration 40 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.04s (total since entry 15.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,999 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,450 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 732.54 (saved â‚¬732.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1178.81 (profit â‚¬1178.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39915.07, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=732.54, model_b surplus=1178.81
âœ… Calculated utility_surplus: {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39915.07324999999, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 40 completed successfully
Sun Nov 16 03:19:18 PM CET 2025: Completed iteration 40

=== Iteration 41/300 ===
Sun Nov 16 03:19:18 PM CET 2025: Starting company car negotiation iteration 41 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.89s (total since entry 14.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,950 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=37950
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1232.54 (saved â‚¬1232.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 678.81 (profit â‚¬678.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40415.07, seller=37950.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1232.54, model_a surplus=678.81
âœ… Calculated utility_surplus: {'model_a': 678.8066250000047, 'model_b': 1232.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40415.07324999999, 'model_a': 37950.0}
Metrics: {'utility_surplus': {'model_a': 678.8066250000047, 'model_b': 1232.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 41 completed successfully
Sun Nov 16 03:19:54 PM CET 2025: Completed iteration 41

=== Iteration 42/300 ===
Sun Nov 16 03:19:54 PM CET 2025: Starting company car negotiation iteration 42 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 42 completed successfully
Sun Nov 16 03:20:32 PM CET 2025: Completed iteration 42

=== Iteration 43/300 ===
Sun Nov 16 03:20:32 PM CET 2025: Starting company car negotiation iteration 43 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", ROLE_A", "price": 39400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE_A", "price": 39400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE_A", "price": 39400}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE_A", "price": 39400}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE_A", "price": 39400}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 43 completed successfully
Sun Nov 16 03:21:17 PM CET 2025: Completed iteration 43

=== Iteration 44/300 ===
Sun Nov 16 03:21:17 PM CET 2025: Starting company car negotiation iteration 44 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 44 completed successfully
Sun Nov 16 03:21:56 PM CET 2025: Completed iteration 44

=== Iteration 45/300 ===
Sun Nov 16 03:21:56 PM CET 2025: Starting company car negotiation iteration 45 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.01s (total since entry 14.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 45 completed successfully
Sun Nov 16 03:22:38 PM CET 2025: Completed iteration 45

=== Iteration 46/300 ===
Sun Nov 16 03:22:38 PM CET 2025: Starting company car negotiation iteration 46 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.87s (total since entry 14.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ’¡ Player model_a made offer â‚¬37,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 46 completed successfully
Sun Nov 16 03:23:25 PM CET 2025: Completed iteration 46

=== Iteration 47/300 ===
Sun Nov 16 03:23:25 PM CET 2025: Starting company car negotiation iteration 47 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 47 completed successfully
Sun Nov 16 03:24:04 PM CET 2025: Completed iteration 47

=== Iteration 48/300 ===
Sun Nov 16 03:24:04 PM CET 2025: Starting company car negotiation iteration 48 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.97s (total since entry 14.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.83s (total since entry 6.56s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬36,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2594.80 (saved â‚¬2594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -712.13 (profit â‚¬-712.13 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41189.60, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2594.80, model_b surplus=-712.13
âœ… Calculated utility_surplus: {'model_a': 2594.798575624998, 'model_b': -712.1254743750033}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 41189.59715125, 'model_b': 36000.0}
Metrics: {'utility_surplus': {'model_a': 2594.798575624998, 'model_b': -712.1254743750033}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 48 completed successfully
Sun Nov 16 03:24:49 PM CET 2025: Completed iteration 48

=== Iteration 49/300 ===
Sun Nov 16 03:24:49 PM CET 2025: Starting company car negotiation iteration 49 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬37,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1594.80 (saved â‚¬1594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 287.87 (profit â‚¬287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40189.60, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1594.80, model_b surplus=287.87
âœ… Calculated utility_surplus: {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 40189.59715125, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 49 completed successfully
Sun Nov 16 03:25:29 PM CET 2025: Completed iteration 49

=== Iteration 50/300 ===
Sun Nov 16 03:25:29 PM CET 2025: Starting company car negotiation iteration 50 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 50 completed successfully
Sun Nov 16 03:26:12 PM CET 2025: Completed iteration 50

=== Iteration 51/300 ===
Sun Nov 16 03:26:12 PM CET 2025: Starting company car negotiation iteration 51 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.97s (total since entry 14.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 51 completed successfully
Sun Nov 16 03:26:53 PM CET 2025: Completed iteration 51

=== Iteration 52/300 ===
Sun Nov 16 03:26:53 PM CET 2025: Starting company car negotiation iteration 52 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 52 completed successfully
Sun Nov 16 03:27:37 PM CET 2025: Completed iteration 52

=== Iteration 53/300 ===
Sun Nov 16 03:27:37 PM CET 2025: Starting company car negotiation iteration 53 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.85s (total since entry 14.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 53 completed successfully
Sun Nov 16 03:28:19 PM CET 2025: Completed iteration 53

=== Iteration 54/300 ===
Sun Nov 16 03:28:19 PM CET 2025: Starting company car negotiation iteration 54 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 54 completed successfully
Sun Nov 16 03:29:00 PM CET 2025: Completed iteration 54

=== Iteration 55/300 ===
Sun Nov 16 03:29:00 PM CET 2025: Starting company car negotiation iteration 55 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.62s (total since entry 6.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,450 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 732.54 (saved â‚¬732.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1178.81 (profit â‚¬1178.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39915.07, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=732.54, model_b surplus=1178.81
âœ… Calculated utility_surplus: {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39915.07324999999, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 55 completed successfully
Sun Nov 16 03:29:43 PM CET 2025: Completed iteration 55

=== Iteration 56/300 ===
Sun Nov 16 03:29:43 PM CET 2025: Starting company car negotiation iteration 56 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.27s (total since entry 14.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.56s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38900\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬38,900 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 994.80 (saved â‚¬994.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 887.87 (profit â‚¬887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39589.60, seller=37600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=994.80, model_b surplus=887.87
âœ… Calculated utility_surplus: {'model_a': 994.7985756249982, 'model_b': 887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39589.59715125, 'model_b': 37600.0}
Metrics: {'utility_surplus': {'model_a': 994.7985756249982, 'model_b': 887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 56 completed successfully
Sun Nov 16 03:30:21 PM CET 2025: Completed iteration 56

=== Iteration 57/300 ===
Sun Nov 16 03:30:21 PM CET 2025: Starting company car negotiation iteration 57 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.21s (total since entry 14.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.59s (total since entry 6.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 57 completed successfully
Sun Nov 16 03:30:59 PM CET 2025: Completed iteration 57

=== Iteration 58/300 ===
Sun Nov 16 03:30:59 PM CET 2025: Starting company car negotiation iteration 58 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.23s (total since entry 14.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.51s (total since entry 6.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37840}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37840}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37840}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37840}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37840}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37840.0}
ğŸ’¡ Player model_b made offer â‚¬37,840 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1682.54, model_b surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40865.07324999999, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 58 completed successfully
Sun Nov 16 03:31:38 PM CET 2025: Completed iteration 58

=== Iteration 59/300 ===
Sun Nov 16 03:31:38 PM CET 2025: Starting company car negotiation iteration 59 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.23s (total since entry 14.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.56s (total since entry 6.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 59 completed successfully
Sun Nov 16 03:32:26 PM CET 2025: Completed iteration 59

=== Iteration 60/300 ===
Sun Nov 16 03:32:26 PM CET 2025: Starting company car negotiation iteration 60 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.22s (total since entry 14.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.52s (total since entry 6.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1182.54 (saved â‚¬1182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 728.81 (profit â‚¬728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40365.07, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1182.54, model_b surplus=728.81
âœ… Calculated utility_surplus: {'model_a': 1182.5366249999934, 'model_b': 728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40365.07324999999, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1182.5366249999934, 'model_b': 728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 60 completed successfully
Sun Nov 16 03:33:03 PM CET 2025: Completed iteration 60

=== Iteration 61/300 ===
Sun Nov 16 03:33:03 PM CET 2025: Starting company car negotiation iteration 61 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.84s (total since entry 6.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 61 completed successfully
Sun Nov 16 03:33:50 PM CET 2025: Completed iteration 61

=== Iteration 62/300 ===
Sun Nov 16 03:33:50 PM CET 2025: Starting company car negotiation iteration 62 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,650 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 62 completed successfully
Sun Nov 16 03:34:30 PM CET 2025: Completed iteration 62

=== Iteration 63/300 ===
Sun Nov 16 03:34:30 PM CET 2025: Starting company car negotiation iteration 63 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.96s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.75s (total since entry 6.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 63 completed successfully
Sun Nov 16 03:35:21 PM CET 2025: Completed iteration 63

=== Iteration 64/300 ===
Sun Nov 16 03:35:21 PM CET 2025: Starting company car negotiation iteration 64 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.95s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 36900\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 36900\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 36900\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 64 completed successfully
Sun Nov 16 03:36:04 PM CET 2025: Completed iteration 64

=== Iteration 65/300 ===
Sun Nov 16 03:36:04 PM CET 2025: Starting company car negotiation iteration 65 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.96s (total since entry 14.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 65 completed successfully
Sun Nov 16 03:36:45 PM CET 2025: Completed iteration 65

=== Iteration 66/300 ===
Sun Nov 16 03:36:45 PM CET 2025: Starting company car negotiation iteration 66 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.98s (total since entry 14.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.87s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", ROLE_A", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE_A", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE_A", "price": 38350}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE_A", "price": 38350}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE_A", "price": 38350}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", ROLE B", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE B", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE B", "price": 38450}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE B", "price": 38450}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE B", "price": 38450}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE A", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 38250}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 38250}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 38250}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 66 completed successfully
Sun Nov 16 03:37:30 PM CET 2025: Completed iteration 66

=== Iteration 67/300 ===
Sun Nov 16 03:37:30 PM CET 2025: Starting company car negotiation iteration 67 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.75s (total since entry 6.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 67 completed successfully
Sun Nov 16 03:38:14 PM CET 2025: Completed iteration 67

=== Iteration 68/300 ===
Sun Nov 16 03:38:14 PM CET 2025: Starting company car negotiation iteration 68 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.89s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 68 completed successfully
Sun Nov 16 03:38:54 PM CET 2025: Completed iteration 68

=== Iteration 69/300 ===
Sun Nov 16 03:38:54 PM CET 2025: Starting company car negotiation iteration 69 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.95s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
ğŸ’¡ Player model_b made offer â‚¬38,390 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬36,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2594.80 (saved â‚¬2594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -712.13 (profit â‚¬-712.13 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41189.60, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2594.80, model_b surplus=-712.13
âœ… Calculated utility_surplus: {'model_a': 2594.798575624998, 'model_b': -712.1254743750033}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 41189.59715125, 'model_b': 36000.0}
Metrics: {'utility_surplus': {'model_a': 2594.798575624998, 'model_b': -712.1254743750033}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 69 completed successfully
Sun Nov 16 03:39:34 PM CET 2025: Completed iteration 69

=== Iteration 70/300 ===
Sun Nov 16 03:39:34 PM CET 2025: Starting company car negotiation iteration 70 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,550 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38550
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 44.80 (saved â‚¬44.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1837.87 (profit â‚¬1837.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38639.60, seller=38550.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=44.80, model_a surplus=1837.87
âœ… Calculated utility_surplus: {'model_a': 1837.8745256249967, 'model_b': 44.79857562499819}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38639.59715125, 'model_a': 38550.0}
Metrics: {'utility_surplus': {'model_a': 1837.8745256249967, 'model_b': 44.79857562499819}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 70 completed successfully
Sun Nov 16 03:40:18 PM CET 2025: Completed iteration 70

=== Iteration 71/300 ===
Sun Nov 16 03:40:18 PM CET 2025: Starting company car negotiation iteration 71 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 71 completed successfully
Sun Nov 16 03:41:05 PM CET 2025: Completed iteration 71

=== Iteration 72/300 ===
Sun Nov 16 03:41:05 PM CET 2025: Starting company car negotiation iteration 72 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.07s (total since entry 15.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.73s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,600 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=582.54, model_a surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39765.07324999999, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 72 completed successfully
Sun Nov 16 03:41:45 PM CET 2025: Completed iteration 72

=== Iteration 73/300 ===
Sun Nov 16 03:41:45 PM CET 2025: Starting company car negotiation iteration 73 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.73s (total since entry 6.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'reject'}
âš ï¸ Player model_a rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 73 completed successfully
Sun Nov 16 03:42:23 PM CET 2025: Completed iteration 73

=== Iteration 74/300 ===
Sun Nov 16 03:42:23 PM CET 2025: Starting company car negotiation iteration 74 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38400}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38400}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38400}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,200 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 982.54 (saved â‚¬982.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 928.81 (profit â‚¬928.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40165.07, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=982.54, model_b surplus=928.81
âœ… Calculated utility_surplus: {'model_a': 982.5366249999934, 'model_b': 928.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40165.07324999999, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 982.5366249999934, 'model_b': 928.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 74 completed successfully
Sun Nov 16 03:43:04 PM CET 2025: Completed iteration 74

=== Iteration 75/300 ===
Sun Nov 16 03:43:04 PM CET 2025: Starting company car negotiation iteration 75 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 75 completed successfully
Sun Nov 16 03:43:37 PM CET 2025: Completed iteration 75

=== Iteration 76/300 ===
Sun Nov 16 03:43:37 PM CET 2025: Starting company car negotiation iteration 76 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.83s (total since entry 14.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 76 completed successfully
Sun Nov 16 03:44:27 PM CET 2025: Completed iteration 76

=== Iteration 77/300 ===
Sun Nov 16 03:44:27 PM CET 2025: Starting company car negotiation iteration 77 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.22s (total since entry 14.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.37s (total since entry 6.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,390 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,390 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ’¡ Player model_a made offer â‚¬37,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 77 completed successfully
Sun Nov 16 03:45:16 PM CET 2025: Completed iteration 77

=== Iteration 78/300 ===
Sun Nov 16 03:45:16 PM CET 2025: Starting company car negotiation iteration 78 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 14.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.45s (total since entry 6.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,800 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 78 completed successfully
Sun Nov 16 03:45:54 PM CET 2025: Completed iteration 78

=== Iteration 79/300 ===
Sun Nov 16 03:45:54 PM CET 2025: Starting company car negotiation iteration 79 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.22s (total since entry 14.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.51s (total since entry 6.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38450}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38450}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38450}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 79 completed successfully
Sun Nov 16 03:46:43 PM CET 2025: Completed iteration 79

=== Iteration 80/300 ===
Sun Nov 16 03:46:43 PM CET 2025: Starting company car negotiation iteration 80 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.28s (total since entry 14.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.41s (total since entry 6.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 80 completed successfully
Sun Nov 16 03:47:28 PM CET 2025: Completed iteration 80

=== Iteration 81/300 ===
Sun Nov 16 03:47:28 PM CET 2025: Starting company car negotiation iteration 81 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.45s (total since entry 14.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.47s (total since entry 6.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37,500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,300 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=294.80, model_b surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 294.7985756249982, 'model_b': 1587.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38889.59715125, 'model_b': 38300.0}
Metrics: {'utility_surplus': {'model_a': 294.7985756249982, 'model_b': 1587.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 81 completed successfully
Sun Nov 16 03:48:10 PM CET 2025: Completed iteration 81

=== Iteration 82/300 ===
Sun Nov 16 03:48:10 PM CET 2025: Starting company car negotiation iteration 82 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.83s (total since entry 14.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 82 completed successfully
Sun Nov 16 03:48:46 PM CET 2025: Completed iteration 82

=== Iteration 83/300 ===
Sun Nov 16 03:48:46 PM CET 2025: Starting company car negotiation iteration 83 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38380}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38380}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38380}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38380}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38380}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38380.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,380 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 83 completed successfully
Sun Nov 16 03:49:28 PM CET 2025: Completed iteration 83

=== Iteration 84/300 ===
Sun Nov 16 03:49:28 PM CET 2025: Starting company car negotiation iteration 84 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.89s (total since entry 14.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -155.20 (saved â‚¬-155.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2037.87 (profit â‚¬2037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38439.60, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-155.20, model_b surplus=2037.87
âœ… Calculated utility_surplus: {'model_a': -155.2014243750018, 'model_b': 2037.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38439.59715125, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': -155.2014243750018, 'model_b': 2037.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 84 completed successfully
Sun Nov 16 03:50:21 PM CET 2025: Completed iteration 84

=== Iteration 85/300 ===
Sun Nov 16 03:50:21 PM CET 2025: Starting company car negotiation iteration 85 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37,500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 85 completed successfully
Sun Nov 16 03:51:03 PM CET 2025: Completed iteration 85

=== Iteration 86/300 ===
Sun Nov 16 03:51:03 PM CET 2025: Starting company car negotiation iteration 86 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.58s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE B", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE B", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE B", "price": 38350}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE B", "price": 38350}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE B", "price": 38350}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 86 completed successfully
Sun Nov 16 03:51:50 PM CET 2025: Completed iteration 86

=== Iteration 87/300 ===
Sun Nov 16 03:51:50 PM CET 2025: Starting company car negotiation iteration 87 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬37,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1594.80 (saved â‚¬1594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 287.87 (profit â‚¬287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40189.60, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1594.80, model_b surplus=287.87
âœ… Calculated utility_surplus: {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 40189.59715125, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 87 completed successfully
Sun Nov 16 03:52:31 PM CET 2025: Completed iteration 87

=== Iteration 88/300 ===
Sun Nov 16 03:52:31 PM CET 2025: Starting company car negotiation iteration 88 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,390 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38380}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38380}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38380}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38380}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38380}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38380.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 88 completed successfully
Sun Nov 16 03:53:11 PM CET 2025: Completed iteration 88

=== Iteration 89/300 ===
Sun Nov 16 03:53:11 PM CET 2025: Starting company car negotiation iteration 89 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬36,800 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 89 completed successfully
Sun Nov 16 03:53:52 PM CET 2025: Completed iteration 89

=== Iteration 90/300 ===
Sun Nov 16 03:53:52 PM CET 2025: Starting company car negotiation iteration 90 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.01s (total since entry 14.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 37000}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 37000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 37000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 90 completed successfully
Sun Nov 16 03:54:36 PM CET 2025: Completed iteration 90

=== Iteration 91/300 ===
Sun Nov 16 03:54:36 PM CET 2025: Starting company car negotiation iteration 91 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.81s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 91 completed successfully
Sun Nov 16 03:55:23 PM CET 2025: Completed iteration 91

=== Iteration 92/300 ===
Sun Nov 16 03:55:23 PM CET 2025: Starting company car negotiation iteration 92 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.97s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,850 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 92 completed successfully
Sun Nov 16 03:56:14 PM CET 2025: Completed iteration 92

=== Iteration 93/300 ===
Sun Nov 16 03:56:14 PM CET 2025: Starting company car negotiation iteration 93 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.86s (total since entry 14.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.68s (total since entry 6.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=782.54, model_a surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 1128.8066250000047, 'model_b': 782.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39965.07324999999, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1128.8066250000047, 'model_b': 782.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 93 completed successfully
Sun Nov 16 03:56:47 PM CET 2025: Completed iteration 93

=== Iteration 94/300 ===
Sun Nov 16 03:56:47 PM CET 2025: Starting company car negotiation iteration 94 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.92s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 4000.00 (saved â‚¬4000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -2000.00 (profit â‚¬-2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=45000.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=4000.00, model_a surplus=-2000.00
âœ… Calculated utility_surplus: {'model_a': -2000.0, 'model_b': 4000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 45000.0, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': -2000.0, 'model_b': 4000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 94 completed successfully
Sun Nov 16 03:57:16 PM CET 2025: Completed iteration 94

=== Iteration 95/300 ===
Sun Nov 16 03:57:16 PM CET 2025: Starting company car negotiation iteration 95 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.81s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 25.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 25.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 95 completed successfully
Sun Nov 16 03:58:00 PM CET 2025: Completed iteration 95

=== Iteration 96/300 ===
Sun Nov 16 03:58:00 PM CET 2025: Starting company car negotiation iteration 96 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.95s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.75s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38150\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38150\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38150\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 96 completed successfully
Sun Nov 16 03:58:40 PM CET 2025: Completed iteration 96

=== Iteration 97/300 ===
Sun Nov 16 03:58:40 PM CET 2025: Starting company car negotiation iteration 97 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.91s (total since entry 14.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,250 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 932.54 (saved â‚¬932.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 978.81 (profit â‚¬978.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40115.07, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=932.54, model_b surplus=978.81
âœ… Calculated utility_surplus: {'model_a': 932.5366249999934, 'model_b': 978.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40115.07324999999, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 932.5366249999934, 'model_b': 978.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 97 completed successfully
Sun Nov 16 03:59:18 PM CET 2025: Completed iteration 97

=== Iteration 98/300 ===
Sun Nov 16 03:59:18 PM CET 2025: Starting company car negotiation iteration 98 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.11s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.41s (total since entry 14.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.51s (total since entry 6.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 98 completed successfully
Sun Nov 16 04:00:04 PM CET 2025: Completed iteration 98

=== Iteration 99/300 ===
Sun Nov 16 04:00:04 PM CET 2025: Starting company car negotiation iteration 99 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 14.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.57s (total since entry 6.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36,500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36,500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36,500}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 36,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 36,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 99 completed successfully
Sun Nov 16 04:00:55 PM CET 2025: Completed iteration 99

=== Iteration 100/300 ===
Sun Nov 16 04:00:55 PM CET 2025: Starting company car negotiation iteration 100 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.33s (total since entry 14.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.54s (total since entry 6.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE A", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 38490}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 38490}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 38490}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE A", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 38000}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 38000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 38000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 100 completed successfully
Sun Nov 16 04:01:42 PM CET 2025: Completed iteration 100

=== Iteration 101/300 ===
Sun Nov 16 04:01:42 PM CET 2025: Starting company car negotiation iteration 101 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.25s (total since entry 14.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.47s (total since entry 6.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 844.80 (saved â‚¬844.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1037.87 (profit â‚¬1037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39439.60, seller=37750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=844.80, model_b surplus=1037.87
âœ… Calculated utility_surplus: {'model_a': 844.7985756249982, 'model_b': 1037.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39439.59715125, 'model_b': 37750.0}
Metrics: {'utility_surplus': {'model_a': 844.7985756249982, 'model_b': 1037.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 101 completed successfully
Sun Nov 16 04:02:22 PM CET 2025: Completed iteration 101

=== Iteration 102/300 ===
Sun Nov 16 04:02:22 PM CET 2025: Starting company car negotiation iteration 102 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 14.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.56s (total since entry 6.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 102 completed successfully
Sun Nov 16 04:03:01 PM CET 2025: Completed iteration 102

=== Iteration 103/300 ===
Sun Nov 16 04:03:01 PM CET 2025: Starting company car negotiation iteration 103 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.90s (total since entry 14.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.77s (total since entry 6.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 103 completed successfully
Sun Nov 16 04:03:48 PM CET 2025: Completed iteration 103

=== Iteration 104/300 ===
Sun Nov 16 04:03:48 PM CET 2025: Starting company car negotiation iteration 104 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.82s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 104 completed successfully
Sun Nov 16 04:04:29 PM CET 2025: Completed iteration 104

=== Iteration 105/300 ===
Sun Nov 16 04:04:29 PM CET 2025: Starting company car negotiation iteration 105 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.94s (total since entry 14.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 105 completed successfully
Sun Nov 16 04:05:08 PM CET 2025: Completed iteration 105

=== Iteration 106/300 ===
Sun Nov 16 04:05:08 PM CET 2025: Starting company car negotiation iteration 106 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.85s (total since entry 14.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.78s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=394.80, model_a surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38989.59715125, 'model_a': 38200.0}
Metrics: {'utility_surplus': {'model_a': 1487.8745256249967, 'model_b': 394.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 106 completed successfully
Sun Nov 16 04:05:47 PM CET 2025: Completed iteration 106

=== Iteration 107/300 ===
Sun Nov 16 04:05:47 PM CET 2025: Starting company car negotiation iteration 107 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.88s (total since entry 14.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.81s (total since entry 6.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬36,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 107 completed successfully
Sun Nov 16 04:06:33 PM CET 2025: Completed iteration 107

=== Iteration 108/300 ===
Sun Nov 16 04:06:33 PM CET 2025: Starting company car negotiation iteration 108 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.43s (total since entry 15.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.11s (total since entry 6.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,350 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38300}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38300}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38300}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 108 completed successfully
Sun Nov 16 04:07:24 PM CET 2025: Completed iteration 108

=== Iteration 109/300 ===
Sun Nov 16 04:07:24 PM CET 2025: Starting company car negotiation iteration 109 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.07s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 7.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38290}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38290}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38290}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38290}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38290}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38290.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,290 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,290 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38290
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 304.80 (saved â‚¬304.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1577.87 (profit â‚¬1577.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38899.60, seller=38290.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=304.80, model_a surplus=1577.87
âœ… Calculated utility_surplus: {'model_a': 1577.8745256249967, 'model_b': 304.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38899.59715125, 'model_a': 38290.0}
Metrics: {'utility_surplus': {'model_a': 1577.8745256249967, 'model_b': 304.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 109 completed successfully
Sun Nov 16 04:08:08 PM CET 2025: Completed iteration 109

=== Iteration 110/300 ===
Sun Nov 16 04:08:08 PM CET 2025: Starting company car negotiation iteration 110 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 110 completed successfully
Sun Nov 16 04:08:56 PM CET 2025: Completed iteration 110

=== Iteration 111/300 ===
Sun Nov 16 04:08:56 PM CET 2025: Starting company car negotiation iteration 111 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,400 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1379.22, model_a surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41158.45, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 111 completed successfully
Sun Nov 16 04:09:36 PM CET 2025: Completed iteration 111

=== Iteration 112/300 ===
Sun Nov 16 04:09:36 PM CET 2025: Starting company car negotiation iteration 112 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.22s (total since entry 6.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37490.0}
ğŸ’¡ Player model_b made offer â‚¬37,490 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,499 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38499
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 95.80 (saved â‚¬95.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1786.87 (profit â‚¬1786.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38690.60, seller=38499.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=95.80, model_a surplus=1786.87
âœ… Calculated utility_surplus: {'model_a': 1786.8745256249967, 'model_b': 95.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38690.59715125, 'model_a': 38499.0}
Metrics: {'utility_surplus': {'model_a': 1786.8745256249967, 'model_b': 95.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 112 completed successfully
Sun Nov 16 04:10:18 PM CET 2025: Completed iteration 112

=== Iteration 113/300 ===
Sun Nov 16 04:10:18 PM CET 2025: Starting company car negotiation iteration 113 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.04s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 113 completed successfully
Sun Nov 16 04:10:58 PM CET 2025: Completed iteration 113

=== Iteration 114/300 ===
Sun Nov 16 04:10:58 PM CET 2025: Starting company car negotiation iteration 114 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ’¡ Player model_b made offer â‚¬36,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 114 completed successfully
Sun Nov 16 04:11:35 PM CET 2025: Completed iteration 114

=== Iteration 115/300 ===
Sun Nov 16 04:11:35 PM CET 2025: Starting company car negotiation iteration 115 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36999.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,999 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 115 completed successfully
Sun Nov 16 04:12:21 PM CET 2025: Completed iteration 115

=== Iteration 116/300 ===
Sun Nov 16 04:12:21 PM CET 2025: Starting company car negotiation iteration 116 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.02s (total since entry 15.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.96s (total since entry 7.66s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 116 completed successfully
Sun Nov 16 04:13:05 PM CET 2025: Completed iteration 116

=== Iteration 117/300 ===
Sun Nov 16 04:13:05 PM CET 2025: Starting company car negotiation iteration 117 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=794.80, model_a surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 1087.8745256249967, 'model_b': 794.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39389.59715125, 'model_a': 37800.0}
Metrics: {'utility_surplus': {'model_a': 1087.8745256249967, 'model_b': 794.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 117 completed successfully
Sun Nov 16 04:13:48 PM CET 2025: Completed iteration 117

=== Iteration 118/300 ===
Sun Nov 16 04:13:48 PM CET 2025: Starting company car negotiation iteration 118 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
21, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38625}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38625}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38625}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38625}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38625}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38625.0}
ğŸ’¡ Player model_b made offer â‚¬38,625 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 118 completed successfully
Sun Nov 16 04:14:32 PM CET 2025: Completed iteration 118

=== Iteration 119/300 ===
Sun Nov 16 04:14:32 PM CET 2025: Starting company car negotiation iteration 119 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.94s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.21s (total since entry 6.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,300 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=294.80, model_b surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 294.7985756249982, 'model_b': 1587.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38889.59715125, 'model_b': 38300.0}
Metrics: {'utility_surplus': {'model_a': 294.7985756249982, 'model_b': 1587.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 119 completed successfully
Sun Nov 16 04:15:17 PM CET 2025: Completed iteration 119

=== Iteration 120/300 ===
Sun Nov 16 04:15:17 PM CET 2025: Starting company car negotiation iteration 120 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 120 completed successfully
Sun Nov 16 04:16:03 PM CET 2025: Completed iteration 120

=== Iteration 121/300 ===
Sun Nov 16 04:16:03 PM CET 2025: Starting company car negotiation iteration 121 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 121 completed successfully
Sun Nov 16 04:16:48 PM CET 2025: Completed iteration 121

=== Iteration 122/300 ===
Sun Nov 16 04:16:48 PM CET 2025: Starting company car negotiation iteration 122 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38600}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38600}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38600}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 122 completed successfully
Sun Nov 16 04:17:42 PM CET 2025: Completed iteration 122

=== Iteration 123/300 ===
Sun Nov 16 04:17:42 PM CET 2025: Starting company car negotiation iteration 123 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.82s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 7.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 123 completed successfully
Sun Nov 16 04:18:31 PM CET 2025: Completed iteration 123

=== Iteration 124/300 ===
Sun Nov 16 04:18:31 PM CET 2025: Starting company car negotiation iteration 124 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38380}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38380}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38380}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38380}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38380}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38380.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,380 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=144.80, model_a surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38739.59715125, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 1737.8745256249967, 'model_b': 144.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 124 completed successfully
Sun Nov 16 04:19:14 PM CET 2025: Completed iteration 124

=== Iteration 125/300 ===
Sun Nov 16 04:19:14 PM CET 2025: Starting company car negotiation iteration 125 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 125 completed successfully
Sun Nov 16 04:20:04 PM CET 2025: Completed iteration 125

=== Iteration 126/300 ===
Sun Nov 16 04:20:04 PM CET 2025: Starting company car negotiation iteration 126 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'reject'}
âŒ Player model_a rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 126 completed successfully
Sun Nov 16 04:20:59 PM CET 2025: Completed iteration 126

=== Iteration 127/300 ===
Sun Nov 16 04:20:59 PM CET 2025: Starting company car negotiation iteration 127 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2500.00, model_a surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': -500.0, 'model_b': 2500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43500.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': -500.0, 'model_b': 2500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 127 completed successfully
Sun Nov 16 04:21:32 PM CET 2025: Completed iteration 127

=== Iteration 128/300 ===
Sun Nov 16 04:21:32 PM CET 2025: Starting company car negotiation iteration 128 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 128 completed successfully
Sun Nov 16 04:22:13 PM CET 2025: Completed iteration 128

=== Iteration 129/300 ===
Sun Nov 16 04:22:13 PM CET 2025: Starting company car negotiation iteration 129 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.13s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 16.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 129 completed successfully
Sun Nov 16 04:22:53 PM CET 2025: Completed iteration 129

=== Iteration 130/300 ===
Sun Nov 16 04:22:53 PM CET 2025: Starting company car negotiation iteration 130 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.03s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1682.54, model_b surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40865.07324999999, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 130 completed successfully
Sun Nov 16 04:23:36 PM CET 2025: Completed iteration 130

=== Iteration 131/300 ===
Sun Nov 16 04:23:36 PM CET 2025: Starting company car negotiation iteration 131 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.25s (total since entry 6.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,999 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 131 completed successfully
Sun Nov 16 04:24:19 PM CET 2025: Completed iteration 131

=== Iteration 132/300 ===
Sun Nov 16 04:24:19 PM CET 2025: Starting company car negotiation iteration 132 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,390 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬36,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=36500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2094.80 (saved â‚¬2094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -212.13 (profit â‚¬-212.13 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40689.60, seller=36500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2094.80, model_b surplus=-212.13
âœ… Calculated utility_surplus: {'model_a': 2094.798575624998, 'model_b': -212.12547437500325}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 40689.59715125, 'model_b': 36500.0}
Metrics: {'utility_surplus': {'model_a': 2094.798575624998, 'model_b': -212.12547437500325}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 132 completed successfully
Sun Nov 16 04:25:02 PM CET 2025: Completed iteration 132

=== Iteration 133/300 ===
Sun Nov 16 04:25:03 PM CET 2025: Starting company car negotiation iteration 133 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ’¡ Player model_b made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 133 completed successfully
Sun Nov 16 04:25:44 PM CET 2025: Completed iteration 133

=== Iteration 134/300 ===
Sun Nov 16 04:25:44 PM CET 2025: Starting company car negotiation iteration 134 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 134 completed successfully
Sun Nov 16 04:26:27 PM CET 2025: Completed iteration 134

=== Iteration 135/300 ===
Sun Nov 16 04:26:27 PM CET 2025: Starting company car negotiation iteration 135 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.03s (total since entry 15.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 135 completed successfully
Sun Nov 16 04:27:16 PM CET 2025: Completed iteration 135

=== Iteration 136/300 ===
Sun Nov 16 04:27:16 PM CET 2025: Starting company car negotiation iteration 136 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.93s (total since entry 15.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 136 completed successfully
Sun Nov 16 04:28:01 PM CET 2025: Completed iteration 136

=== Iteration 137/300 ===
Sun Nov 16 04:28:01 PM CET 2025: Starting company car negotiation iteration 137 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37700.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 137 completed successfully
Sun Nov 16 04:28:49 PM CET 2025: Completed iteration 137

=== Iteration 138/300 ===
Sun Nov 16 04:28:49 PM CET 2025: Starting company car negotiation iteration 138 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.79s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 138 completed successfully
Sun Nov 16 04:29:33 PM CET 2025: Completed iteration 138

=== Iteration 139/300 ===
Sun Nov 16 04:29:33 PM CET 2025: Starting company car negotiation iteration 139 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,100 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 494.80 (saved â‚¬494.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1387.87 (profit â‚¬1387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39089.60, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=494.80, model_b surplus=1387.87
âœ… Calculated utility_surplus: {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39089.59715125, 'model_b': 38100.0}
Metrics: {'utility_surplus': {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 139 completed successfully
Sun Nov 16 04:30:17 PM CET 2025: Completed iteration 139

=== Iteration 140/300 ===
Sun Nov 16 04:30:17 PM CET 2025: Starting company car negotiation iteration 140 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 140 completed successfully
Sun Nov 16 04:31:04 PM CET 2025: Completed iteration 140

=== Iteration 141/300 ===
Sun Nov 16 04:31:04 PM CET 2025: Starting company car negotiation iteration 141 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 36950\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 36950\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 36950\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 141 completed successfully
Sun Nov 16 04:31:46 PM CET 2025: Completed iteration 141

=== Iteration 142/300 ===
Sun Nov 16 04:31:46 PM CET 2025: Starting company car negotiation iteration 142 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.86s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.21s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 142 completed successfully
Sun Nov 16 04:32:35 PM CET 2025: Completed iteration 142

=== Iteration 143/300 ===
Sun Nov 16 04:32:35 PM CET 2025: Starting company car negotiation iteration 143 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.93s (total since entry 15.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37,000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37,000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37,000}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,000}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,000}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 143 completed successfully
Sun Nov 16 04:33:22 PM CET 2025: Completed iteration 143

=== Iteration 144/300 ===
Sun Nov 16 04:33:22 PM CET 2025: Starting company car negotiation iteration 144 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 16.02s (total since entry 17.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.70s (total since entry 7.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 144 completed successfully
Sun Nov 16 04:34:19 PM CET 2025: Completed iteration 144

=== Iteration 145/300 ===
Sun Nov 16 04:34:19 PM CET 2025: Starting company car negotiation iteration 145 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
24, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 145 completed successfully
Sun Nov 16 04:34:56 PM CET 2025: Completed iteration 145

=== Iteration 146/300 ===
Sun Nov 16 04:34:56 PM CET 2025: Starting company car negotiation iteration 146 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
21, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 146 completed successfully
Sun Nov 16 04:35:35 PM CET 2025: Completed iteration 146

=== Iteration 147/300 ===
Sun Nov 16 04:35:35 PM CET 2025: Starting company car negotiation iteration 147 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.07s (total since entry 16.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38380}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38380}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38380}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38380}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38380}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38380.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,380 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 147 completed successfully
Sun Nov 16 04:36:21 PM CET 2025: Completed iteration 147

=== Iteration 148/300 ===
Sun Nov 16 04:36:21 PM CET 2025: Starting company car negotiation iteration 148 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 148 completed successfully
Sun Nov 16 04:37:10 PM CET 2025: Completed iteration 148

=== Iteration 149/300 ===
Sun Nov 16 04:37:10 PM CET 2025: Starting company car negotiation iteration 149 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 149 completed successfully
Sun Nov 16 04:37:58 PM CET 2025: Completed iteration 149

=== Iteration 150/300 ===
Sun Nov 16 04:37:58 PM CET 2025: Starting company car negotiation iteration 150 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 36800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 150 completed successfully
Sun Nov 16 04:38:40 PM CET 2025: Completed iteration 150

=== Iteration 151/300 ===
Sun Nov 16 04:38:40 PM CET 2025: Starting company car negotiation iteration 151 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.12s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1682.54, model_a surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 228.80662500000471, 'model_b': 1682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40865.07324999999, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 228.80662500000471, 'model_b': 1682.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 151 completed successfully
Sun Nov 16 04:39:22 PM CET 2025: Completed iteration 151

=== Iteration 152/300 ===
Sun Nov 16 04:39:22 PM CET 2025: Starting company car negotiation iteration 152 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.79s (total since entry 15.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
23, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 152 completed successfully
Sun Nov 16 04:40:04 PM CET 2025: Completed iteration 152

=== Iteration 153/300 ===
Sun Nov 16 04:40:04 PM CET 2025: Starting company car negotiation iteration 153 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,150 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 153 completed successfully
Sun Nov 16 04:40:56 PM CET 2025: Completed iteration 153

=== Iteration 154/300 ===
Sun Nov 16 04:40:56 PM CET 2025: Starting company car negotiation iteration 154 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 154 completed successfully
Sun Nov 16 04:41:42 PM CET 2025: Completed iteration 154

=== Iteration 155/300 ===
Sun Nov 16 04:41:42 PM CET 2025: Starting company car negotiation iteration 155 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 35000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 35000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 35000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 35000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 35000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 35000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬35,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37,500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 155 completed successfully
Sun Nov 16 04:42:26 PM CET 2025: Completed iteration 155

=== Iteration 156/300 ===
Sun Nov 16 04:42:26 PM CET 2025: Starting company car negotiation iteration 156 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 156 completed successfully
Sun Nov 16 04:43:13 PM CET 2025: Completed iteration 156

=== Iteration 157/300 ===
Sun Nov 16 04:43:13 PM CET 2025: Starting company car negotiation iteration 157 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.23s (total since entry 6.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 157 completed successfully
Sun Nov 16 04:43:56 PM CET 2025: Completed iteration 157

=== Iteration 158/300 ===
Sun Nov 16 04:43:56 PM CET 2025: Starting company car negotiation iteration 158 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 158 completed successfully
Sun Nov 16 04:44:40 PM CET 2025: Completed iteration 158

=== Iteration 159/300 ===
Sun Nov 16 04:44:40 PM CET 2025: Starting company car negotiation iteration 159 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 159 completed successfully
Sun Nov 16 04:45:23 PM CET 2025: Completed iteration 159

=== Iteration 160/300 ===
Sun Nov 16 04:45:23 PM CET 2025: Starting company car negotiation iteration 160 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.21s (total since entry 6.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1682.54, model_a surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 228.80662500000471, 'model_b': 1682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40865.07324999999, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 228.80662500000471, 'model_b': 1682.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 160 completed successfully
Sun Nov 16 04:46:04 PM CET 2025: Completed iteration 160

=== Iteration 161/300 ===
Sun Nov 16 04:46:04 PM CET 2025: Starting company car negotiation iteration 161 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.26s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 16.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "reject"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_b rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 161 completed successfully
Sun Nov 16 04:46:54 PM CET 2025: Completed iteration 161

=== Iteration 162/300 ===
Sun Nov 16 04:46:54 PM CET 2025: Starting company car negotiation iteration 162 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.28s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 16.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.81s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE A", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE A", "price": 37750}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 37750}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A", "price": 37750}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_a made offer â‚¬38,475 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 162 completed successfully
Sun Nov 16 04:47:44 PM CET 2025: Completed iteration 162

=== Iteration 163/300 ===
Sun Nov 16 04:47:44 PM CET 2025: Starting company car negotiation iteration 163 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=432.54, model_b surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 25.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39615.07324999999, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 25.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 163 completed successfully
Sun Nov 16 04:48:26 PM CET 2025: Completed iteration 163

=== Iteration 164/300 ===
Sun Nov 16 04:48:26 PM CET 2025: Starting company car negotiation iteration 164 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.90s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ’¡ Player model_a made offer â‚¬37,999 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬37,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1594.80 (saved â‚¬1594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 287.87 (profit â‚¬287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40189.60, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1594.80, model_b surplus=287.87
âœ… Calculated utility_surplus: {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 40189.59715125, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 1594.7985756249982, 'model_b': 287.87452562499675}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 164 completed successfully
Sun Nov 16 04:49:16 PM CET 2025: Completed iteration 164

=== Iteration 165/300 ===
Sun Nov 16 04:49:16 PM CET 2025: Starting company car negotiation iteration 165 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 932.54 (saved â‚¬932.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 978.81 (profit â‚¬978.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40115.07, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=932.54, model_a surplus=978.81
âœ… Calculated utility_surplus: {'model_a': 978.8066250000047, 'model_b': 932.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 40115.07324999999, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 978.8066250000047, 'model_b': 932.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 165 completed successfully
Sun Nov 16 04:49:54 PM CET 2025: Completed iteration 165

=== Iteration 166/300 ===
Sun Nov 16 04:49:54 PM CET 2025: Starting company car negotiation iteration 166 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 166 completed successfully
Sun Nov 16 04:50:39 PM CET 2025: Completed iteration 166

=== Iteration 167/300 ===
Sun Nov 16 04:50:39 PM CET 2025: Starting company car negotiation iteration 167 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2500.00 (saved â‚¬2500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -500.00 (profit â‚¬-500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43500.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2500.00, model_a surplus=-500.00
âœ… Calculated utility_surplus: {'model_a': -500.0, 'model_b': 2500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43500.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': -500.0, 'model_b': 2500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 167 completed successfully
Sun Nov 16 04:51:12 PM CET 2025: Completed iteration 167

=== Iteration 168/300 ===
Sun Nov 16 04:51:12 PM CET 2025: Starting company car negotiation iteration 168 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 168 completed successfully
Sun Nov 16 04:51:57 PM CET 2025: Completed iteration 168

=== Iteration 169/300 ===
Sun Nov 16 04:51:57 PM CET 2025: Starting company car negotiation iteration 169 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 169 completed successfully
Sun Nov 16 04:52:37 PM CET 2025: Completed iteration 169

=== Iteration 170/300 ===
Sun Nov 16 04:52:37 PM CET 2025: Starting company car negotiation iteration 170 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.75s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 170 completed successfully
Sun Nov 16 04:53:19 PM CET 2025: Completed iteration 170

=== Iteration 171/300 ===
Sun Nov 16 04:53:19 PM CET 2025: Starting company car negotiation iteration 171 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.80s (total since entry 15.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 39450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39450.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1405.20 (saved â‚¬-1405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3287.87 (profit â‚¬3287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37189.60, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1405.20, model_a surplus=3287.87
âœ… Calculated utility_surplus: {'model_a': 3287.8745256249967, 'model_b': -1405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 37189.59715125, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 3287.8745256249967, 'model_b': -1405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 171 completed successfully
Sun Nov 16 04:54:04 PM CET 2025: Completed iteration 171

=== Iteration 172/300 ===
Sun Nov 16 04:54:04 PM CET 2025: Starting company car negotiation iteration 172 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38650\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38650\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38650\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38600}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38600}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38600}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 172 completed successfully
Sun Nov 16 04:54:45 PM CET 2025: Completed iteration 172

=== Iteration 173/300 ===
Sun Nov 16 04:54:45 PM CET 2025: Starting company car negotiation iteration 173 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.22s (total since entry 6.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 173 completed successfully
Sun Nov 16 04:55:21 PM CET 2025: Completed iteration 173

=== Iteration 174/300 ===
Sun Nov 16 04:55:21 PM CET 2025: Starting company car negotiation iteration 174 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 39415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 39415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 39415}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 39415}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 39415}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 174 completed successfully
Sun Nov 16 04:56:17 PM CET 2025: Completed iteration 174

=== Iteration 175/300 ===
Sun Nov 16 04:56:17 PM CET 2025: Starting company car negotiation iteration 175 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38120}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38120}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38120}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38120}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38120}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38120.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬36,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 5: price=36000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2594.80 (saved â‚¬2594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -712.13 (profit â‚¬-712.13 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41189.60, seller=36000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2594.80, model_b surplus=-712.13
âœ… Calculated utility_surplus: {'model_a': 2594.798575624998, 'model_b': -712.1254743750033}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 41189.59715125, 'model_b': 36000.0}
Metrics: {'utility_surplus': {'model_a': 2594.798575624998, 'model_b': -712.1254743750033}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 175 completed successfully
Sun Nov 16 04:57:09 PM CET 2025: Completed iteration 175

=== Iteration 176/300 ===
Sun Nov 16 04:57:09 PM CET 2025: Starting company car negotiation iteration 176 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 176 completed successfully
Sun Nov 16 04:57:53 PM CET 2025: Completed iteration 176

=== Iteration 177/300 ===
Sun Nov 16 04:57:53 PM CET 2025: Starting company car negotiation iteration 177 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 177 completed successfully
Sun Nov 16 04:58:43 PM CET 2025: Completed iteration 177

=== Iteration 178/300 ===
Sun Nov 16 04:58:43 PM CET 2025: Starting company car negotiation iteration 178 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 178 completed successfully
Sun Nov 16 04:59:32 PM CET 2025: Completed iteration 178

=== Iteration 179/300 ===
Sun Nov 16 04:59:32 PM CET 2025: Starting company car negotiation iteration 179 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.21s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,490 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,490 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38490
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 104.80 (saved â‚¬104.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1777.87 (profit â‚¬1777.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38699.60, seller=38490.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=104.80, model_a surplus=1777.87
âœ… Calculated utility_surplus: {'model_a': 1777.8745256249967, 'model_b': 104.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38699.59715125, 'model_a': 38490.0}
Metrics: {'utility_surplus': {'model_a': 1777.8745256249967, 'model_b': 104.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 179 completed successfully
Sun Nov 16 05:00:17 PM CET 2025: Completed iteration 179

=== Iteration 180/300 ===
Sun Nov 16 05:00:17 PM CET 2025: Starting company car negotiation iteration 180 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 180 completed successfully
Sun Nov 16 05:01:05 PM CET 2025: Completed iteration 180

=== Iteration 181/300 ===
Sun Nov 16 05:01:05 PM CET 2025: Starting company car negotiation iteration 181 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2885.00 (saved â‚¬2885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -915.00 (profit â‚¬-915.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43270.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2885.00, model_b surplus=-915.00
âœ… Calculated utility_surplus: {'model_a': 2885.0, 'model_b': -915.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 43270.0, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 2885.0, 'model_b': -915.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 181 completed successfully
Sun Nov 16 05:01:38 PM CET 2025: Completed iteration 181

=== Iteration 182/300 ===
Sun Nov 16 05:01:38 PM CET 2025: Starting company car negotiation iteration 182 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.77s (total since entry 15.74s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38490}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38490}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38490}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_a rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 182 completed successfully
Sun Nov 16 05:02:30 PM CET 2025: Completed iteration 182

=== Iteration 183/300 ===
Sun Nov 16 05:02:30 PM CET 2025: Starting company car negotiation iteration 183 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.11s (total since entry 6.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,990 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 36900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 36900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 36900}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 36900}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 36900}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 183 completed successfully
Sun Nov 16 05:03:21 PM CET 2025: Completed iteration 183

=== Iteration 184/300 ===
Sun Nov 16 05:03:21 PM CET 2025: Starting company car negotiation iteration 184 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 184 completed successfully
Sun Nov 16 05:04:07 PM CET 2025: Completed iteration 184

=== Iteration 185/300 ===
Sun Nov 16 05:04:07 PM CET 2025: Starting company car negotiation iteration 185 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.99s (total since entry 16.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3500.00 (saved â‚¬3500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1500.00 (profit â‚¬-1500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=44500.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3500.00, model_a surplus=-1500.00
âœ… Calculated utility_surplus: {'model_a': -1500.0, 'model_b': 3500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 44500.0, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': -1500.0, 'model_b': 3500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 185 completed successfully
Sun Nov 16 05:04:41 PM CET 2025: Completed iteration 185

=== Iteration 186/300 ===
Sun Nov 16 05:04:41 PM CET 2025: Starting company car negotiation iteration 186 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,850 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38650\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38650\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38650\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 186 completed successfully
Sun Nov 16 05:05:34 PM CET 2025: Completed iteration 186

=== Iteration 187/300 ===
Sun Nov 16 05:05:34 PM CET 2025: Starting company car negotiation iteration 187 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.83s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,450 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1329.22 (saved â‚¬1329.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 611.22 (profit â‚¬611.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41108.45, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1329.22, model_a surplus=611.22
âœ… Calculated utility_surplus: {'model_a': 611.2249999999985, 'model_b': 1329.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41108.45, 'model_a': 38450.0}
Metrics: {'utility_surplus': {'model_a': 611.2249999999985, 'model_b': 1329.2249999999985}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 187 completed successfully
Sun Nov 16 05:06:08 PM CET 2025: Completed iteration 187

=== Iteration 188/300 ===
Sun Nov 16 05:06:08 PM CET 2025: Starting company car negotiation iteration 188 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38380}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38380}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38380}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38380}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38380}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38380.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,380 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 188 completed successfully
Sun Nov 16 05:06:49 PM CET 2025: Completed iteration 188

=== Iteration 189/300 ===
Sun Nov 16 05:06:49 PM CET 2025: Starting company car negotiation iteration 189 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.30s (total since entry 6.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 189 completed successfully
Sun Nov 16 05:07:39 PM CET 2025: Completed iteration 189

=== Iteration 190/300 ===
Sun Nov 16 05:07:39 PM CET 2025: Starting company car negotiation iteration 190 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 190 completed successfully
Sun Nov 16 05:08:27 PM CET 2025: Completed iteration 190

=== Iteration 191/300 ===
Sun Nov 16 05:08:27 PM CET 2025: Starting company car negotiation iteration 191 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 191 completed successfully
Sun Nov 16 05:09:06 PM CET 2025: Completed iteration 191

=== Iteration 192/300 ===
Sun Nov 16 05:09:06 PM CET 2025: Starting company car negotiation iteration 192 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
20, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.10s (total since entry 6.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,475 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 192 completed successfully
Sun Nov 16 05:09:46 PM CET 2025: Completed iteration 192

=== Iteration 193/300 ===
Sun Nov 16 05:09:46 PM CET 2025: Starting company car negotiation iteration 193 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬37,700 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 193 completed successfully
Sun Nov 16 05:10:38 PM CET 2025: Completed iteration 193

=== Iteration 194/300 ===
Sun Nov 16 05:10:38 PM CET 2025: Starting company car negotiation iteration 194 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 194 completed successfully
Sun Nov 16 05:11:28 PM CET 2025: Completed iteration 194

=== Iteration 195/300 ===
Sun Nov 16 05:11:28 PM CET 2025: Starting company car negotiation iteration 195 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 195 completed successfully
Sun Nov 16 05:12:18 PM CET 2025: Completed iteration 195

=== Iteration 196/300 ===
Sun Nov 16 05:12:18 PM CET 2025: Starting company car negotiation iteration 196 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38520}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38520}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38520}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38520}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38520}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38520.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38320}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38320}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38320}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38320}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38320}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38320.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 196 completed successfully
Sun Nov 16 05:13:07 PM CET 2025: Completed iteration 196

=== Iteration 197/300 ===
Sun Nov 16 05:13:07 PM CET 2025: Starting company car negotiation iteration 197 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.83s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 7.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 197 completed successfully
Sun Nov 16 05:13:56 PM CET 2025: Completed iteration 197

=== Iteration 198/300 ===
Sun Nov 16 05:13:56 PM CET 2025: Starting company car negotiation iteration 198 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 198 completed successfully
Sun Nov 16 05:14:42 PM CET 2025: Completed iteration 198

=== Iteration 199/300 ===
Sun Nov 16 05:14:42 PM CET 2025: Starting company car negotiation iteration 199 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 199 completed successfully
Sun Nov 16 05:15:33 PM CET 2025: Completed iteration 199

=== Iteration 200/300 ===
Sun Nov 16 05:15:33 PM CET 2025: Starting company car negotiation iteration 200 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬36,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 200 completed successfully
Sun Nov 16 05:16:08 PM CET 2025: Completed iteration 200

=== Iteration 201/300 ===
Sun Nov 16 05:16:08 PM CET 2025: Starting company car negotiation iteration 201 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 3500.00 (saved â‚¬3500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -1500.00 (profit â‚¬-1500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=44500.00, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=3500.00, model_a surplus=-1500.00
âœ… Calculated utility_surplus: {'model_a': -1500.0, 'model_b': 3500.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 44500.0, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': -1500.0, 'model_b': 3500.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 201 completed successfully
Sun Nov 16 05:16:38 PM CET 2025: Completed iteration 201

=== Iteration 202/300 ===
Sun Nov 16 05:16:38 PM CET 2025: Starting company car negotiation iteration 202 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 202 completed successfully
Sun Nov 16 05:17:20 PM CET 2025: Completed iteration 202

=== Iteration 203/300 ===
Sun Nov 16 05:17:20 PM CET 2025: Starting company car negotiation iteration 203 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.76s (total since entry 15.74s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.09s (total since entry 6.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 203 completed successfully
Sun Nov 16 05:18:01 PM CET 2025: Completed iteration 203

=== Iteration 204/300 ===
Sun Nov 16 05:18:01 PM CET 2025: Starting company car negotiation iteration 204 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 204 completed successfully
Sun Nov 16 05:18:39 PM CET 2025: Completed iteration 204

=== Iteration 205/300 ===
Sun Nov 16 05:18:39 PM CET 2025: Starting company car negotiation iteration 205 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.11s (total since entry 6.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,800 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 794.80 (saved â‚¬794.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1087.87 (profit â‚¬1087.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39389.60, seller=37800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=794.80, model_a surplus=1087.87
âœ… Calculated utility_surplus: {'model_a': 1087.8745256249967, 'model_b': 794.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39389.59715125, 'model_a': 37800.0}
Metrics: {'utility_surplus': {'model_a': 1087.8745256249967, 'model_b': 794.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 205 completed successfully
Sun Nov 16 05:19:19 PM CET 2025: Completed iteration 205

=== Iteration 206/300 ===
Sun Nov 16 05:19:19 PM CET 2025: Starting company car negotiation iteration 206 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38390}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38390}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38390}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38390}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38390}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38390.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 206 completed successfully
Sun Nov 16 05:20:01 PM CET 2025: Completed iteration 206

=== Iteration 207/300 ===
Sun Nov 16 05:20:01 PM CET 2025: Starting company car negotiation iteration 207 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 207 completed successfully
Sun Nov 16 05:20:49 PM CET 2025: Completed iteration 207

=== Iteration 208/300 ===
Sun Nov 16 05:20:49 PM CET 2025: Starting company car negotiation iteration 208 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 208 completed successfully
Sun Nov 16 05:21:33 PM CET 2025: Completed iteration 208

=== Iteration 209/300 ===
Sun Nov 16 05:21:33 PM CET 2025: Starting company car negotiation iteration 209 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.31s (total since entry 7.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 209 completed successfully
Sun Nov 16 05:22:27 PM CET 2025: Completed iteration 209

=== Iteration 210/300 ===
Sun Nov 16 05:22:27 PM CET 2025: Starting company car negotiation iteration 210 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.10s (total since entry 6.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 210 completed successfully
Sun Nov 16 05:23:11 PM CET 2025: Completed iteration 210

=== Iteration 211/300 ===
Sun Nov 16 05:23:11 PM CET 2025: Starting company car negotiation iteration 211 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.34s (total since entry 7.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 211 completed successfully
Sun Nov 16 05:23:52 PM CET 2025: Completed iteration 211

=== Iteration 212/300 ===
Sun Nov 16 05:23:52 PM CET 2025: Starting company car negotiation iteration 212 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.80s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.11s (total since entry 6.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 212 completed successfully
Sun Nov 16 05:24:44 PM CET 2025: Completed iteration 212

=== Iteration 213/300 ===
Sun Nov 16 05:24:44 PM CET 2025: Starting company car negotiation iteration 213 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.23s (total since entry 6.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 213 completed successfully
Sun Nov 16 05:25:32 PM CET 2025: Completed iteration 213

=== Iteration 214/300 ===
Sun Nov 16 05:25:32 PM CET 2025: Starting company car negotiation iteration 214 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 214 completed successfully
Sun Nov 16 05:26:17 PM CET 2025: Completed iteration 214

=== Iteration 215/300 ===
Sun Nov 16 05:26:17 PM CET 2025: Starting company car negotiation iteration 215 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.79s (total since entry 15.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,750 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=432.54, model_b surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39615.07324999999, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 215 completed successfully
Sun Nov 16 05:26:53 PM CET 2025: Completed iteration 215

=== Iteration 216/300 ===
Sun Nov 16 05:26:53 PM CET 2025: Starting company car negotiation iteration 216 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 216 completed successfully
Sun Nov 16 05:27:26 PM CET 2025: Completed iteration 216

=== Iteration 217/300 ===
Sun Nov 16 05:27:26 PM CET 2025: Starting company car negotiation iteration 217 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 217 completed successfully
Sun Nov 16 05:28:16 PM CET 2025: Completed iteration 217

=== Iteration 218/300 ===
Sun Nov 16 05:28:16 PM CET 2025: Starting company car negotiation iteration 218 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 218 completed successfully
Sun Nov 16 05:29:03 PM CET 2025: Completed iteration 218

=== Iteration 219/300 ===
Sun Nov 16 05:29:03 PM CET 2025: Starting company car negotiation iteration 219 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 219 completed successfully
Sun Nov 16 05:29:52 PM CET 2025: Completed iteration 219

=== Iteration 220/300 ===
Sun Nov 16 05:29:52 PM CET 2025: Starting company car negotiation iteration 220 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 4000.00 (saved â‚¬4000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -2000.00 (profit â‚¬-2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=45000.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=4000.00, model_b surplus=-2000.00
âœ… Calculated utility_surplus: {'model_a': 4000.0, 'model_b': -2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 45000.0, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 4000.0, 'model_b': -2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 220 completed successfully
Sun Nov 16 05:30:25 PM CET 2025: Completed iteration 220

=== Iteration 221/300 ===
Sun Nov 16 05:30:25 PM CET 2025: Starting company car negotiation iteration 221 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,600 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=582.54, model_a surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39765.07324999999, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 221 completed successfully
Sun Nov 16 05:30:59 PM CET 2025: Completed iteration 221

=== Iteration 222/300 ===
Sun Nov 16 05:30:59 PM CET 2025: Starting company car negotiation iteration 222 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 222 completed successfully
Sun Nov 16 05:31:32 PM CET 2025: Completed iteration 222

=== Iteration 223/300 ===
Sun Nov 16 05:31:32 PM CET 2025: Starting company car negotiation iteration 223 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.06s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 223 completed successfully
Sun Nov 16 05:32:17 PM CET 2025: Completed iteration 223

=== Iteration 224/300 ===
Sun Nov 16 05:32:17 PM CET 2025: Starting company car negotiation iteration 224 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 224 completed successfully
Sun Nov 16 05:33:03 PM CET 2025: Completed iteration 224

=== Iteration 225/300 ===
Sun Nov 16 05:33:03 PM CET 2025: Starting company car negotiation iteration 225 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.32s (total since entry 7.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ’¡ Player model_a made offer â‚¬37,850 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 225 completed successfully
Sun Nov 16 05:33:52 PM CET 2025: Completed iteration 225

=== Iteration 226/300 ===
Sun Nov 16 05:33:52 PM CET 2025: Starting company car negotiation iteration 226 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.79s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.10s (total since entry 6.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 226 completed successfully
Sun Nov 16 05:34:39 PM CET 2025: Completed iteration 226

=== Iteration 227/300 ===
Sun Nov 16 05:34:39 PM CET 2025: Starting company car negotiation iteration 227 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=194.80, model_b surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38789.59715125, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 194.7985756249982, 'model_b': 1687.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 227 completed successfully
Sun Nov 16 05:35:24 PM CET 2025: Completed iteration 227

=== Iteration 228/300 ===
Sun Nov 16 05:35:24 PM CET 2025: Starting company car negotiation iteration 228 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.22s (total since entry 6.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,850 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 228 completed successfully
Sun Nov 16 05:36:06 PM CET 2025: Completed iteration 228

=== Iteration 229/300 ===
Sun Nov 16 05:36:06 PM CET 2025: Starting company car negotiation iteration 229 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,100 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 494.80 (saved â‚¬494.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1387.87 (profit â‚¬1387.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39089.60, seller=38100.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=494.80, model_b surplus=1387.87
âœ… Calculated utility_surplus: {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39089.59715125, 'model_b': 38100.0}
Metrics: {'utility_surplus': {'model_a': 494.7985756249982, 'model_b': 1387.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 229 completed successfully
Sun Nov 16 05:36:55 PM CET 2025: Completed iteration 229

=== Iteration 230/300 ===
Sun Nov 16 05:36:55 PM CET 2025: Starting company car negotiation iteration 230 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=344.80, model_a surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38939.59715125, 'model_a': 38250.0}
Metrics: {'utility_surplus': {'model_a': 1537.8745256249967, 'model_b': 344.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 230 completed successfully
Sun Nov 16 05:37:34 PM CET 2025: Completed iteration 230

=== Iteration 231/300 ===
Sun Nov 16 05:37:34 PM CET 2025: Starting company car negotiation iteration 231 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 231 completed successfully
Sun Nov 16 05:38:22 PM CET 2025: Completed iteration 231

=== Iteration 232/300 ===
Sun Nov 16 05:38:22 PM CET 2025: Starting company car negotiation iteration 232 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 232 completed successfully
Sun Nov 16 05:39:04 PM CET 2025: Completed iteration 232

=== Iteration 233/300 ===
Sun Nov 16 05:39:04 PM CET 2025: Starting company car negotiation iteration 233 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.37s (total since entry 7.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬36,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 233 completed successfully
Sun Nov 16 05:39:53 PM CET 2025: Completed iteration 233

=== Iteration 234/300 ===
Sun Nov 16 05:39:53 PM CET 2025: Starting company car negotiation iteration 234 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 234 completed successfully
Sun Nov 16 05:40:37 PM CET 2025: Completed iteration 234

=== Iteration 235/300 ===
Sun Nov 16 05:40:37 PM CET 2025: Starting company car negotiation iteration 235 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 37500\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_a rejected but still has proposals remaining (3/4). Continuing negotiation.
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,550 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38550
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 44.80 (saved â‚¬44.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1837.87 (profit â‚¬1837.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38639.60, seller=38550.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=44.80, model_a surplus=1837.87
âœ… Calculated utility_surplus: {'model_a': 1837.8745256249967, 'model_b': 44.79857562499819}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38639.59715125, 'model_a': 38550.0}
Metrics: {'utility_surplus': {'model_a': 1837.8745256249967, 'model_b': 44.79857562499819}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 235 completed successfully
Sun Nov 16 05:41:21 PM CET 2025: Completed iteration 235

=== Iteration 236/300 ===
Sun Nov 16 05:41:21 PM CET 2025: Starting company car negotiation iteration 236 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 236 completed successfully
Sun Nov 16 05:41:59 PM CET 2025: Completed iteration 236

=== Iteration 237/300 ===
Sun Nov 16 05:41:59 PM CET 2025: Starting company car negotiation iteration 237 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 237 completed successfully
Sun Nov 16 05:42:46 PM CET 2025: Completed iteration 237

=== Iteration 238/300 ===
Sun Nov 16 05:42:46 PM CET 2025: Starting company car negotiation iteration 238 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
6, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 238 completed successfully
Sun Nov 16 05:43:32 PM CET 2025: Completed iteration 238

=== Iteration 239/300 ===
Sun Nov 16 05:43:32 PM CET 2025: Starting company car negotiation iteration 239 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37990}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37990}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37990}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37990}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37990}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37990.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,990 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,490 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38490
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 104.80 (saved â‚¬104.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1777.87 (profit â‚¬1777.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38699.60, seller=38490.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=104.80, model_b surplus=1777.87
âœ… Calculated utility_surplus: {'model_a': 104.7985756249982, 'model_b': 1777.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38699.59715125, 'model_b': 38490.0}
Metrics: {'utility_surplus': {'model_a': 104.7985756249982, 'model_b': 1777.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 239 completed successfully
Sun Nov 16 05:44:15 PM CET 2025: Completed iteration 239

=== Iteration 240/300 ===
Sun Nov 16 05:44:15 PM CET 2025: Starting company car negotiation iteration 240 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,510 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 240 completed successfully
Sun Nov 16 05:45:09 PM CET 2025: Completed iteration 240

=== Iteration 241/300 ===
Sun Nov 16 05:45:09 PM CET 2025: Starting company car negotiation iteration 241 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
21, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.25s (total since entry 6.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37700.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,900 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37900
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 694.80 (saved â‚¬694.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1187.87 (profit â‚¬1187.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39289.60, seller=37900.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=694.80, model_b surplus=1187.87
âœ… Calculated utility_surplus: {'model_a': 694.7985756249982, 'model_b': 1187.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39289.59715125, 'model_b': 37900.0}
Metrics: {'utility_surplus': {'model_a': 694.7985756249982, 'model_b': 1187.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 241 completed successfully
Sun Nov 16 05:45:57 PM CET 2025: Completed iteration 241

=== Iteration 242/300 ===
Sun Nov 16 05:45:57 PM CET 2025: Starting company car negotiation iteration 242 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
17, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 242 completed successfully
Sun Nov 16 05:46:36 PM CET 2025: Completed iteration 242

=== Iteration 243/300 ===
Sun Nov 16 05:46:36 PM CET 2025: Starting company car negotiation iteration 243 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 243 completed successfully
Sun Nov 16 05:47:25 PM CET 2025: Completed iteration 243

=== Iteration 244/300 ===
Sun Nov 16 05:47:25 PM CET 2025: Starting company car negotiation iteration 244 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38250}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38250}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38250}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 244 completed successfully
Sun Nov 16 05:48:10 PM CET 2025: Completed iteration 244

=== Iteration 245/300 ===
Sun Nov 16 05:48:10 PM CET 2025: Starting company car negotiation iteration 245 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.19s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=2000.00, model_a surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 43000.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 245 completed successfully
Sun Nov 16 05:48:44 PM CET 2025: Completed iteration 245

=== Iteration 246/300 ===
Sun Nov 16 05:48:44 PM CET 2025: Starting company car negotiation iteration 246 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.11s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 4000.00 (saved â‚¬4000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -2000.00 (profit â‚¬-2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=45000.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=4000.00, model_b surplus=-2000.00
âœ… Calculated utility_surplus: {'model_a': 4000.0, 'model_b': -2000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 45000.0, 'model_b': 37000.0}
Metrics: {'utility_surplus': {'model_a': 4000.0, 'model_b': -2000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 246 completed successfully
Sun Nov 16 05:49:17 PM CET 2025: Completed iteration 246

=== Iteration 247/300 ===
Sun Nov 16 05:49:17 PM CET 2025: Starting company car negotiation iteration 247 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38300\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38300\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 247 completed successfully
Sun Nov 16 05:50:02 PM CET 2025: Completed iteration 247

=== Iteration 248/300 ===
Sun Nov 16 05:50:02 PM CET 2025: Starting company car negotiation iteration 248 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.83s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
18, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 248 completed successfully
Sun Nov 16 05:50:50 PM CET 2025: Completed iteration 248

=== Iteration 249/300 ===
Sun Nov 16 05:50:50 PM CET 2025: Starting company car negotiation iteration 249 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.83s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,999 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 249 completed successfully
Sun Nov 16 05:51:42 PM CET 2025: Completed iteration 249

=== Iteration 250/300 ===
Sun Nov 16 05:51:42 PM CET 2025: Starting company car negotiation iteration 250 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 250 completed successfully
Sun Nov 16 05:52:28 PM CET 2025: Completed iteration 250

=== Iteration 251/300 ===
Sun Nov 16 05:52:28 PM CET 2025: Starting company car negotiation iteration 251 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.10s (total since entry 6.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,900 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 36950\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 36950\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 36950\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 251 completed successfully
Sun Nov 16 05:53:08 PM CET 2025: Completed iteration 251

=== Iteration 252/300 ===
Sun Nov 16 05:53:08 PM CET 2025: Starting company car negotiation iteration 252 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 252 completed successfully
Sun Nov 16 05:53:55 PM CET 2025: Completed iteration 252

=== Iteration 253/300 ===
Sun Nov 16 05:53:55 PM CET 2025: Starting company car negotiation iteration 253 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 253 completed successfully
Sun Nov 16 05:54:45 PM CET 2025: Completed iteration 253

=== Iteration 254/300 ===
Sun Nov 16 05:54:45 PM CET 2025: Starting company car negotiation iteration 254 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.16s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 16.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37995}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37995}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37995}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37995}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37995}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37995.0}
ğŸ’¡ Player model_b made offer â‚¬37,995 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 37000}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 37000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 37000}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 254 completed successfully
Sun Nov 16 05:55:36 PM CET 2025: Completed iteration 254

=== Iteration 255/300 ===
Sun Nov 16 05:55:36 PM CET 2025: Starting company car negotiation iteration 255 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 255 completed successfully
Sun Nov 16 05:56:27 PM CET 2025: Completed iteration 255

=== Iteration 256/300 ===
Sun Nov 16 05:56:27 PM CET 2025: Starting company car negotiation iteration 256 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 256 completed successfully
Sun Nov 16 05:57:07 PM CET 2025: Completed iteration 256

=== Iteration 257/300 ===
Sun Nov 16 05:57:07 PM CET 2025: Starting company car negotiation iteration 257 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 257 completed successfully
Sun Nov 16 05:57:55 PM CET 2025: Completed iteration 257

=== Iteration 258/300 ===
Sun Nov 16 05:57:55 PM CET 2025: Starting company car negotiation iteration 258 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.77s (total since entry 15.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,600 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬37,600 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 994.80 (saved â‚¬994.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 887.87 (profit â‚¬887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39589.60, seller=37600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=994.80, model_b surplus=887.87
âœ… Calculated utility_surplus: {'model_a': 994.7985756249982, 'model_b': 887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39589.59715125, 'model_b': 37600.0}
Metrics: {'utility_surplus': {'model_a': 994.7985756249982, 'model_b': 887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 258 completed successfully
Sun Nov 16 05:58:45 PM CET 2025: Completed iteration 258

=== Iteration 259/300 ===
Sun Nov 16 05:58:45 PM CET 2025: Starting company car negotiation iteration 259 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
16, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37,500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37,500}'
âš ï¸ [DEBUG] [model_a] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] JSON decode error for '{"type": "offer", "price": 37,500}...': Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âš ï¸ [DEBUG] [model_a] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 31 (char 30)
âœ… [DEBUG] [model_a] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 259 completed successfully
Sun Nov 16 05:59:30 PM CET 2025: Completed iteration 259

=== Iteration 260/300 ===
Sun Nov 16 05:59:30 PM CET 2025: Starting company car negotiation iteration 260 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 260 completed successfully
Sun Nov 16 06:00:18 PM CET 2025: Completed iteration 260

=== Iteration 261/300 ===
Sun Nov 16 06:00:18 PM CET 2025: Starting company car negotiation iteration 261 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 50.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 50.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 261 completed successfully
Sun Nov 16 06:01:00 PM CET 2025: Completed iteration 261

=== Iteration 262/300 ===
Sun Nov 16 06:01:00 PM CET 2025: Starting company car negotiation iteration 262 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38490}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38490}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38490}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38490}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38490}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38490.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,490 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 262 completed successfully
Sun Nov 16 06:01:42 PM CET 2025: Completed iteration 262

=== Iteration 263/300 ===
Sun Nov 16 06:01:42 PM CET 2025: Starting company car negotiation iteration 263 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.24s (total since entry 6.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 263 completed successfully
Sun Nov 16 06:02:24 PM CET 2025: Completed iteration 263

=== Iteration 264/300 ===
Sun Nov 16 06:02:24 PM CET 2025: Starting company car negotiation iteration 264 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 264 completed successfully
Sun Nov 16 06:03:11 PM CET 2025: Completed iteration 264

=== Iteration 265/300 ===
Sun Nov 16 06:03:11 PM CET 2025: Starting company car negotiation iteration 265 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.01s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,499 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38150}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38150}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38150}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38150}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38150.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,150 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38950.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -155.20 (saved â‚¬-155.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2037.87 (profit â‚¬2037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38439.60, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-155.20, model_b surplus=2037.87
âœ… Calculated utility_surplus: {'model_a': -155.2014243750018, 'model_b': 2037.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38439.59715125, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': -155.2014243750018, 'model_b': 2037.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 265 completed successfully
Sun Nov 16 06:03:57 PM CET 2025: Completed iteration 265

=== Iteration 266/300 ===
Sun Nov 16 06:03:57 PM CET 2025: Starting company car negotiation iteration 266 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.74s (total since entry 15.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.82s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.11s (total since entry 6.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 4000.00 (saved â‚¬4000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: -2000.00 (profit â‚¬-2000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=45000.00, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=4000.00, model_a surplus=-2000.00
âœ… Calculated utility_surplus: {'model_a': -2000.0, 'model_b': 4000.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 45000.0, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': -2000.0, 'model_b': 4000.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 266 completed successfully
Sun Nov 16 06:04:28 PM CET 2025: Completed iteration 266

=== Iteration 267/300 ===
Sun Nov 16 06:04:28 PM CET 2025: Starting company car negotiation iteration 267 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.99s (total since entry 15.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 267 completed successfully
Sun Nov 16 06:05:05 PM CET 2025: Completed iteration 267

=== Iteration 268/300 ===
Sun Nov 16 06:05:05 PM CET 2025: Starting company car negotiation iteration 268 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.83s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 268 completed successfully
Sun Nov 16 06:05:39 PM CET 2025: Completed iteration 268

=== Iteration 269/300 ===
Sun Nov 16 06:05:39 PM CET 2025: Starting company car negotiation iteration 269 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.68s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.33s (total since entry 7.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
20, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38950.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 269 completed successfully
Sun Nov 16 06:06:22 PM CET 2025: Completed iteration 269

=== Iteration 270/300 ===
Sun Nov 16 06:06:22 PM CET 2025: Starting company car negotiation iteration 270 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
11, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38250}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38250}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38250}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 270 completed successfully
Sun Nov 16 06:07:14 PM CET 2025: Completed iteration 270

=== Iteration 271/300 ===
Sun Nov 16 06:07:14 PM CET 2025: Starting company car negotiation iteration 271 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 271 completed successfully
Sun Nov 16 06:07:53 PM CET 2025: Completed iteration 271

=== Iteration 272/300 ===
Sun Nov 16 06:07:53 PM CET 2025: Starting company car negotiation iteration 272 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.83s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 272 completed successfully
Sun Nov 16 06:08:42 PM CET 2025: Completed iteration 272

=== Iteration 273/300 ===
Sun Nov 16 06:08:42 PM CET 2025: Starting company car negotiation iteration 273 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.80s (total since entry 15.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.76s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39415.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,415 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38500}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38500}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38500}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37995}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37995}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37995}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37995}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37995}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37995.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬37,995 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38850.0}
ğŸ’¡ Player model_b made offer â‚¬38,850 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 273 completed successfully
Sun Nov 16 06:09:33 PM CET 2025: Completed iteration 273

=== Iteration 274/300 ===
Sun Nov 16 06:09:33 PM CET 2025: Starting company car negotiation iteration 274 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.78s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 274 completed successfully
Sun Nov 16 06:10:10 PM CET 2025: Completed iteration 274

=== Iteration 275/300 ===
Sun Nov 16 06:10:10 PM CET 2025: Starting company car negotiation iteration 275 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.81s (total since entry 15.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38250\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 275 completed successfully
Sun Nov 16 06:10:51 PM CET 2025: Completed iteration 275

=== Iteration 276/300 ===
Sun Nov 16 06:10:51 PM CET 2025: Starting company car negotiation iteration 276 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
22, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", ROLE A, price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", ROLE A, price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", ROLE A, price": 38450}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A, price": 38450}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", ROLE A, price": 38450}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 276 completed successfully
Sun Nov 16 06:11:37 PM CET 2025: Completed iteration 276

=== Iteration 277/300 ===
Sun Nov 16 06:11:37 PM CET 2025: Starting company car negotiation iteration 277 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.02s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.04s (total since entry 16.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.14s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,750 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 277 completed successfully
Sun Nov 16 06:12:25 PM CET 2025: Completed iteration 277

=== Iteration 278/300 ===
Sun Nov 16 06:12:25 PM CET 2025: Starting company car negotiation iteration 278 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.12s (total since entry 6.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,100 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 278 completed successfully
Sun Nov 16 06:13:10 PM CET 2025: Completed iteration 278

=== Iteration 279/300 ===
Sun Nov 16 06:13:10 PM CET 2025: Starting company car negotiation iteration 279 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.13s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38175}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38175}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38175}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38175}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38175}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38175.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,175 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬37,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1682.54 (saved â‚¬1682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 228.81 (profit â‚¬228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40865.07, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1682.54, model_b surplus=228.81
âœ… Calculated utility_surplus: {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40865.07324999999, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1682.5366249999934, 'model_b': 228.80662500000471}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 279 completed successfully
Sun Nov 16 06:13:51 PM CET 2025: Completed iteration 279

=== Iteration 280/300 ===
Sun Nov 16 06:13:51 PM CET 2025: Starting company car negotiation iteration 280 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.97s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.21s (total since entry 6.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬39,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,950 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 280 completed successfully
Sun Nov 16 06:14:30 PM CET 2025: Completed iteration 280

=== Iteration 281/300 ===
Sun Nov 16 06:14:30 PM CET 2025: Starting company car negotiation iteration 281 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
14, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", role": "ROLE A", "price": 38150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", role": "ROLE A", "price": 38150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", role": "ROLE A", "price": 38150}'
âš ï¸ [DEBUG] [model_b] JSON decode error for start match: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38150}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] JSON decode error for '{"type": "offer", role": "ROLE A", "price": 38150}...': Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âš ï¸ [DEBUG] [model_b] Extracted JSON decode error: Expecting property name enclosed in double quotes: line 1 column 19 (char 18)
âœ… [DEBUG] [model_b] Manually extracted action: {'type': 'offer'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 5: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 194.80 (saved â‚¬194.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1687.87 (profit â‚¬1687.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38789.60, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=194.80, model_a surplus=1687.87
âœ… Calculated utility_surplus: {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38789.59715125, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1687.8745256249967, 'model_b': 194.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 281 completed successfully
Sun Nov 16 06:15:23 PM CET 2025: Completed iteration 281

=== Iteration 282/300 ===
Sun Nov 16 06:15:23 PM CET 2025: Starting company car negotiation iteration 282 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.92s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,300 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,300 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38300
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 294.80 (saved â‚¬294.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1587.87 (profit â‚¬1587.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38889.60, seller=38300.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=294.80, model_a surplus=1587.87
âœ… Calculated utility_surplus: {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38889.59715125, 'model_a': 38300.0}
Metrics: {'utility_surplus': {'model_a': 1587.8745256249967, 'model_b': 294.7985756249982}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 282 completed successfully
Sun Nov 16 06:16:09 PM CET 2025: Completed iteration 282

=== Iteration 283/300 ===
Sun Nov 16 06:16:09 PM CET 2025: Starting company car negotiation iteration 283 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.90s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.27s (total since entry 6.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 283 completed successfully
Sun Nov 16 06:16:49 PM CET 2025: Completed iteration 283

=== Iteration 284/300 ===
Sun Nov 16 06:16:49 PM CET 2025: Starting company car negotiation iteration 284 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.91s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.16s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,480 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬37,900 (proposal 1/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 284 completed successfully
Sun Nov 16 06:17:38 PM CET 2025: Completed iteration 284

=== Iteration 285/300 ===
Sun Nov 16 06:17:38 PM CET 2025: Starting company car negotiation iteration 285 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
13, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 285 completed successfully
Sun Nov 16 06:18:18 PM CET 2025: Completed iteration 285

=== Iteration 286/300 ===
Sun Nov 16 06:18:18 PM CET 2025: Starting company car negotiation iteration 286 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.99s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.86s (total since entry 15.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37840}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37840}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37840}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37840}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37840}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37840.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,840 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37840}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37840}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37840}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37840}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37840}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37840.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬37,840 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38240}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38240}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38240}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38240}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38240}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38240.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,840 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37840
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 754.80 (saved â‚¬754.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1127.87 (profit â‚¬1127.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39349.60, seller=37840.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=754.80, model_b surplus=1127.87
âœ… Calculated utility_surplus: {'model_a': 754.7985756249982, 'model_b': 1127.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39349.59715125, 'model_b': 37840.0}
Metrics: {'utility_surplus': {'model_a': 754.7985756249982, 'model_b': 1127.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 286 completed successfully
Sun Nov 16 06:19:00 PM CET 2025: Completed iteration 286

=== Iteration 287/300 ===
Sun Nov 16 06:19:00 PM CET 2025: Starting company car negotiation iteration 287 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.98s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.89s (total since entry 15.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
10, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 932.54 (saved â‚¬932.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 978.81 (profit â‚¬978.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40115.07, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=932.54, model_b surplus=978.81
âœ… Calculated utility_surplus: {'model_a': 932.5366249999934, 'model_b': 978.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40115.07324999999, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 932.5366249999934, 'model_b': 978.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 287 completed successfully
Sun Nov 16 06:19:41 PM CET 2025: Completed iteration 287

=== Iteration 288/300 ===
Sun Nov 16 06:19:41 PM CET 2025: Starting company car negotiation iteration 288 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.00s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.80s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 25.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 25.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 288 completed successfully
Sun Nov 16 06:20:27 PM CET 2025: Completed iteration 288

=== Iteration 289/300 ===
Sun Nov 16 06:20:27 PM CET 2025: Starting company car negotiation iteration 289 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.87s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.15s (total since entry 6.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 289 completed successfully
Sun Nov 16 06:21:14 PM CET 2025: Completed iteration 289

=== Iteration 290/300 ===
Sun Nov 16 06:21:14 PM CET 2025: Starting company car negotiation iteration 290 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.18s (total since entry 6.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬37,650 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,650 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37650
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 944.80 (saved â‚¬944.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 937.87 (profit â‚¬937.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39539.60, seller=37650.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=944.80, model_a surplus=937.87
âœ… Calculated utility_surplus: {'model_a': 937.8745256249967, 'model_b': 944.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39539.59715125, 'model_a': 37650.0}
Metrics: {'utility_surplus': {'model_a': 937.8745256249967, 'model_b': 944.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 290 completed successfully
Sun Nov 16 06:21:55 PM CET 2025: Completed iteration 290

=== Iteration 291/300 ===
Sun Nov 16 06:21:55 PM CET 2025: Starting company car negotiation iteration 291 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.56s (total since entry 15.50s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.07s (total since entry 5.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
7, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39450.0}
ğŸ’¡ Player model_b made offer â‚¬39,450 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,495 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 291 completed successfully
Sun Nov 16 06:22:43 PM CET 2025: Completed iteration 291

=== Iteration 292/300 ===
Sun Nov 16 06:22:43 PM CET 2025: Starting company car negotiation iteration 292 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.74s (total since entry 12.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.97s (total since entry 5.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37450.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 292 completed successfully
Sun Nov 16 06:23:26 PM CET 2025: Completed iteration 292

=== Iteration 293/300 ===
Sun Nov 16 06:23:26 PM CET 2025: Starting company car negotiation iteration 293 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.84s (total since entry 15.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
19, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.79s (total since entry 6.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬36,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 37800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37800.0}
ğŸ’¡ Player model_b made offer â‚¬37,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1094.80, model_b surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Ministral-8B-Instruct-2410 beat meta-llama/Llama-3.2-3B-Instruct (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39689.59715125, 'model_b': 37500.0}
Metrics: {'utility_surplus': {'model_a': 1094.7985756249982, 'model_b': 787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 293 completed successfully
Sun Nov 16 06:24:12 PM CET 2025: Completed iteration 293

=== Iteration 294/300 ===
Sun Nov 16 06:24:12 PM CET 2025: Starting company car negotiation iteration 294 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.92s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.81s (total since entry 12.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.23s (total since entry 5.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,550 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=594.80, model_b surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 39189.59715125, 'model_b': 38000.0}
Metrics: {'utility_surplus': {'model_a': 594.7985756249982, 'model_b': 1287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 294 completed successfully
Sun Nov 16 06:24:53 PM CET 2025: Completed iteration 294

=== Iteration 295/300 ===
Sun Nov 16 06:24:53 PM CET 2025: Starting company car negotiation iteration 295 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.89s (total since entry 12.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.10s (total since entry 5.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬36,900 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 394.80 (saved â‚¬394.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1487.87 (profit â‚¬1487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38989.60, seller=38200.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=394.80, model_b surplus=1487.87
âœ… Calculated utility_surplus: {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38989.59715125, 'model_b': 38200.0}
Metrics: {'utility_surplus': {'model_a': 394.7985756249982, 'model_b': 1487.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 295 completed successfully
Sun Nov 16 06:25:34 PM CET 2025: Completed iteration 295

=== Iteration 296/300 ===
Sun Nov 16 06:25:34 PM CET 2025: Starting company car negotiation iteration 296 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.93s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.87s (total since entry 12.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.01s (total since entry 5.71s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38495}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38495}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38495}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38495}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38495}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38495.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 66.66666666666666, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 66.66666666666666, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 296 completed successfully
Sun Nov 16 06:26:16 PM CET 2025: Completed iteration 296

=== Iteration 297/300 ===
Sun Nov 16 06:26:16 PM CET 2025: Starting company car negotiation iteration 297 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.91s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.88s (total since entry 12.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.73s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.97s (total since entry 5.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,300 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38480}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38480}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38480}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38480}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38480}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38480.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 297 completed successfully
Sun Nov 16 06:26:54 PM CET 2025: Completed iteration 297

=== Iteration 298/300 ===
Sun Nov 16 06:26:54 PM CET 2025: Starting company car negotiation iteration 298 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.94s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.84s (total since entry 12.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.01s (total since entry 5.71s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ’¡ Player model_b made offer â‚¬37,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36850.0}
ğŸ’¡ Player model_b made offer â‚¬36,850 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 0.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 0.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 298 completed successfully
Sun Nov 16 06:27:36 PM CET 2025: Completed iteration 298

=== Iteration 299/300 ===
Sun Nov 16 06:27:36 PM CET 2025: Starting company car negotiation iteration 299 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.96s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.91s (total since entry 12.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.96s (total since entry 5.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_b made offer â‚¬38,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,450 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,250 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 932.54 (saved â‚¬932.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 978.81 (profit â‚¬978.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40115.07, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=932.54, model_b surplus=978.81
âœ… Calculated utility_surplus: {'model_a': 932.5366249999934, 'model_b': 978.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] meta-llama/Llama-3.2-3B-Instruct beat mistralai/Ministral-8B-Instruct-2410 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 40115.07324999999, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 932.5366249999934, 'model_b': 978.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 299 completed successfully
Sun Nov 16 06:28:14 PM CET 2025: Completed iteration 299

=== Iteration 300/300 ===
Sun Nov 16 06:28:14 PM CET 2025: Starting company car negotiation iteration 300 on node jn119
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Ministral-8B-Instruct-2410', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Ministral-8B-Instruct-2410)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for meta-llama/Llama-3.2-3B-Instruct)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model alias: model_c -> meta-llama/Llama-3.2-3B-Instruct
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
Loading mistralai/Ministral-8B-Instruct-2410...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.95s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Ministral-8B-Instruct-2410'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Ministral-8B-Instruct-2410', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.92s (total since entry 12.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 17847
âœ… mistralai/Ministral-8B-Instruct-2410 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: meta-llama/Llama-3.2-3B-Instruct)
Loading meta-llama/Llama-3.2-3B-Instruct...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.71s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='meta-llama/Llama-3.2-3B-Instruct'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('meta-llama/Llama-3.2-3B-Instruct', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.98s (total since entry 5.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
9, 22677
âœ… meta-llama/Llama-3.2-3B-Instruct loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38350}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38350}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38350}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38350}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38350}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38350.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,350 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38900}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38900}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38900}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 36950\n}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{\n  "type": "offer",\n  "price": 36950\n}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 36950\n}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36950.0}
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬36,950 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Cleaned response: ''
ğŸ” [DEBUG] [model_a] Raw LLM response: ''
âŒ [DEBUG] [model_a] Could not parse action from response: 
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38300}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38300}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38300}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38300}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38300}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38300.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Ministral-8B-Instruct-2410, model_b=Llama-3.2-3B-Instruct
ğŸ—‘ï¸  mistralai/Ministral-8B-Instruct-2410 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Ministral-8B-Instruct-2410)
âš ï¸  Model model_b shares wrapper 'meta-llama/Llama-3.2-3B-Instruct' with aliases ['model_c']; skipping unload to avoid breaking aliases
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 300 completed successfully
Sun Nov 16 06:28:55 PM CET 2025: Completed iteration 300

=== Company Car Game Batch Complete ===
Successful iterations: 300/300
âœ… ALL ITERATIONS SUCCESSFUL: Platform working perfectly on node jn119
=== Company Car Run Complete ===
